var sim={systems:[],active:null,index:0};function simhw_add(a){sim.systems.push(a);sim.active=a;sim.index=sim.systems.length-1;check_behavior();compile_behaviors();firedep_to_fireorder(jit_fire_dep);compute_references()}function simhw_getActive(){return sim.index}function simhw_setActive(a){if((a>=0)&&(sim.systems.length>=a)){sim.active=sim.systems[a];sim.index=a}compile_behaviors();firedep_to_fireorder(jit_fire_dep);compute_references()}function simhw_getActiveByName(b){for(var a=0;a<sim.systems.length;a++){if(sim.systems[a].sim_short_name==b){return a}}return -1}function simhw_active(){return sim.active}function simhw_short_name(){return sim.active.sim_short_name}function simhw_sim_signals(){return sim.active.signals}function simhw_sim_signal(a){return sim.active.signals[a]}function simhw_sim_states(){return sim.active.states}function simhw_sim_state(a){return sim.active.states[a]}function simhw_syntax_behaviors(){return sim.active.behaviors}function simhw_syntax_behavior(a){return sim.active.behaviors[a]}function simhw_sim_components(){return sim.active.components}function simhw_sim_component(a){return sim.active.components[a]}function simhw_internalState(a){return sim.active.internal_states[a]}function simhw_internalState_get(a,b){return sim.active.internal_states[a][b]}function simhw_internalState_set(a,d,b){sim.active.internal_states[a][d]=b}function simhw_internalState_reset(a,b){ep_internal_states[a]=b;sim.active.internal_states[a]=ep_internal_states[a]}function get_value(a){if(typeof a.value=="function"){return a.value()}else{if(typeof a.default_value=="object"){return a.value}else{return a.value}}}function set_value(a,b){if(typeof a.value=="function"){if(a.value()!=b){a.changed=true}a.value(b)}else{if(typeof a.default_value=="object"){if(a.value!=b){a.changed=true}a.value=b}else{if(a.value!=b){a.changed=true}a.value=b}}}function reset_value(b){if(typeof b.value=="function"){if(b.value()!=b.default_value){b.changed=true}set_value(b,b.default_value)}else{if(typeof b.default_value=="object"){b.changed=true;b.value=Object.create(b.default_value)}else{if(b instanceof Array){b.changed=true;for(var a=0;a<b.length;a++){set_value(b[a],b[a].default_value)}}else{if(b.value!=b.default_value){b.changed=true}set_value(b,b.default_value)}}}}function get_var(a){if(typeof a=="function"){return a()}else{return a}}function set_var(b,a){if(typeof b=="function"){b(a)}else{b=a}}var sim_references={};function compute_references(){for(var a in simhw_sim_signals()){sim_references[a]=simhw_sim_signal(a);simhw_sim_signal(a).changed=false}for(a in simhw_sim_states()){sim_references[a]=simhw_sim_state(a);simhw_sim_state(a).changed=false}}function get_reference(a){return sim_references[a]}function check_behavior(){if(0==simhw_sim_signals().length){alert("ALERT: empty signals!!!")}if(0==simhw_sim_states().length){alert("ALERT: empty states!!!")}for(var h in simhw_sim_signals()){for(var g in simhw_sim_signal(h).behavior){var a=simhw_sim_signal(h).behavior[g].split(";");for(var f=0;f<a.length;f++){var d=a[f].trim();var b=d.split(" ");if(""==d){continue}if(typeof(simhw_syntax_behavior(b[0]))=="undefined"){alert("ALERT: Unknown operation -> "+b[0]+" ("+d+")");return}if(b.length!=simhw_syntax_behavior(b[0]).nparameters){alert("ALERT: Behavior has an incorrect number of elements --> "+d+"/"+simhw_syntax_behavior(b[0]).nparameters);return}for(var e=1;e<b.length;e++){var m=b[e].split("/");var k=simhw_syntax_behavior(b[0]).types[e-1];if(("E"==k)&&(typeof simhw_sim_state(m[0])=="undefined")){alert("ALERT: Behavior has an undefined reference to a object state -> '"+d);return}else{if(("S"==k)&&(typeof simhw_sim_signal(m[0])=="undefined")){alert("ALERT: Behavior has an undefined reference to a signal -> '"+d);return}else{if(("X"==k)&&(typeof simhw_sim_state(m[0])=="undefined")&&(typeof simhw_sim_signal(m[0])=="undefined")){alert("ALERT: Behavior has an undefined reference to a object state OR signal -> '"+d);return}}}}}}}}var jit_behaviors=false;var jit_fire_dep=null;var jit_fire_order=null;var jit_dep_network=null;var jit_fire_ndep=null;function firedep_to_fireorder(b){var a=false;jit_fire_order=new Array();jit_fire_ndep=new Array();for(var e in simhw_sim_signals()){if(typeof b[e]=="undefined"){jit_fire_order.push(e);continue}ndep=0;a=false;for(var d in b[e]){ndep++;if(b[e][d]==simhw_sim_signal(d).behavior.length){a=true}}jit_fire_ndep[e]=ndep;if(a==false){jit_fire_order.push(e)}}}function compile_behaviors(){var jit_bes="";jit_fire_dep=new Object();for(var sig in simhw_sim_signals()){jit_bes+="simhw_sim_signal('"+sig+"').behavior_fn = new Array();\n";for(var val in simhw_sim_signal(sig).behavior){var input_behavior=simhw_sim_signal(sig).behavior[val];var jit_be="";var s_exprs=input_behavior.split(";");for(var i=0;i<s_exprs.length;i++){s_exprs[i]=s_exprs[i].trim();if(""==s_exprs[i]){continue}var s_expr=s_exprs[i].split(" ");if(s_expr[0]!="NOP"){jit_be+="simhw_syntax_behavior('"+s_expr[0]+"').operation("+JSON.stringify(s_expr)+");\t"}if(("FIRE"==s_expr[0])&&(simhw_sim_signal(sig).type==simhw_sim_signal(s_expr[1]).type)){if(typeof jit_fire_dep[s_expr[1]]=="undefined"){jit_fire_dep[s_expr[1]]=new Object()}if(typeof jit_fire_dep[s_expr[1]][sig]=="undefined"){jit_fire_dep[s_expr[1]][sig]=0}jit_fire_dep[s_expr[1]][sig]++}}jit_bes+="simhw_sim_signal('"+sig+"').behavior_fn["+val+"] = \t function() {"+jit_be+"};\n"}}eval(jit_bes);jit_behaviors=true}function compute_behavior(d){var e=d.split(";");for(var b=0;b<e.length;b++){e[b]=e[b].trim();if(""==e[b]){continue}var a=e[b].split(" ");simhw_syntax_behavior(a[0]).operation(a)}}function compute_general_behavior(a){if(jit_behaviors){simhw_syntax_behavior(a).operation()}else{compute_behavior(a)}}function compute_signal_behavior(b,a){if(jit_behaviors){simhw_sim_signal(b).behavior_fn[a]()}else{compute_behavior(simhw_sim_signal(b).behavior[a])}}var ep_components={};var ep_states={};var ep_events={};var ep_signals={};var ep_behaviors={};var ep_internal_states={};var ep_def={sim_name:"Elemental Processor",sim_short_name:"ep",sim_img_processor:"sim_hw/sim_hw_ep/processor6.svg",sim_img_controlunit:"sim_hw/sim_hw_ep/controlunit6.svg",sim_img_cpu:"sim_hw/sim_hw_ep/cpu6.svg",components:ep_components,states:ep_states,signals:ep_signals,behaviors:ep_behaviors,events:ep_events,internal_states:ep_internal_states};simhw_add(ep_def);ep_behaviors.PRINT_S={nparameters:2,types:["S"],operation:function(a){console.log(a[1]+": 0x"+ep_signals[a[1]].value.toString(16))}};ep_behaviors.PRINT_E={nparameters:2,types:["E"],operation:function(a){console.log(a[1]+": 0x"+ep_states[a[1]].value.toString(16))}};ep_components.CPU={name:"CPU",version:"1",write_state:function(d){if(typeof d.CPU=="undefined"){d.CPU={}}var a=["PC","SR"];var e=0;for(var b=0;b<ep_states.BR.length;b++){e=parseInt(ep_states.BR[b].value);if(e!=0){d.CPU["R"+b]={type:"register",default_value:0,id:"R"+b,op:"=",value:"0x"+e.toString(16)}}}for(var b=0;b<a.length;b++){e=parseInt(ep_states["REG_"+a[b]].value);if(e!=0){d.CPU[a[b]]={type:"register",default_value:0,id:a[b],op:"=",value:"0x"+e.toString(16)}}}return d},read_state:function(d,a){if(typeof d.CPU=="undefined"){d.CPU={}}var b=a.id.toUpperCase().trim();var e=parseInt(a.value).toString(16);if("REGISTER"==a.type.toUpperCase().trim()){d.CPU[b]={type:"register",default_value:0,id:b,op:a.condition,value:"0x"+e};return true}return false},get_state:function(b){var d=b.toUpperCase().trim();if(typeof ep_states["REG_"+d]!="undefined"){return"0x"+get_value(ep_states["REG_"+d]).toString(16)}d=d.replace("R","");var a=parseInt(d);if(typeof ep_states.BR[a]!="undefined"){return"0x"+get_value(ep_states.BR[a]).toString(16)}return null}};ep_internal_states.MC={};ep_internal_states.MC_dashboard={};ep_internal_states.ROM={};ep_internal_states.FIRMWARE={};ep_internal_states.io_hash={};ep_internal_states.fire_stack=[];ep_internal_states.tri_state_names=["T1","T2","T3","T4","T5","T6","T7","T8","T9","T10","T11"];ep_internal_states.fire_visible={databus:false,internalbus:false};ep_states.BR=[];ep_states.BR[0]={name:"R0",visible:true,nbits:"32",value:0,default_value:0,draw_data:[]};ep_states.BR[1]={name:"R1",visible:true,nbits:"32",value:0,default_value:0,draw_data:[]};ep_states.BR[2]={name:"R2",visible:true,nbits:"32",value:0,default_value:0,draw_data:[]};ep_states.BR[3]={name:"R3",visible:true,nbits:"32",value:0,default_value:0,draw_data:[]};ep_states.BR[4]={name:"R4",visible:true,nbits:"32",value:0,default_value:0,draw_data:[]};ep_states.BR[5]={name:"R5",visible:true,nbits:"32",value:0,default_value:0,draw_data:[]};ep_states.BR[6]={name:"R6",visible:true,nbits:"32",value:0,default_value:0,draw_data:[]};ep_states.BR[7]={name:"R7",visible:true,nbits:"32",value:0,default_value:0,draw_data:[]};ep_states.BR[8]={name:"R8",visible:true,nbits:"32",value:0,default_value:0,draw_data:[]};ep_states.BR[9]={name:"R9",visible:true,nbits:"32",value:0,default_value:0,draw_data:[]};ep_states.BR[10]={name:"R10",visible:true,nbits:"32",value:0,default_value:0,draw_data:[]};ep_states.BR[11]={name:"R11",visible:true,nbits:"32",value:0,default_value:0,draw_data:[]};ep_states.BR[12]={name:"R12",visible:true,nbits:"32",value:0,default_value:0,draw_data:[]};ep_states.BR[13]={name:"R13",visible:true,nbits:"32",value:0,default_value:0,draw_data:[]};ep_states.BR[14]={name:"R14",visible:true,nbits:"32",value:0,default_value:0,draw_data:[]};ep_states.BR[15]={name:"R15",visible:true,nbits:"32",value:0,default_value:0,draw_data:[]};ep_states.BR[16]={name:"R16",visible:true,nbits:"32",value:0,default_value:0,draw_data:[]};ep_states.BR[17]={name:"R17",visible:true,nbits:"32",value:0,default_value:0,draw_data:[]};ep_states.BR[18]={name:"R18",visible:true,nbits:"32",value:0,default_value:0,draw_data:[]};ep_states.BR[19]={name:"R19",visible:true,nbits:"32",value:0,default_value:0,draw_data:[]};ep_states.BR[20]={name:"R20",visible:true,nbits:"32",value:0,default_value:0,draw_data:[]};ep_states.BR[21]={name:"R21",visible:true,nbits:"32",value:0,default_value:0,draw_data:[]};ep_states.BR[22]={name:"R22",visible:true,nbits:"32",value:0,default_value:0,draw_data:[]};ep_states.BR[23]={name:"R23",visible:true,nbits:"32",value:0,default_value:0,draw_data:[]};ep_states.BR[24]={name:"R24",visible:true,nbits:"32",value:0,default_value:0,draw_data:[]};ep_states.BR[25]={name:"R25",visible:true,nbits:"32",value:0,default_value:0,draw_data:[]};ep_states.BR[26]={name:"R26",visible:true,nbits:"32",value:0,default_value:0,draw_data:[]};ep_states.BR[27]={name:"R27",visible:true,nbits:"32",value:0,default_value:0,draw_data:[]};ep_states.BR[28]={name:"R28",visible:true,nbits:"32",value:0,default_value:0,draw_data:[]};ep_states.BR[29]={name:"R29",visible:true,nbits:"32",value:0,default_value:0,draw_data:[]};ep_states.BR[30]={name:"R30",visible:true,nbits:"32",value:0,default_value:0,draw_data:[]};ep_states.BR[31]={name:"R31",visible:true,nbits:"32",value:0,default_value:0,draw_data:[]};ep_states.REG_PC={name:"PC",visible:true,nbits:"32",value:0,default_value:0,draw_data:[]};ep_states.REG_MAR={name:"MAR",visible:true,nbits:"32",value:0,default_value:0,draw_data:[]};ep_states.REG_MBR={name:"MBR",visible:true,nbits:"32",value:0,default_value:0,draw_data:[]};ep_states.REG_IR={name:"IR",visible:true,nbits:"32",value:0,default_value:0,draw_data:[]};ep_states.REG_RT1={name:"RT1",visible:true,nbits:"32",value:0,default_value:0,draw_data:[]};ep_states.REG_RT2={name:"RT2",visible:true,nbits:"32",value:0,default_value:0,draw_data:[]};ep_states.REG_RT3={name:"RT3",visible:true,nbits:"32",value:0,default_value:0,draw_data:[]};ep_states.REG_SR={name:"SR",visible:true,nbits:"32",value:0,default_value:0,draw_data:[]};ep_states.BUS_IB={name:"I_BUS",visible:false,nbits:"32",value:0,default_value:0,draw_data:[]};ep_states.BUS_AB={name:"A_BUS",visible:false,nbits:"32",value:0,default_value:0,draw_data:[]};ep_states.BUS_CB={name:"C_BUS",visible:false,nbits:"32",value:0,default_value:0,draw_data:[]};ep_states.BUS_DB={name:"D_BUS",visible:false,nbits:"32",value:0,default_value:0,draw_data:[]};ep_states.C2_T2={name:"C2_T2",visible:false,nbits:"32",value:0,default_value:0,draw_data:[]};ep_states.RA_T9={name:"RA_T9",visible:false,nbits:"32",value:0,default_value:0,draw_data:[]};ep_states.RB_T10={name:"RB_T10",visible:false,nbits:"32",value:0,default_value:0,draw_data:[]};ep_states.SELEC_T3={name:"SELEC_T3",visible:false,nbits:"32",value:0,default_value:0,draw_data:[]};ep_states.SELP_M7={name:"SELP_M7",visible:false,nbits:"32",value:0,default_value:0,draw_data:[]};ep_states.SUM4_M2={name:"SUM4_M2",visible:false,nbits:"32",value:0,default_value:0,draw_data:[]};ep_states.ALU_C6={name:"ALU_C6",visible:false,nbits:"32",value:0,default_value:0,draw_data:[]};ep_states.MA_ALU={name:"MA_ALU",visible:false,nbits:"32",value:0,default_value:0,draw_data:[]};ep_states.MB_ALU={name:"MB_ALU",visible:false,nbits:"32",value:0,default_value:0,draw_data:[]};ep_states.FLAG_C={name:"FLAG_C",visible:true,nbits:"1",value:0,default_value:0,draw_data:[]};ep_states.FLAG_V={name:"FLAG_V",visible:true,nbits:"1",value:0,default_value:0,draw_data:[]};ep_states.FLAG_N={name:"FLAG_N",visible:true,nbits:"1",value:0,default_value:0,draw_data:[]};ep_states.FLAG_Z={name:"FLAG_Z",visible:true,nbits:"1",value:0,default_value:0,draw_data:[]};ep_states.FLAG_I={name:"FLAG_I",visible:true,nbits:"1",value:0,default_value:0,draw_data:[]};ep_states.FLAG_U={name:"FLAG_U",visible:true,nbits:"1",value:0,default_value:0,draw_data:[]};ep_states.REG_MICROADDR={name:"µADDR",visible:true,nbits:"12",value:0,default_value:0,draw_data:["svg_cu:text4667"]};ep_states.REG_MICROINS={name:"µINS",visible:true,nbits:"77",value:{},default_value:{},draw_data:[]};ep_states.FETCH={name:"FETCH",visible:false,nbits:"12",value:0,default_value:0,draw_data:[]};ep_states.ROM_MUXA={name:"ROM_MUXA",visible:false,nbits:"12",value:0,default_value:0,draw_data:[]};ep_states.SUM_ONE={name:"SUM_ONE",visible:false,nbits:"12",value:1,default_value:1,draw_data:[]};ep_states.MUXA_MICROADDR={name:"MUXA_MICROADDR",visible:false,nbits:"12",value:0,default_value:0,draw_data:[]};ep_states.MUXC_MUXB={name:"MUXC_MUXB",visible:false,nbits:"1",value:0,default_value:0,draw_data:[]};ep_states.INEX={name:"INEX",visible:false,nbits:"1",value:0,default_value:0,draw_data:[]};ep_states.BS_M1={name:"BS_M1",visible:false,nbits:"32",value:0,default_value:0,draw_data:[]};ep_states.BS_TD={name:"BS_TD",visible:false,nbits:"32",value:0,default_value:0,draw_data:[]};ep_states.INTV={name:"INTV",visible:false,nbits:"8",value:0,default_value:0,draw_data:[]};ep_states.M2_C2={name:"M2_C2",visible:false,nbits:"32",value:0,default_value:0,draw_data:[]};ep_states.M1_C1={name:"M1_C1",visible:false,nbits:"32",value:0,default_value:0,draw_data:[]};ep_states.M7_C7={name:"M7_C7",visible:false,nbits:"32",value:0,default_value:0,draw_data:[]};ep_states.VAL_ZERO={name:"VAL_ZERO",visible:false,nbits:"1",value:0,default_value:0,draw_data:[]};ep_states.VAL_ONE={name:"VAL_ONE",visible:false,nbits:"32",value:1,default_value:1,draw_data:[]};ep_states.VAL_FOUR={name:"VAL_FOUR",visible:false,nbits:"32",value:4,default_value:4,draw_data:[]};ep_states.REG_IR_DECO={name:"IR_DECO",visible:true,nbits:"0",value:0,default_value:0,draw_data:[]};ep_states.DECO_INS={name:"DECO_INS",visible:true,nbits:"32",value:0,default_value:0,draw_data:[]};ep_states.CLK={name:"CLK",visible:false,nbits:"32",value:0,default_value:0,draw_data:[]};ep_signals.C={name:"C",visible:true,type:"L",value:0,default_value:0,nbits:"4",behavior:["MV MUXC_MUXB VAL_ZERO; FIRE_IFCHANGED B MUXC_MUXB; RESET_CHANGED MUXC_MUXB","MBIT MUXC_MUXB INT 0 1; FIRE_IFCHANGED B MUXC_MUXB; RESET_CHANGED MUXC_MUXB","MBIT MUXC_MUXB IORDY 0 1; FIRE_IFCHANGED B MUXC_MUXB; RESET_CHANGED MUXC_MUXB","MBIT MUXC_MUXB MRDY 0 1; FIRE_IFCHANGED B MUXC_MUXB; RESET_CHANGED MUXC_MUXB","MBIT MUXC_MUXB REG_SR 0 1; FIRE_IFCHANGED B MUXC_MUXB; RESET_CHANGED MUXC_MUXB","MBIT MUXC_MUXB REG_SR 1 1; FIRE_IFCHANGED B MUXC_MUXB; RESET_CHANGED MUXC_MUXB","MBIT MUXC_MUXB REG_SR 28 1; FIRE_IFCHANGED B MUXC_MUXB; RESET_CHANGED MUXC_MUXB","MBIT MUXC_MUXB REG_SR 29 1; FIRE_IFCHANGED B MUXC_MUXB; RESET_CHANGED MUXC_MUXB","MBIT MUXC_MUXB REG_SR 30 1; FIRE_IFCHANGED B MUXC_MUXB; RESET_CHANGED MUXC_MUXB","MBIT MUXC_MUXB REG_SR 31 1; FIRE_IFCHANGED B MUXC_MUXB; RESET_CHANGED MUXC_MUXB","MV MUXC_MUXB INEX; FIRE_IFCHANGED B MUXC_MUXB; RESET_CHANGED MUXC_MUXB"],fire_name:["svg_cu:text3410"],draw_data:[["svg_cu:path3108"],["svg_cu:path3062"],["svg_cu:path3060"],["svg_cu:path3136"],["svg_cu:path3482"],["svg_cu:path3480"],["svg_cu:path3488"],["svg_cu:path3486"],["svg_cu:path3484"],["svg_cu:path3484-9"],["svg_cu:path3108-3","svg_cu:path3260-3-8-6","svg_cu:path3260-3-8","svg_cu:path3260-3"]],draw_name:[["svg_cu:path3496","svg_cu:path3414","svg_cu:path3194-08"]]};ep_signals.B={name:"B",visible:true,type:"L",value:0,default_value:0,nbits:"1",behavior:["MV A1 MUXC_MUXB; FIRE A1","NOT_ES A1 MUXC_MUXB; FIRE A1"],depends_on:["CLK"],fire_name:["svg_cu:text3408"],draw_data:[["svg_cu:path3094-7"],["svg_cu:path3392","svg_cu:path3372","svg_cu:path3390","svg_cu:path3384","svg_cu:path3108-1","svg_cu:path3100-8-7"]],draw_name:[[],["svg_cu:path3194-0","svg_cu:path3138-8","svg_cu:path3498-6"]]};ep_signals.A0={name:"A0",visible:false,type:"L",value:0,default_value:0,nbits:"1",behavior:["SBIT A0A1 A0 1; FIRE A0A1","SBIT A0A1 A0 1; FIRE A0A1"],depends_on:["CLK"],fire_name:["svg_cu:text3406"],draw_data:[["svg_cu:path3096"],["svg_cu:path3096"]],draw_name:[[],["svg_cu:path3138-8-1","svg_cu:path3098-2","svg_cu:path3124-2-5"]]};ep_signals.A1={name:"A1",visible:false,type:"L",value:0,default_value:0,nbits:"1",behavior:["SBIT A0A1 A1 0; FIRE A0A1","SBIT A0A1 A1 0; FIRE A0A1"],depends_on:["CLK"],fire_name:[],draw_data:[["svg_cu:path3094"],["svg_cu:path3094"]],draw_name:[[]]};ep_signals.A0A1={name:"A0A1",visible:true,type:"L",value:0,default_value:0,nbits:"2",behavior:["ADD MUXA_MICROADDR REG_MICROADDR SUM_ONE","MV MUXA_MICROADDR REG_MICROINS/MADDR","MV MUXA_MICROADDR ROM_MUXA","MV MUXA_MICROADDR FETCH"],depends_on:["CLK"],fire_name:[],draw_data:[["svg_cu:path3102","svg_cu:path3100","svg_cu:path3098","svg_cu:path3100-9","svg_cu:path3088"],["svg_cu:path3104","svg_cu:path3134","svg_cu:path3500","svg_cu:path3416"],["svg_cu:path3504","svg_cu:path3100-8","svg_cu:path3234-9"],["svg_cu:path3124"]],draw_name:[[]]};ep_signals.C0={name:"C0",visible:true,type:"E",value:0,default_value:0,nbits:"1",behavior:["NOP","MV REG_MAR BUS_IB"],fire_name:["svg_p:text3077"],draw_data:[["svg_p:path3081"]],draw_name:[["svg_p:path3075"]]};ep_signals.C1={name:"C1",visible:true,type:"E",value:0,default_value:0,nbits:"1",behavior:["NOP","MV REG_MBR M1_C1"],fire_name:["svg_p:text3079"],draw_data:[["svg_p:path3055"]],draw_name:[["svg_p:path3073"]]};ep_signals.C2={name:"C2",visible:true,type:"E",value:0,default_value:0,nbits:"1",behavior:["NOP","MV REG_PC M2_C2; UPDATEDPC"],fire_name:["svg_p:text3179"],draw_data:[["svg_p:path3485"]],draw_name:[["svg_p:path3177"]]};ep_signals.C3={name:"C3",visible:true,type:"E",value:0,default_value:0,nbits:"1",behavior:["NOP","MV REG_IR BUS_IB; DECO; FIRE_IFSET C 10"],fire_name:["svg_p:text3439"],draw_data:[["svg_p:path3339"]],draw_name:[["svg_p:path3337"]]};ep_signals.C4={name:"C4",visible:true,type:"E",value:0,default_value:0,nbits:"1",behavior:["NOP","MV REG_RT1 BUS_IB"],fire_name:["svg_p:text3441"],draw_data:[["svg_p:path3263"]],draw_name:[["svg_p:path3255"]]};ep_signals.C5={name:"C5",visible:true,type:"E",value:0,default_value:0,nbits:"1",behavior:["NOP","MV REG_RT2 BUS_IB"],fire_name:["svg_p:text3443"],draw_data:[["svg_p:path3277"]],draw_name:[["svg_p:path3269"]]};ep_signals.C6={name:"C6",visible:true,type:"E",value:0,default_value:0,nbits:"1",behavior:["NOP","MV REG_RT3 ALU_C6"],fire_name:["svg_p:text3445"],draw_data:[["svg_p:path3325","svg_p:path3323"]],draw_name:[["svg_p:path3245"]]};ep_signals.C7={name:"C7",visible:true,type:"E",value:0,default_value:0,nbits:"1",behavior:["NOP","MV REG_SR M7_C7; FIRE C"],fire_name:["svg_p:text3655"],draw_data:[["svg_p:path3651-9"]],draw_name:[["svg_p:path3681"]]};ep_signals.TA={name:"TA",visible:true,type:"L",value:0,default_value:0,nbits:"1",behavior:["NOP","MV BUS_AB REG_MAR; MOVE_BITSE A1A0 0 2 BUS_AB 0; FIRE_IFCHANGED A1A0 A1A0"],fire_name:["svg_p:text3091"],draw_data:[["svg_p:path3089","svg_p:path3597","svg_p:path3513","svg_p:path3601","svg_p:path3601-2","svg_p:path3187","svg_p:path3087","svg_p:path2995","svg_p:path3535"]],draw_name:[["svg_p:path3085"]]};ep_signals.TD={name:"TD",visible:true,type:"L",value:0,default_value:0,nbits:"1",behavior:["NOP","MV BUS_DB BS_TD; MOVE_BITSE A1A0 0 2 BUS_AB 0; FIRE_IFCHANGED A1A0 A1A0"],fire_name:["svg_p:text3103"],draw_data:[["svg_p:path3101","svg_p:path3587","svg_p:path3515","svg_p:path3071","svg_p:path3419","svg_p:path3099","svg_p:path3097","svg_p:path3559-5","svg_p:path3419-1-0","svg_p:path3583","svg_p:path3419-1","svg_p:path3493","svg_p:path3641","svg_p:path3541"]],draw_name:[["svg_p:path3095"]]};ep_signals.T1={name:"T1",visible:true,type:"L",value:0,default_value:0,nbits:"1",behavior:["NOP","MV BUS_IB REG_MBR; FIRE M7; FIRE M2; FIRE M1"],fire_name:["svg_p:text3105"],draw_data:[["svg_p:path3071","svg_p:path3069","svg_p:path3049","svg_p:path3063-9","svg_p:path3071"]],draw_name:[["svg_p:path3067"]]};ep_signals.T2={name:"T2",visible:true,type:"L",value:0,default_value:0,nbits:"1",behavior:["NOP","MV BUS_IB REG_PC; FIRE M7; FIRE M2; FIRE M1"],fire_name:["svg_p:text3449"],draw_data:[["svg_p:path3199","svg_p:path3201","svg_p:path3049"]],draw_name:[["svg_p:path3329"]]};ep_signals.T3={name:"T3",visible:true,type:"L",value:0,default_value:0,nbits:"1",behavior:["NOP","MV BUS_IB SELEC_T3; FIRE M7; FIRE M2; FIRE M1"],fire_name:["svg_p:text3451"],draw_data:[["svg_p:path3349","svg_p:path3931","svg_p:path3345","svg_p:path3049"]],draw_name:[["svg_p:path3351"]]};ep_signals.T4={name:"T4",visible:true,type:"L",value:0,default_value:0,nbits:"1",behavior:["NOP","MV BUS_IB REG_RT1; FIRE M7; FIRE M2; FIRE M1"],fire_name:["svg_p:text3453"],draw_data:[["svg_p:path3261","svg_p:path3259","svg_p:path3049"]],draw_name:[["svg_p:path3305"]]};ep_signals.T5={name:"T5",visible:true,type:"L",value:0,default_value:0,nbits:"1",behavior:["NOP","MV BUS_IB REG_RT2; FIRE M7; FIRE M2; FIRE M1"],fire_name:["svg_p:text3455"],draw_data:[["svg_p:path3275","svg_p:path3273","svg_p:path3049"]],draw_name:[["svg_p:path3307"]]};ep_signals.T6={name:"T6",visible:true,type:"L",value:0,default_value:0,nbits:"1",behavior:["NOP","MV BUS_IB ALU_C6; FIRE M7; FIRE M2; FIRE M1"],fire_name:["svg_p:text3457"],draw_data:[["svg_p:path3589","svg_p:path3317","svg_p:path3163-2","svg_p:path3049"]],draw_name:[["svg_p:path3319"]]};ep_signals.T7={name:"T7",visible:true,type:"L",value:0,default_value:0,nbits:"1",behavior:["NOP","MV BUS_IB REG_RT3; FIRE M7; FIRE M2; FIRE M1"],fire_name:["svg_p:text3459"],draw_data:[["svg_p:path3327","svg_p:path3311","svg_p:path3049"]],draw_name:[["svg_p:path3313"]]};ep_signals.T8={name:"T8",visible:true,type:"L",value:0,default_value:0,nbits:"1",behavior:["NOP","MV BUS_IB REG_SR; FIRE M7; FIRE M2; FIRE M1"],fire_name:["svg_p:text3657"],draw_data:[["svg_p:path3651","svg_p:path3647","svg_p:path3049"]],draw_name:[["svg_p:path3649"]]};ep_signals.T9={name:"T9",visible:true,type:"L",value:0,default_value:0,nbits:"1",behavior:["NOP","MV BUS_IB RA_T9; FIRE M7; FIRE M2; FIRE M1"],fire_name:["svg_p:text3147"],draw_data:[["svg_p:path3143","svg_p:path3139","svg_p:path3049","svg_p:path3143-9"]],draw_name:[["svg_p:path3133"]]};ep_signals.T10={name:"T10",visible:true,type:"L",value:0,default_value:0,nbits:"1",behavior:["NOP","MV BUS_IB RB_T10; FIRE M7; FIRE M2; FIRE M1"],fire_name:["svg_p:text3149"],draw_data:[["svg_p:path3145","svg_p:path3141","svg_p:path3049","svg_p:path3145-5"]],draw_name:[["svg_p:path3137"]]};ep_signals.T11={name:"T11",visible:true,type:"L",value:0,default_value:0,nbits:"1",behavior:["NOP","MV BUS_IB REG_MICROINS/EXCODE; FIRE M7; FIRE M2; FIRE M1"],fire_name:["svg_p:text3147-5","svg_cu:tspan4426"],draw_data:[["svg_p:path3145","svg_p:path3081-3","svg_p:path3139-7","svg_p:path3049","svg_cu:path3081-3","svg_cu:path3139-7","svg_cu:path3502"]],draw_name:[["svg_p:path3133-6","svg_cu:path3133-6"]]};ep_signals.M1={name:"M1",visible:true,type:"L",value:0,default_value:0,nbits:"1",behavior:["MV M1_C1 BUS_IB","MV M1_C1 BS_M1"],depends_on:["C1"],fire_name:["svg_p:text3469"],draw_data:[["svg_p:path3063","svg_p:path3061","svg_p:path3059"],["svg_p:path3057","svg_p:path3641","svg_p:path3419","svg_p:path3583"]],draw_name:[[],["svg_p:path3447"]]};ep_signals.M2={name:"M2",visible:true,type:"L",value:0,default_value:0,nbits:"1",behavior:["MV M2_C2 BUS_IB","ADD M2_C2 REG_PC VAL_FOUR"],depends_on:["C2"],fire_name:["svg_p:text3471"],draw_data:[["svg_p:path3217","svg_p:path3215","svg_p:path3213","svg_p:path3213-9"],["svg_p:path3211","svg_p:path3209","svg_p:path3193","svg_p:path3207","svg_p:path3197","svg_p:path3201"]],draw_name:[[],["svg_p:path3467","svg_p:path3467"]]};ep_signals.M7={name:"M7",visible:true,type:"L",value:0,default_value:0,nbits:"1",behavior:["MV M7_C7 BUS_IB","MV M7_C7 SELP_M7"],depends_on:["C7"],fire_name:["svg_p:text3673"],draw_data:[["svg_p:path3691","svg_p:path3693","svg_p:path3659"],["svg_p:path3695"]],draw_name:[[],["svg_p:path3667"]]};ep_signals.MA={name:"MA",visible:true,type:"L",value:0,default_value:0,nbits:"1",behavior:["MV MA_ALU RA_T9; FIRE COP","MV MA_ALU REG_RT1; FIRE COP"],depends_on:["SELA","SELB","SELC"],fire_name:["svg_p:text3463"],draw_data:[["svg_p:path3249","svg_p:path3161","svg_p:path3165"],["svg_p:path3279"]],draw_name:[[],["svg_p:path3423"]]};ep_signals.MB={name:"MB",visible:true,type:"L",value:0,default_value:0,nbits:"2",behavior:["MV MB_ALU RB_T10; FIRE COP","MV MB_ALU REG_RT2; FIRE COP","MV MB_ALU VAL_FOUR; FIRE COP","MV MB_ALU VAL_ONE; FIRE COP"],depends_on:["SELA","SELB","SELC"],fire_name:["svg_p:text3465"],draw_data:[["svg_p:path3281","svg_p:path3171","svg_p:path3169"],["svg_p:path3283"],["svg_p:path3295","svg_p:path3293"],["svg_p:path3297","svg_p:path3299"]],draw_name:[[],["svg_p:path3425","svg_p:path3427"]]};ep_signals.COP={name:"COP",visible:true,type:"L",value:0,default_value:0,nbits:"4",forbidden:true,behavior:["NOP_ALU","AND ALU_C6 MA_ALU MB_ALU; FIRE_IFSET T6 1; FIRE_IFSET SELP 3","OR ALU_C6 MA_ALU MB_ALU; FIRE_IFSET T6 1; FIRE_IFSET SELP 3","NOT ALU_C6 MA_ALU; FIRE_IFSET T6 1; FIRE_IFSET SELP 3","XOR ALU_C6 MA_ALU MB_ALU; FIRE_IFSET T6 1; FIRE_IFSET SELP 3","SRL ALU_C6 MA_ALU; FIRE_IFSET T6 1; FIRE_IFSET SELP 3","SRA ALU_C6 MA_ALU; FIRE_IFSET T6 1; FIRE_IFSET SELP 3","SL ALU_C6 MA_ALU; FIRE_IFSET T6 1; FIRE_IFSET SELP 3","RR ALU_C6 MA_ALU; FIRE_IFSET T6 1; FIRE_IFSET SELP 3","RL ALU_C6 MA_ALU; FIRE_IFSET T6 1; FIRE_IFSET SELP 3","ADD ALU_C6 MA_ALU MB_ALU; FIRE_IFSET T6 1; FIRE_IFSET SELP 3","SUB ALU_C6 MA_ALU MB_ALU; FIRE_IFSET T6 1; FIRE_IFSET SELP 3","MUL ALU_C6 MA_ALU MB_ALU; FIRE_IFSET T6 1; FIRE_IFSET SELP 3","DIV ALU_C6 MA_ALU MB_ALU; FIRE_IFSET T6 1; FIRE_IFSET SELP 3","MOD ALU_C6 MA_ALU MB_ALU; FIRE_IFSET T6 1; FIRE_IFSET SELP 3","LUI ALU_C6 MA_ALU; FIRE_IFSET T6 1; FIRE_IFSET SELP 3"],depends_on:["SELCOP"],fire_name:["svg_p:text3303"],draw_data:[["svg_p:path3237","svg_p:path3239","svg_p:path3261-8","svg_p:path3321","svg_p:path3901-6","svg_p:path3317-9"]],draw_name:[["svg_p:path3009","svg_p:path3301"]]};ep_signals.SELP={name:"SELP",visible:true,type:"L",value:0,default_value:0,nbits:"2",behavior:["NOP","MV SELP_M7 REG_SR; SBIT SELP_M7 FLAG_U 0; FIRE M7","MV SELP_M7 REG_SR; SBIT SELP_M7 FLAG_I 1; FIRE M7","MV SELP_M7 REG_SR; SBIT SELP_M7 FLAG_C 31; SBIT SELP_M7 FLAG_V 30; SBIT SELP_M7 FLAG_N 29; SBIT SELP_M7 FLAG_Z 28; FIRE M7"],fire_name:["svg_p:text3703"],draw_data:[[],["svg_p:path3643"],["svg_p:path3705"],["svg_p:path3675","svg_p:path3331"]],draw_name:[[],["svg_p:path3697"]]};ep_signals.SELA={name:"SELA",visible:true,type:"L",value:0,default_value:0,nbits:"5",behavior:["FIRE_IFCHANGED MR_RA SELA; RESET_CHANGED SELA"],depends_on:["RA"],fire_name:["svg_cu:text3164"],draw_data:[[]],draw_name:[[]]};ep_signals.SELB={name:"SELB",visible:true,type:"L",value:0,default_value:0,nbits:"5",behavior:["FIRE_IFCHANGED MR_RB SELB; RESET_CHANGED SELB"],depends_on:["RB"],fire_name:["svg_cu:text3168"],draw_data:[[]],draw_name:[[]]};ep_signals.SELC={name:"SELC",visible:true,type:"L",value:0,default_value:0,nbits:"5",behavior:["FIRE_IFCHANGED MR_RC SELC; RESET_CHANGED SELC"],depends_on:["RC"],fire_name:["svg_cu:text3172"],draw_data:[[]],draw_name:[[]]};ep_signals.SELCOP={name:"SELCOP",visible:true,type:"L",value:0,default_value:0,nbits:"4",behavior:["FIRE_IFCHANGED MC SELCOP; RESET_CHANGED SELCOP"],depends_on:["COP"],fire_name:["svg_cu:text3312"],draw_data:[[]],draw_name:[[]]};ep_signals.EXCODE={name:"EXCODE",visible:true,type:"L",value:0,default_value:0,nbits:"4",behavior:["FIRE T11"],fire_name:["svg_cu:text3312-6"],draw_data:[[]],draw_name:[[]]};ep_signals.RA={name:"RA",visible:true,type:"L",value:0,default_value:0,nbits:"5",forbidden:true,behavior:["GET RA_T9 BR RA; FIRE_IFSET T9 1; FIRE_IFSET MA 0"],depends_on:["SELA"],fire_name:["svg_p:text3107"],draw_data:[[]],draw_name:[["svg_p:path3109"]]};ep_signals.RB={name:"RB",visible:true,type:"L",value:0,default_value:0,nbits:"5",forbidden:true,behavior:["GET RB_T10 BR RB; FIRE_IFSET T10 1; FIRE_IFSET MB 0"],depends_on:["SELB"],fire_name:["svg_p:text3123"],draw_data:[[]],draw_name:[["svg_p:path3113"]]};ep_signals.RC={name:"RC",visible:true,type:"L",value:0,default_value:0,nbits:"5",forbidden:true,behavior:["FIRE LC"],depends_on:["SELC"],fire_name:["svg_p:text3125"],draw_data:[[]],draw_name:[["svg_p:path3117"]]};ep_signals.LC={name:"LC",visible:true,type:"E",value:0,default_value:0,nbits:"1",behavior:["NOP","SET BR RC BUS_IB"],fire_name:["svg_p:text3127"],draw_data:[["svg_p:path3153","svg_p:path3151","svg_p:path3129"]],draw_name:[["svg_p:path3121"]]};ep_signals.SE={name:"SE",visible:true,type:"L",value:0,default_value:0,nbits:"1",behavior:["MBITS SELEC_T3 0 REG_IR OFFSET SIZE 0 SE; FIRE T3; MOVE_BITS SBWA 4 1 SE; FIRE_IFCHANGED SBWA SE","MBITS SELEC_T3 0 REG_IR OFFSET SIZE 0 SE; FIRE T3; MOVE_BITS SBWA 4 1 SE; FIRE_IFCHANGED SBWA SE"],depends_on:["T3"],fire_name:["svg_p:text3593","svg_p:text3431"],draw_data:[[]],draw_name:[["svg_p:path3591","svg_p:path3447-7-7"]]};ep_signals.SIZE={name:"SIZE",visible:true,type:"L",value:0,default_value:0,nbits:"5",behavior:["MBITS SELEC_T3 0 REG_IR OFFSET SIZE 0 SE; FIRE T3"],depends_on:["T3"],fire_name:["svg_p:text3363"],draw_data:[[]],draw_name:[["svg_p:path3355"]]};ep_signals.OFFSET={name:"OFFSET",visible:true,type:"L",value:0,default_value:0,nbits:"5",behavior:["MBITS SELEC_T3 0 REG_IR OFFSET SIZE 0 SE; FIRE T3"],depends_on:["T3"],fire_name:["svg_p:text3707"],draw_data:[[]],draw_name:[["svg_p:path3359"]]};ep_signals.MC={name:"MC",visible:true,type:"L",value:0,default_value:0,nbits:"1",behavior:["MBIT COP REG_IR 0 4; FIRE_IFCHANGED COP MC","MV COP REG_MICROINS/SELCOP; FIRE_IFCHANGED COP MC"],depends_on:["SELCOP"],fire_name:["svg_cu:text3322","svg_cu:text3172-1-5"],draw_data:[["svg_cu:path3320","svg_cu:path3142"],["svg_cu:path3318","svg_cu:path3502-6","svg_cu:path3232-6"]],draw_name:[[],["svg_cu:path3306"]]};ep_signals.MR={name:"MR",visible:true,type:"L",value:0,default_value:0,nbits:"1",behavior:["MV MR_RA MR; FIRE_IFCHANGED MR_RA MR; MV MR_RB MR; FIRE_IFCHANGED MR_RB MR; MV MR_RC MR; FIRE_IFCHANGED MR_RC MR; RESET_CHANGED MR","MV MR_RA MR; FIRE_IFCHANGED MR_RA MR; MV MR_RB MR; FIRE_IFCHANGED MR_RB MR; MV MR_RC MR; FIRE_IFCHANGED MR_RC MR; RESET_CHANGED MR"],depends_on:["SELA","SELB","SELC"],fire_name:["svg_cu:text3222","svg_cu:text3242","svg_cu:text3254","svg_cu:text3172-1"],draw_data:[["svg_cu:path3494","svg_cu:path3492","svg_cu:path3490","svg_cu:path3142b","svg_cu:path3188","svg_cu:path3190","svg_cu:path3192","svg_cu:path3194","svg_cu:path3276","svg_cu:path3290","svg_cu:path3260","svg_cu:path3196","svg_cu:path3502","svg_cu:path3278","svg_cu:path3232","svg_cu:path3292"],["svg_cu:path3270","svg_cu:path3282","svg_cu:path3300","svg_cu:path3258","svg_cu:path3260","svg_cu:path3278","svg_cu:path3196","svg_cu:path3502","svg_cu:path3294","svg_cu:path3292","svg_cu:path3288","svg_cu:path3232","svg_cu:path3280"]],draw_name:[[],["svg_cu:path3220","svg_cu:path3240","svg_cu:path3252"]]};ep_signals.MR_RA={name:"MR_RA",visible:true,type:"L",value:0,default_value:0,nbits:"1",behavior:["MBIT_SN RA REG_IR REG_MICROINS/SELA 5; FIRE RA;","MV RA REG_MICROINS/SELA; FIRE RA;"],fire_name:[],draw_data:[[]],draw_name:[[]]};ep_signals.MR_RB={name:"MR_RB",visible:true,type:"L",value:0,default_value:0,nbits:"1",behavior:["MBIT_SN RB REG_IR REG_MICROINS/SELB 5; FIRE RB;","MV RB REG_MICROINS/SELB; FIRE RB;"],fire_name:[],draw_data:[[]],draw_name:[[]]};ep_signals.MR_RC={name:"MR_RC",visible:true,type:"L",value:0,default_value:0,nbits:"1",behavior:["MBIT_SN RC REG_IR REG_MICROINS/SELC 5; FIRE RC;","MV RC REG_MICROINS/SELC; FIRE RC;"],fire_name:[],draw_data:[[]],draw_name:[[]]};ep_signals.BW={name:"BW",visible:true,type:"L",value:0,default_value:0,nbits:"2",behavior:["MOVE_BITS BWA 2 2 BW; MOVE_BITS SBWA 2 2 BW; FIRE_IFCHANGED BWA BW; FIRE SBWA; RESET_CHANGED BW","MOVE_BITS BWA 2 2 BW; MOVE_BITS SBWA 2 2 BW; FIRE_IFCHANGED BWA BW; FIRE SBWA; RESET_CHANGED BW","MOVE_BITS BWA 2 2 BW; MOVE_BITS SBWA 2 2 BW; FIRE_IFCHANGED BWA BW; FIRE SBWA; RESET_CHANGED BW","MOVE_BITS BWA 2 2 BW; MOVE_BITS SBWA 2 2 BW; FIRE_IFCHANGED BWA BW; FIRE SBWA; RESET_CHANGED BW"],fire_name:["svg_p:text3433"],draw_data:[["svg_p:path3061-2-6","svg_p:path3101-8","svg_p:path3535-8"]],draw_name:[[],[]]};ep_signals.A1A0={name:"A1A0",visible:true,type:"L",value:0,default_value:0,nbits:"2",behavior:["MOVE_BITS BWA 0 2 A1A0; MOVE_BITS SBWA 0 2 A1A0; FIRE BWA; FIRE SBWA","MOVE_BITS BWA 0 2 A1A0; MOVE_BITS SBWA 0 2 A1A0; FIRE BWA; FIRE SBWA","MOVE_BITS BWA 0 2 A1A0; MOVE_BITS SBWA 0 2 A1A0; FIRE BWA; FIRE SBWA","MOVE_BITS BWA 0 2 A1A0; MOVE_BITS SBWA 0 2 A1A0; FIRE BWA; FIRE SBWA"],fire_name:["svg_p:text3603"],draw_data:[[],[]],draw_name:[[],[]]};ep_signals.BWA={name:"BWA",visible:false,type:"L",value:0,default_value:0,nbits:"4",behavior:["BSEL BS_TD 0 8 REG_MBR 0; FIRE TD; FIRE R; FIRE W","BSEL BS_TD 8 8 REG_MBR 0; FIRE TD; FIRE R; FIRE W","BSEL BS_TD 16 8 REG_MBR 0; FIRE TD; FIRE R; FIRE W","BSEL BS_TD 24 8 REG_MBR 0; FIRE TD; FIRE R; FIRE W","BSEL BS_TD 0 16 REG_MBR 0; FIRE TD; FIRE R; FIRE W","BSEL BS_TD 0 16 REG_MBR 0; FIRE TD; FIRE R; FIRE W","BSEL BS_TD 0 16 REG_MBR 0; FIRE TD; FIRE R; FIRE W","BSEL BS_TD 0 16 REG_MBR 0; FIRE TD; FIRE R; FIRE W","BSEL BS_TD 16 16 REG_MBR 0; FIRE TD; FIRE R; FIRE W","BSEL BS_TD 16 16 REG_MBR 0; FIRE TD; FIRE R; FIRE W","BSEL BS_TD 16 16 REG_MBR 0; FIRE TD; FIRE R; FIRE W","BSEL BS_TD 16 16 REG_MBR 0; FIRE TD; FIRE R; FIRE W","MV BS_TD REG_MBR; FIRE TD; FIRE R; FIRE W","MV BS_TD REG_MBR; FIRE TD; FIRE R; FIRE W","MV BS_TD REG_MBR; FIRE TD; FIRE R; FIRE W","MV BS_TD REG_MBR; FIRE TD; FIRE R; FIRE W"],fire_name:["svg_p:text3533-5"],draw_data:[[],[]],draw_name:[[],[]]};ep_signals.SBWA={name:"SBWA",visible:false,type:"L",value:0,default_value:0,nbits:"5",behavior:["BSEL BS_M1 0 8 BUS_DB 0; FIRE M1","BSEL BS_M1 0 8 BUS_DB 8; FIRE M1","BSEL BS_M1 0 8 BUS_DB 16; FIRE M1","BSEL BS_M1 0 8 BUS_DB 24; FIRE M1","BSEL BS_M1 0 16 BUS_DB 0; FIRE M1","BSEL BS_M1 0 16 BUS_DB 0; FIRE M1","BSEL BS_M1 0 16 BUS_DB 0; FIRE M1","BSEL BS_M1 0 16 BUS_DB 0; FIRE M1","BSEL BS_M1 0 16 BUS_DB 16; FIRE M1","BSEL BS_M1 0 16 BUS_DB 16; FIRE M1","BSEL BS_M1 0 16 BUS_DB 16; FIRE M1","BSEL BS_M1 0 16 BUS_DB 16; FIRE M1","MV BS_M1 BUS_DB; FIRE M1","MV BS_M1 BUS_DB; FIRE M1","MV BS_M1 BUS_DB; FIRE M1","MV BS_M1 BUS_DB; FIRE M1","BSEL BS_M1 0 8 BUS_DB 0; EXT_SIG BS_M1 7; FIRE M1","BSEL BS_M1 0 8 BUS_DB 8; EXT_SIG BS_M1 7; FIRE M1","BSEL BS_M1 0 8 BUS_DB 16; EXT_SIG BS_M1 7; FIRE M1","BSEL BS_M1 0 8 BUS_DB 24; EXT_SIG BS_M1 7; FIRE M1","BSEL BS_M1 0 16 BUS_DB 0; EXT_SIG BS_M1 15; FIRE M1","BSEL BS_M1 0 16 BUS_DB 0; EXT_SIG BS_M1 15; FIRE M1","BSEL BS_M1 0 16 BUS_DB 0; EXT_SIG BS_M1 15; FIRE M1","BSEL BS_M1 0 16 BUS_DB 0; EXT_SIG BS_M1 15; FIRE M1","BSEL BS_M1 0 16 BUS_DB 16; EXT_SIG BS_M1 15; FIRE M1","BSEL BS_M1 0 16 BUS_DB 16; EXT_SIG BS_M1 15; FIRE M1","BSEL BS_M1 0 16 BUS_DB 16; EXT_SIG BS_M1 15; FIRE M1","BSEL BS_M1 0 16 BUS_DB 16; EXT_SIG BS_M1 15; FIRE M1","MV BS_M1 BUS_DB; FIRE M1","MV BS_M1 BUS_DB; FIRE M1","MV BS_M1 BUS_DB; FIRE M1","MV BS_M1 BUS_DB; FIRE M1"],fire_name:[],draw_data:[[],[]],draw_name:[[],[]]};ep_signals.IOR={name:"IOR",visible:true,type:"L",value:0,default_value:0,nbits:"1",behavior:["NOP","MOVE_BITS KBD_IOR 0 1 IOR; MOVE_BITS SCR_IOR 0 1 IOR; FIRE KBD_IOR; FIRE SCR_IOR"],fire_name:["svg_p:text3715"],draw_data:[[],["svg_p:path3733","svg_p:path3493","svg_p:text3715","svg_p:path3493"]],draw_name:[[],[]]};ep_signals.IOW={name:"IOW",visible:true,type:"L",value:0,default_value:0,nbits:"1",behavior:["NOP","MOVE_BITS SCR_IOW 0 1 IOW; FIRE SCR_IOW; MOVE_BITS IO_IOW 0 1 IOW; FIRE IO_IOW;"],fire_name:["svg_p:text3715"],draw_data:[[],["svg_p:path3735","svg_p:path3493","svg_p:text3717","svg_p:path3493"]],draw_name:[[],[]]};ep_signals.TEST_C={name:"TEST_C",visible:true,type:"L",value:0,default_value:0,nbits:"1",forbidden:true,behavior:["MV FLAG_C VAL_ZERO; FIRE_IFSET SELP 2","MV FLAG_C VAL_ONE; FIRE_IFSET SELP 3"],depends_on:["SELCOP"],fire_name:["svg_p:text3701-3"],draw_data:[["svg_p:text3701-3"]],draw_name:[[]]};ep_signals.TEST_V={name:"TEST_V",visible:true,type:"L",value:0,default_value:0,nbits:"1",forbidden:true,behavior:["MV FLAG_V VAL_ZERO; FIRE_IFSET SELP 2","MV FLAG_V VAL_ONE; FIRE_IFSET SELP 3"],depends_on:["SELCOP"],fire_name:["svg_p:text3701-3-1"],draw_data:[["svg_p:text3701-3-1"]],draw_name:[[]]};ep_signals.TEST_N={name:"TEST_N",visible:true,type:"L",value:0,default_value:0,nbits:"1",forbidden:true,behavior:["MV FLAG_N VAL_ZERO; FIRE_IFSET SELP 2","MV FLAG_N VAL_ONE; FIRE_IFSET SELP 3"],depends_on:["SELCOP"],fire_name:["svg_p:text3701-3-2"],draw_data:[["svg_p:text3701-3-2"]],draw_name:[[]]};ep_signals.TEST_Z={name:"TEST_Z",visible:true,type:"L",value:0,default_value:0,nbits:"1",forbidden:true,behavior:["MV FLAG_Z VAL_ZERO; FIRE_IFSET SELP 2","MV FLAG_Z VAL_ONE; FIRE_IFSET SELP 3"],depends_on:["SELCOP"],fire_name:["svg_p:text3701-3-5"],draw_data:[["svg_p:text3701-3-5"]],draw_name:[[]]};ep_signals.TEST_I={name:"TEST_I",visible:true,type:"L",value:0,default_value:0,nbits:"1",behavior:["MV FLAG_I VAL_ZERO; FIRE_IFSET SELP 2","MV FLAG_I VAL_ONE; FIRE_IFSET SELP 2"],depends_on:["CLK"],fire_name:["svg_p:text3669"],draw_data:[["svg_p:text3669"]],draw_name:[[]]};ep_signals.TEST_U={name:"TEST_U",visible:true,type:"L",value:0,default_value:0,nbits:"1",behavior:["MV FLAG_U VAL_ZERO; FIRE_IFSET SELP 1","MV FLAG_U VAL_ONE; FIRE_IFSET SELP 1"],depends_on:["CLK"],fire_name:["svg_p:text3669-1"],draw_data:[["svg_p:text3669-1"]],draw_name:[[]]};ep_signals.TEST_INTV={name:"TEST_INTV",visible:true,type:"L",value:0,default_value:0,nbits:"8",forbidden:true,behavior:["MBIT INTV TEST_INTV 0 32"],depends_on:["INT"],fire_name:["svg_p:tspan4225"],draw_data:[["svg_p:path3749"]],draw_name:[[]]};ep_behaviors.NOP={nparameters:1,operation:function(a){}};ep_behaviors.NOP_ALU={nparameters:1,operation:function(a){update_nzvc(0,0,0,0)}};ep_behaviors.MV={nparameters:3,types:["X","X"],operation:function(a){r=a[2].split("/");sim_elto_dst=get_reference(a[1]);sim_elto_org=get_reference(r[0]);newval=get_value(sim_elto_org);if(1!=r.length){newval=newval[r[1]]}if(typeof newval!="undefined"){set_value(sim_elto_dst,newval)}}};ep_behaviors.NOT_ES={nparameters:3,types:["S","E"],operation:function(a){set_value(ep_signals[a[1]],Math.abs(get_value(ep_states[a[2]])-1))}};ep_behaviors.GET={nparameters:4,types:["E","E","S"],operation:function(a){set_value(ep_states[a[1]],get_value(ep_states[a[2]][ep_signals[a[3]].value]))}};ep_behaviors.SET={nparameters:4,types:["E","S","E"],operation:function(a){set_value(ep_states[a[1]][ep_signals[a[2]].value],get_value(ep_states[a[3]]))}};ep_behaviors.AND={nparameters:4,types:["E","E","E"],operation:function(b){var a=get_value(ep_states[b[2]])&get_value(ep_states[b[3]]);set_value(ep_states[b[1]],a);update_nzvc((a<0)?1:0,(a==0)?1:0,0,0)}};ep_behaviors.OR={nparameters:4,types:["E","E","E"],operation:function(b){var a=get_value(ep_states[b[2]])|get_value(ep_states[b[3]]);set_value(ep_states[b[1]],a);update_nzvc((a<0)?1:0,(a==0)?1:0,0,0)}};ep_behaviors.NOT={nparameters:3,types:["E","E"],operation:function(b){var a=~(get_value(ep_states[b[2]]));set_value(ep_states[b[1]],a);update_nzvc((a<0)?1:0,(a==0)?1:0,0,0)}};ep_behaviors.XOR={nparameters:4,types:["E","E","E"],operation:function(b){var a=get_value(ep_states[b[2]])^get_value(ep_states[b[3]]);set_value(ep_states[b[1]],a);update_nzvc((a<0)?1:0,(a==0)?1:0,0,0)}};ep_behaviors.SRL={nparameters:3,types:["E","E"],operation:function(b){var a=(get_value(ep_states[b[2]]))>>>1;set_value(ep_states[b[1]],a);update_nzvc((a<0)?1:0,(a==0)?1:0,0,0)}};ep_behaviors.SRA={nparameters:3,types:["E","E"],operation:function(b){var a=(get_value(ep_states[b[2]]))>>1;set_value(ep_states[b[1]],a);update_nzvc((a<0)?1:0,(a==0)?1:0,0,0)}};ep_behaviors.SL={nparameters:3,types:["E","E"],operation:function(b){var a=(get_value(ep_states[b[2]]))<<1;set_value(ep_states[b[1]],a);update_nzvc((a<0)?1:0,(a==0)?1:0,0,(a)>>>31)}};ep_behaviors.RR={nparameters:3,types:["E","E"],operation:function(b){var a=((get_value(ep_states[b[2]]))>>>1)|(((get_value(ep_states[b[2]]))&1)<<31);set_value(ep_states[b[1]],a);update_nzvc((a<0)?1:0,(a==0)?1:0,0,0)}};ep_behaviors.RL={nparameters:3,types:["E","E"],operation:function(b){var a=((get_value(ep_states[b[2]]))<<1)|(((get_value(ep_states[b[2]]))&2147483648)>>>31);set_value(ep_states[b[1]],a);update_nzvc((a<0)?1:0,(a==0)?1:0,0,0)}};ep_behaviors.ADD={nparameters:4,types:["E","E","E"],operation:function(m){var k=get_value(ep_states[m[2]])<<0;var f=get_value(ep_states[m[3]])<<0;var e=k+f;set_value(ep_states[m[1]],e>>>0);var h=(e<0)?1:0;var d=(e==0)?1:0;var g=(k>>>31)&&(f>>>31);var n=0;if((e<0)&&(k>=0)&&(f>=0)){n=1}if((e>=0)&&(k<0)&&(f<0)){n=1}update_nzvc(h,d,n,g)}};ep_behaviors.SUB={nparameters:4,types:["E","E","E"],operation:function(m){var k=get_value(ep_states[m[2]])<<0;var f=get_value(ep_states[m[3]])<<0;var e=k-f;set_value(ep_states[m[1]],e>>>0);var h=(e<0)?1:0;var d=(e==0)?1:0;var g=(k>>>31)&&(f>>>31);var n=0;if((e<0)&&(k>=0)&&(f>=0)){n=1}if((e>=0)&&(k<0)&&(f<0)){n=1}update_nzvc(h,d,n,g)}};ep_behaviors.MUL={nparameters:4,types:["E","E","E"],operation:function(m){var k=get_value(ep_states[m[2]])<<0;var f=get_value(ep_states[m[3]])<<0;var e=k*f;set_value(ep_states[m[1]],e>>>0);var h=(e<0)?1:0;var d=(e==0)?1:0;var g=0;var n=0;if((e<0)&&(k>=0)&&(f>=0)){n=1}if((e>=0)&&(k<0)&&(f<0)){n=1}update_nzvc(h,d,n,g)}};ep_behaviors.DIV={nparameters:4,types:["E","E","E"],operation:function(g){var f=(get_value(ep_states[g[2]])<<0);var e=(get_value(ep_states[g[3]])<<0);if(0==e){set_value(ep_states[g[1]],0);update_nzvc(0,1,1,0);return}var d=Math.floor(f/e);set_value(ep_states[g[1]],d);update_nzvc((d<0)?1:0,(d==0)?1:0,0,0)}};ep_behaviors.MOD={nparameters:4,types:["E","E","E"],operation:function(b){var a=(get_value(ep_states[b[2]])<<0)%(get_value(ep_states[b[3]])<<0);set_value(ep_states[b[1]],a);update_nzvc((a<0)?1:0,(a==0)?1:0,0,0)}};ep_behaviors.LUI={nparameters:3,types:["E","E"],operation:function(b){var a=(get_value(ep_states[b[2]]))<<16;set_value(ep_states[b[1]],a);update_nzvc((a<0)?1:0,(a==0)?1:0,0,0)}};ep_behaviors.MBIT={nparameters:5,types:["X","X","I","I"],operation:function(a){sim_elto_org=get_reference(a[2]);sim_elto_dst=get_reference(a[1]);var f=parseInt(a[3]);var d=parseInt(a[4]);var e=get_value(sim_elto_org).toString(2);var b="00000000000000000000000000000000".substring(0,32-e.length)+e;b=b.substr(31-(f+d-1),d);set_value(sim_elto_dst,parseInt(b,2))}};ep_behaviors.MBIT_SN={nparameters:5,types:["S","E","E","I"],operation:function(b){var g=0;var f=b[3].split("/");if(1==f.length){g=get_value(ep_states[b[3]])}else{if(typeof ep_states[f[0]].value[f[1]]!="undefined"){g=ep_states[f[0]].value[f[1]]}else{if(typeof ep_signals[f[1]].default_value!="undefined"){g=ep_signals[f[1]].default_value}else{if(typeof ep_states[f[1]].default_value!="undefined"){g=ep_states[f[1]].default_value}else{alert("WARN: undefined state/field pair -> "+f[0]+"/"+f[1])}}}}var h=parseInt(b[4]);var e=get_value(ep_states[b[2]]).toString(2);var d="00000000000000000000000000000000".substring(0,32-e.length)+e;var a=d.substr(31-(g+h-1),h);set_value(ep_signals[b[1]],parseInt(a,2))}};ep_behaviors.SBIT={nparameters:4,types:["X","X","I"],operation:function(a){sim_elto_org=get_reference(a[2]);sim_elto_dst=get_reference(a[1]);var b=(sim_elto_dst.value&~(1<<a[3]))|(sim_elto_org.value<<a[3]);set_value(sim_elto_dst,(b>>>0))}};ep_behaviors.MBITS={nparameters:8,types:["E","I","E","S","S","I","S"],operation:function(b){var g=parseInt(ep_signals[b[4]].value);var e=parseInt(ep_signals[b[5]].value);var f=get_value(ep_states[b[3]]).toString(2);var d=("00000000000000000000000000000000".substring(0,32-f.length)+f);d=d.substr(31-(g+e-1),e);var a="00000000000000000000000000000000".substring(0,32-d.length)+d;if(("1"==ep_signals[b[7]].value)&&("1"==d.substr(0,1))){a="11111111111111111111111111111111".substring(0,32-d.length)+d}set_value(ep_states[b[1]],parseInt(a,2))}};ep_behaviors.BSEL={nparameters:6,types:["E","I","I","E","I"],operation:function(e){var k=parseInt(e[2]);var h=parseInt(e[5]);var a=parseInt(e[3]);var g=get_value(ep_states[e[4]]).toString(2);var f="00000000000000000000000000000000".substring(0,32-g.length)+g;f=f.substr(31-(h+a)+1,a);var d="00000000000000000000000000000000".substring(0,32-f.length)+f;var b="00000000000000000000000000000000".substr(0,k);d=d+b;set_value(ep_states[e[1]],parseInt(d,2))}};ep_behaviors.EXT_SIG={nparameters:3,types:["E","I"],operation:function(d){var f=get_value(ep_states[d[1]]).toString(2);var e=("00000000000000000000000000000000".substring(0,32-f.length)+f);var b=e.substr(31-d[2],31);var a=b;if("1"==e[31-d[2]]){a="11111111111111111111111111111111".substring(0,32-b.length)+a}set_value(ep_states[d[1]],parseInt(a,2))}};ep_behaviors.MOVE_BITS={nparameters:5,types:["S","I","I","S"],operation:function(h){var d=parseInt(h[2]);var a=0;var f=parseInt(h[3]);var g=ep_signals[h[4]].value.toString(2);g=("00000000000000000000000000000000".substring(0,32-g.length)+g);g=g.substr(31-a-f+1,f);var e=ep_signals[h[1]].value.toString(2);e=("00000000000000000000000000000000".substring(0,32-e.length)+e);var m=e.substr(0,32-(d+f));var k=e.substr(31-d+1,d);var b=m+g+k;set_value(ep_signals[h[1]],parseInt(b,2))}};ep_behaviors.MOVE_BITSE={nparameters:6,types:["S","I","I","E","I"],operation:function(h){var d=parseInt(h[2]);var a=parseInt(h[5]);var f=parseInt(h[3]);var g=get_value(ep_states[h[4]]).toString(2);g=("00000000000000000000000000000000".substring(0,32-g.length)+g);g=g.substr(31-a-f+1,f);var e=ep_signals[h[1]].value.toString(2);e=("00000000000000000000000000000000".substring(0,32-e.length)+e);var m=e.substr(0,32-(d+f));var k=e.substr(31-d+1,d);var b=m+g+k;set_value(ep_signals[h[1]],parseInt(b,2))}};ep_behaviors.DECO={nparameters:1,operation:function(k){var m=get_value(ep_states.REG_IR).toString(2);m="00000000000000000000000000000000".substring(0,32-m.length)+m;var b=parseInt(m.substr(0,6),2);var e=parseInt(m.substr(28,4),2);ep_states.INEX.value=0;var h=decode_instruction(m);if(null==h){alert("ERROR: undefined instruction code in firmware (co:"+b.toString(2)+", cop:"+e.toString(2)+")");ep_states.ROM_MUXA.value=0;ep_states.INEX.value=1;return -1}var d=b<<6;if(typeof h.cop!="undefined"){d=d+e}if(typeof ep_internal_states.ROM[d]=="undefined"){alert("ERROR: undefined rom address "+d+" in firmware");ep_states.ROM_MUXA.value=0;return -1}ep_states.ROM_MUXA.value=ep_internal_states.ROM[d];var a=get_value(ep_states.DECO_INS);set_value(ep_states.DECO_INS,a+1);var g=get_value(ep_states.REG_PC)-4;var f=get_deco_from_pc(g);set_value(ep_states.REG_IR_DECO,f);show_dbg_ir(get_value(ep_states.REG_IR_DECO))}};ep_behaviors.FIRE={nparameters:2,types:["S"],operation:function(a){if(ep_internal_states.fire_stack.indexOf(a[1])!=-1){return}ep_internal_states.fire_stack.push(a[1]);update_draw(ep_signals[a[1]],ep_signals[a[1]].value);if("L"==ep_signals[a[1]].type){update_state(a[1])}ep_internal_states.fire_stack.pop(a[1]);check_buses(a[1])}};ep_behaviors.FIRE_IFSET={nparameters:3,types:["S","I"],operation:function(a){if(get_value(ep_signals[a[1]])!=parseInt(a[2])){return}ep_behaviors.FIRE.operation(a)}};ep_behaviors.FIRE_IFCHANGED={nparameters:3,types:["S","X"],operation:function(a){sim_elto=get_reference(a[2]);if(sim_elto.changed==false){return}ep_behaviors.FIRE.operation(a)}};ep_behaviors.RESET_CHANGED={nparameters:2,types:["X"],operation:function(a){sim_elto=get_reference(a[1]);sim_elto.changed=false}};ep_behaviors.CLOCK={nparameters:1,operation:function(s_expr){var val=get_value(ep_states.CLK);set_value(ep_states.CLK,val+1);for(var i=0;i<jit_fire_order.length;i++){fn_updateE_now(jit_fire_order[i])}var new_maddr=get_value(ep_states.MUXA_MICROADDR);set_value(ep_states.REG_MICROADDR,new_maddr);if(typeof ep_internal_states.MC[new_maddr]!="undefined"){var new_mins=Object.create(ep_internal_states.MC[new_maddr])}else{var new_mins=Object.create(ep_states.REG_MICROINS.default_value)}ep_states.REG_MICROINS.value=new_mins;for(var key in ep_signals){if(typeof new_mins[key]!="undefined"){set_value(ep_signals[key],new_mins[key])}else{set_value(ep_signals[key],ep_signals[key].default_value)}}for(var i=0;i<jit_fire_order.length;i++){fn_updateL_now(jit_fire_order[i])}if(typeof new_mins.NATIVE_JIT!="undefined"){new_mins.NATIVE_JIT()}else{if(typeof new_mins.NATIVE!="undefined"){eval(new_mins.NATIVE)}}}};ep_behaviors.RESET={nparameters:1,operation:function(a){for(var d in ep_states){reset_value(ep_states[d])}for(var d in ep_signals){reset_value(ep_signals[d])}ep_events.screen={};ep_events.keybd={};ep_events.io={};ep_events.mem={};for(var b=0;b<ep_internal_states.io_int_factory.length;b++){set_var(ep_internal_states.io_int_factory[b].accumulated,0);set_var(ep_internal_states.io_int_factory[b].active,false)}}};ep_behaviors.UPDATEDPC={nparameters:1,operation:function(a){show_asmdbg_pc()}};ep_components.MEMORY={name:"MEMORY",version:"1",write_state:function(d){if(typeof d.MEMORY=="undefined"){d.MEMORY={}}var b=0;var e=0;for(var a in ep_internal_states.MP){e=parseInt(ep_internal_states.MP[a]);if(e!=0){b=parseInt(a).toString(16);d.MEMORY["0x"+b]={type:"memory",default_value:0,id:"0x"+b,op:"=",value:"0x"+e.toString(16)}}}return d},read_state:function(d,a){if(typeof d.MEMORY=="undefined"){d.MEMORY={}}var b=parseInt(a.id).toString(16);var e=parseInt(a.value).toString(16);if("MEMORY"==a.type.toUpperCase().trim()){d.MEMORY["0x"+b]={type:"memory",default_value:0,id:"0x"+b,op:a.condition,value:"0x"+e};return true}return false},get_state:function(b){var a=parseInt(b);if(typeof ep_internal_states.MP[a]!="undefined"){return"0x"+parseInt(ep_internal_states.MP[a]).toString(16)}return null}};ep_internal_states.segments={};ep_internal_states.MP={};ep_internal_states.MP_wc=0;ep_signals.MRDY={name:"MRDY",visible:true,type:"L",value:0,default_value:0,nbits:"1",depends_on:["CLK"],behavior:["FIRE_IFCHANGED MRDY C","FIRE_IFCHANGED MRDY C"],fire_name:["svg_p:tspan3916"],draw_data:[[],["svg_p:path3895","svg_p:path3541"]],draw_name:[[],[]]};ep_signals.R={name:"R",visible:true,type:"L",value:0,default_value:0,nbits:"1",behavior:["NOP","MEM_READ BUS_AB BUS_DB BWA MRDY CLK; FIRE MRDY"],fire_name:["svg_p:text3533-5-2","svg_p:text3713"],draw_data:[[],["svg_p:path3557","svg_p:path3571"]],draw_name:[[],[]]};ep_signals.W={name:"W",visible:true,type:"L",value:0,default_value:0,nbits:"1",behavior:["NOP","MEM_WRITE BUS_AB BUS_DB BWA MRDY CLK; FIRE MRDY"],fire_name:["svg_p:text3533-5-08","svg_p:text3527","svg_p:text3431-7"],draw_data:[[],["svg_p:path3559","svg_p:path3575","svg_p:path3447-7"]],draw_name:[[],[]]};ep_behaviors.MEM_READ={nparameters:6,types:["E","E","S","S","E"],operation:function(b){var a=ep_states[b[1]].value;var d=ep_states[b[2]].value;var h=ep_signals[b[3]].value;var f=get_value(ep_states[b[5]].value);ep_signals[b[4]].value=0;var g=get_var(ep_internal_states.MP_wc);if((typeof ep_events.mem[f-1]!="undefined")&&(ep_events.mem[f-1]>0)){g=ep_events.mem[f-1]-1}ep_events.mem[f]=g;if(g>0){return}var e=0;a=a&4294967292;if(typeof ep_internal_states.MP[a]!="undefined"){e=ep_internal_states.MP[a]}if(0==(h&12)){if(0==(h&3)){d=(d&4294967040)|(e&255)}if(1==(h&3)){d=(d&4294902015)|(e&65280)}if(2==(h&3)){d=(d&4278255615)|(e&16711680)}if(3==(h&3)){d=(d&16777215)|(e&4278190080)}}else{if(1==(h&12)){if(0==(h&2)){d=(d&4294901760)|(e&65535)}if(1==(h&2)){d=(d&65535)|(e&4294901760)}}else{d=e}}ep_states[b[2]].value=(d>>>0);ep_signals[b[4]].value=1;show_main_memory(ep_internal_states.MP,a,false,false)}};ep_behaviors.MEM_WRITE={nparameters:6,types:["E","E","S","S","E"],operation:function(b){var a=ep_states[b[1]].value;var d=ep_states[b[2]].value;var h=ep_signals[b[3]].value;var f=get_value(ep_states[b[5]].value);ep_signals[b[4]].value=0;var g=get_var(ep_internal_states.MP_wc);if((typeof ep_events.mem[f-1]!="undefined")&&(ep_events.mem[f-1]>0)){g=ep_events.mem[f-1]-1}ep_events.mem[f]=g;if(g>0){return}var e=0;a=a&4294967292;if(typeof ep_internal_states.MP[a]!="undefined"){e=ep_internal_states.MP[a]}if(0==(h&12)){if(0==(h&3)){e=(e&4294967040)|(d&255)}if(1==(h&3)){e=(e&4294902015)|(d&65280)}if(2==(h&3)){e=(e&4278255615)|(d&16711680)}if(3==(h&3)){e=(e&16777215)|(d&4278190080)}}else{if(1==(h&12)){if(0==(h&2)){e=(e&4294901760)|(d&65535)}if(1==(h&2)){e=(e&65535)|(d&4294901760)}}else{e=d}}ep_internal_states.MP[a]=(e>>>0);ep_signals[b[4]].value=1;show_main_memory(ep_internal_states.MP,a,false,true)}};ep_components.IO={name:"IO",version:"1",write_state:function(a){return a},read_state:function(b,a){return false},get_state:function(a){return null}};ep_internal_states.io_int_factory=[];ep_internal_states.io_int_factory[0]={period:0,probability:0.5,accumulated:0,active:false};ep_internal_states.io_int_factory[1]={period:0,probability:0.5,accumulated:0,active:false};ep_internal_states.io_int_factory[2]={period:0,probability:0.5,accumulated:0,active:false};ep_internal_states.io_int_factory[3]={period:0,probability:0.5,accumulated:0,active:false};ep_internal_states.io_int_factory[4]={period:0,probability:0.5,accumulated:0,active:false};ep_internal_states.io_int_factory[5]={period:0,probability:0.5,accumulated:0,active:false};ep_internal_states.io_int_factory[6]={period:0,probability:0.5,accumulated:0,active:false};ep_internal_states.io_int_factory[7]={period:0,probability:0.5,accumulated:0,active:false};var IOSR_ID=4352;var IOCR_ID=4356;var IODR_ID=4360;ep_internal_states.io_hash[IOSR_ID]="IOSR";ep_internal_states.io_hash[IOCR_ID]="IOCR";ep_internal_states.io_hash[IODR_ID]="IODR";ep_states.IOSR={name:"IOSR",visible:false,nbits:"32",value:0,default_value:0,draw_data:[]};ep_states.IOCR={name:"IOCR",visible:false,nbits:"32",value:0,default_value:0,draw_data:[]};ep_states.IODR={name:"IODR",visible:false,nbits:"32",value:0,default_value:0,draw_data:[]};ep_signals.INT={name:"INT",visible:true,type:"L",value:0,default_value:0,nbits:"1",depends_on:["CLK"],behavior:["FIRE C","FIRE C"],fire_name:["svg_p:tspan4199"],draw_data:[[],["svg_p:path3809"]],draw_name:[[],[]]};ep_signals.IORDY={name:"IORDY",visible:true,type:"L",value:0,default_value:0,nbits:"1",depends_on:["CLK"],behavior:["FIRE_IFCHANGED IORDY C","FIRE_IFCHANGED IORDY C"],fire_name:["svg_p:tspan4089","svg_p:path3793"],draw_data:[[],["svg_p:path3897"]],draw_name:[[],[]]};ep_signals.IO_IOR={name:"IO_IOR",visible:true,type:"L",value:0,default_value:0,nbits:"1",behavior:["NOP","IO_IOR BUS_AB BUS_DB IOSR IOCR IODR CLK; FIRE SBWA"],fire_name:["svg_p:tspan4173","svg_p:text3715"],draw_data:[[],["svg_p:path3795","svg_p:path3733"]],draw_name:[[],[]]};ep_signals.IO_IOW={name:"IO_IOW",visible:true,type:"L",value:0,default_value:0,nbits:"1",behavior:["NOP","IO_IOW BUS_AB BUS_DB IOSR IOCR IODR CLK; FIRE SBWA"],fire_name:["svg_p:text3785-0-6-0-5-5","svg_p:text3717"],draw_data:[[],["svg_p:path3805","svg_p:path3733"]],draw_name:[[],[]]};ep_signals.IO_IE={name:"IO_IE",visible:true,type:"L",value:1,default_value:1,nbits:"1",behavior:["NOP","IO_CHK_I CLK INT INTV; FIRE C"],fire_name:[],draw_data:[[],[]],draw_name:[[],[]]};ep_signals.INTA={name:"INTA",visible:true,type:"L",value:1,default_value:0,nbits:"1",behavior:["NOP","INTA CLK INT INTA BUS_DB INTV; FIRE BW; FIRE C"],fire_name:["svg_p:text3785-0-6-0-5-5-1-1"],draw_data:[[],["svg_p:path3807","svg_p:path3737"]],draw_name:[[],[]]};ep_behaviors.IO_IOR={nparameters:7,types:["E","E","E","E","E","E"],operation:function(a){var f=get_value(ep_states[a[1]]);var b=get_value(ep_states[a[3]]);var d=get_value(ep_states[a[4]]);var e=get_value(ep_states[a[5]]);if(f==IOSR_ID){set_value(ep_states[a[2]],b)}if(f==IOCR_ID){set_value(ep_states[a[2]],d)}if(f==IODR_ID){set_value(ep_states[a[2]],e)}}};ep_behaviors.IO_IOW={nparameters:7,types:["E","E","E","E","E","E"],operation:function(b){var f=get_value(ep_states[b[1]]);var d=get_value(ep_states[b[2]]);if((f!=IOSR_ID)&&(f!=IOCR_ID)&&(f!=IODR_ID)){return}if(f==IOSR_ID){set_value(ep_states[b[3]],d)}if(f==IOCR_ID){set_value(ep_states[b[4]],d)}if(f==IODR_ID){set_value(ep_states[b[5]],d)}var a=get_value(ep_states[b[4]]);var e=get_value(ep_states[b[5]]);if((a<0)||(a>7)){return}set_var(ep_internal_states.io_int_factory[a].period,e);set_var(ep_internal_states.io_int_factory[a].probability,1);if(0==e){set_var(ep_internal_states.io_int_factory[a].probability,0)}}};ep_behaviors.IO_CHK_I={nparameters:4,types:["E","S","E"],operation:function(a){var d=get_value(ep_states[a[1]]);for(var b=ep_internal_states.io_int_factory.length-1;b>=0;b--){if(get_var(ep_internal_states.io_int_factory[b].period)==0){continue}if(get_var(ep_internal_states.io_int_factory[b].active)==true){set_value(ep_signals[a[2]],1);set_value(ep_states[a[3]],b)}if((d%get_var(ep_internal_states.io_int_factory[b].period))==0){if(Math.random()>get_var(ep_internal_states.io_int_factory[b].probability)){continue}set_var(ep_internal_states.io_int_factory[b].accumulated,get_var(ep_internal_states.io_int_factory[b].accumulated)+1);set_var(ep_internal_states.io_int_factory[b].active,true);if(typeof ep_events.io[d]=="undefined"){ep_events.io[d]=[]}ep_events.io[d].push(b);set_value(ep_signals[a[2]],1);set_value(ep_states[a[3]],b)}}}};ep_behaviors.INTA={nparameters:6,types:["E","S","S","E","E"],operation:function(a){var d=get_value(ep_states[a[1]]);if(typeof ep_events.io[d]!="undefined"){set_value(ep_states[a[4]],ep_events.io[d][0]);return}set_value(ep_signals[a[2]],0);set_value(ep_states[a[5]],0);for(var b=0;b<ep_internal_states.io_int_factory.length;b++){if(get_var(ep_internal_states.io_int_factory[b].active)){set_value(ep_signals[a[2]],0);set_value(ep_states[a[5]],b);set_value(ep_states[a[4]],b);if(typeof ep_events.io[d]=="undefined"){ep_events.io[d]=[]}ep_events.io[d].push(b);set_var(ep_internal_states.io_int_factory[b].active,false);break}}}};ep_components.KBD={name:"KBD",version:"1",write_state:function(a){return a},read_state:function(b,a){return false},get_state:function(a){return null}};var KBDR_ID=256;var KBSR_ID=260;ep_internal_states.io_hash[KBDR_ID]="KBDR";ep_internal_states.io_hash[KBSR_ID]="KBSR";ep_states.KBDR={name:"KBDR",visible:false,nbits:"32",value:0,default_value:0,draw_data:[]};ep_states.KBSR={name:"KBSR",visible:false,nbits:"32",value:0,default_value:0,draw_data:[]};ep_signals.KBD_IOR={name:"IOR",visible:true,type:"L",value:0,default_value:0,nbits:"1",behavior:["NOP","KBD_IOR BUS_AB BUS_DB KBDR KBSR CLK; FIRE SBWA"],fire_name:["svg_p:tspan4057"],draw_data:[[],["svg_p:path3863","svg_p:path3847"]],draw_name:[[],[]]};ep_behaviors.KBD_IOR={nparameters:6,types:["E","E","E","E","E"],operation:function(d){var f=get_value(ep_states[d[1]]);var e=get_value(ep_states[d[5]]);if((f!=KBDR_ID)&&(f!=KBSR_ID)){return}if(typeof ep_events.keybd[e]!="undefined"){if(f==KBDR_ID){set_value(ep_states[d[2]],ep_events.keybd[e])}if(f==KBSR_ID){set_value(ep_states[d[2]],1)}return}if(get_value(ep_states[d[4]])==0){var b=get_keyboard_content();if(b.length!=0){var a=b.substr(1,b.length-1);set_keyboard_content(a);set_value(ep_states[d[4]],1);set_value(ep_states[d[3]],b[0].charCodeAt(0))}}if(get_value(ep_states[d[4]])==1){ep_events.keybd[e]=get_value(ep_states[d[3]])}if(f==KBSR_ID){set_value(ep_states[d[2]],get_value(ep_states[d[4]]))}if(f==KBDR_ID){if(get_value(ep_states[d[4]])==1){set_value(ep_states[d[2]],get_value(ep_states[d[3]]))}set_value(ep_states[d[4]],0)}}};ep_components.SCREEN={name:"SCREEN",version:"1",write_state:function(b){if(typeof b.SCREEN=="undefined"){b.SCREEN={}}var e=get_screen_content();var d=e.trim().split("\n");for(var a=0;a<d.length;a++){value=d[a];if(value!=""){b.SCREEN[a]={type:"screen",default_value:"",id:a,op:"==",value:value}}}return b},read_state:function(b,a){if(typeof b.SCREEN=="undefined"){b.SCREEN={}}if("SCREEN"==a.type.toUpperCase().trim()){b.SCREEN[a.id]={type:"screen",default_value:"",id:a.id,op:a.condition,value:a.value};return true}return false},get_state:function(a){var e=get_screen_content();var d=e.trim().split("\n");var b=parseInt(a);if(typeof d[b]!="undefined"){return d[b]}return null}};var DDR_ID=4096;var DSR_ID=4100;ep_internal_states.io_hash[DDR_ID]="DDR";ep_internal_states.io_hash[DSR_ID]="DSR";ep_states.DDR={name:"DDR",visible:false,nbits:"32",value:0,default_value:0,draw_data:[]};ep_states.DSR={name:"DSR",visible:false,nbits:"32",value:0,default_value:0,draw_data:[]};ep_signals.SCR_IOR={name:"IOR",visible:true,type:"L",value:0,default_value:0,nbits:"1",behavior:["NOP","SCR_IOR BUS_AB BUS_DB DDR DSR CLK"],fire_name:["svg_p:tspan4004"],draw_data:[[],["svg_p:path3871","svg_p:path3857"]],draw_name:[[],[]]};ep_signals.SCR_IOW={name:"IOW",visible:true,type:"L",value:0,default_value:0,nbits:"1",behavior:["NOP","SCR_IOW BUS_AB BUS_DB DDR DSR CLK"],fire_name:["svg_p:tspan4006"],draw_data:[[],["svg_p:path3873","svg_p:path3857"]],draw_name:[[],[]]};ep_behaviors.SCR_IOR={nparameters:6,types:["E","E","E","E","E"],operation:function(b){var e=get_value(ep_states[b[1]]);var d=get_value(ep_states[b[3]]);var a=get_value(ep_states[b[4]]);if(e==DDR_ID){set_value(ep_states[b[2]],d)}if(e==DSR_ID){set_value(ep_states[b[2]],a)}}};ep_behaviors.SCR_IOW={nparameters:6,types:["E","E","E","E","E"],operation:function(d){var k=get_value(ep_states[d[1]]);var f=get_value(ep_states[d[2]]);var h=get_value(ep_states[d[5]]);var g=String.fromCharCode(f);if(k!=DDR_ID){return}if(g==String.fromCharCode(7)){timbre.reset();var e=T("sin",{freq:440,mul:0.5});var b=T("sin",{freq:660,mul:0.5});T("perc",{r:500},e,b).on("ended",function(){this.pause()}).bang().play()}else{var a=get_screen_content();if(typeof ep_events.screen[h]!="undefined"){a=a.substr(0,a.length-1)}set_screen_content(a+String.fromCharCode(f))}set_value(ep_states[d[3]],f);set_value(ep_states[d[4]],1);ep_events.screen[h]=f}};var poc_components={};var poc_states={};var poc_events={};var poc_signals={};var poc_behaviors={};var poc_internal_states={};var poc_def={sim_name:"Proof-Of-Concept Processor",sim_short_name:"poc",sim_img_processor:"sim_hw/sim_hw_ep/cpu6.svg",sim_img_controlunit:"sim_hw/sim_hw_ep/controlunit6.svg",sim_img_cpu:"sim_hw/sim_hw_ep/cpu6.svg",components:poc_components,states:poc_states,signals:poc_signals,behaviors:poc_behaviors,events:poc_events,internal_states:poc_internal_states};simhw_add(poc_def);poc_behaviors.PRINT_S={nparameters:2,types:["S"],operation:function(a){console.log(a[1]+": 0x"+poc_signals[a[1]].value.toString(16))}};poc_behaviors.PRINT_E={nparameters:2,types:["E"],operation:function(a){console.log(a[1]+": 0x"+poc_states[a[1]].value.toString(16))}};poc_components.CPU={name:"CPU",version:"1",write_state:function(d){if(typeof d.CPU=="undefined"){d.CPU={}}var a=["PC","SR"];var e=0;for(var b=0;b<poc_states.BR.length;b++){e=parseInt(poc_states.BR[b].value);if(e!=0){d.CPU["R"+b]={type:"register",default_value:0,id:"R"+b,op:"=",value:"0x"+e.toString(16)}}}for(var b=0;b<a.length;b++){e=parseInt(poc_states["REG_"+a[b]].value);if(e!=0){d.CPU[a[b]]={type:"register",default_value:0,id:a[b],op:"=",value:"0x"+e.toString(16)}}}return d},read_state:function(d,a){if(typeof d.CPU=="undefined"){d.CPU={}}var b=a.id.toUpperCase().trim();var e=parseInt(a.value).toString(16);if("REGISTER"==a.type.toUpperCase().trim()){d.CPU[b]={type:"register",default_value:0,id:b,op:a.condition,value:"0x"+e};return true}return false},get_state:function(b){var d=b.toUpperCase().trim();if(typeof poc_states["REG_"+d]!="undefined"){return"0x"+get_value(poc_states["REG_"+d]).toString(16)}d=d.replace("R","");var a=parseInt(d);if(typeof poc_states.BR[a]!="undefined"){return"0x"+get_value(poc_states.BR[a]).toString(16)}return null}};poc_internal_states.MC={};poc_internal_states.MC_dashboard={};poc_internal_states.ROM={};poc_internal_states.FIRMWARE={};poc_internal_states.io_hash={};poc_internal_states.fire_stack=[];poc_internal_states.tri_state_names=["T1","T2","T3","T4","T5","T6","T7","T8","T9","T10","T11"];poc_internal_states.fire_visible={databus:false,internalbus:false};poc_states.BR=[];poc_states.BR[0]={name:"R0",visible:true,nbits:"32",value:0,default_value:0,draw_data:[]};poc_states.BR[1]={name:"R1",visible:true,nbits:"32",value:0,default_value:0,draw_data:[]};poc_states.BR[2]={name:"R2",visible:true,nbits:"32",value:0,default_value:0,draw_data:[]};poc_states.BR[3]={name:"R3",visible:true,nbits:"32",value:0,default_value:0,draw_data:[]};poc_states.BR[4]={name:"R4",visible:true,nbits:"32",value:0,default_value:0,draw_data:[]};poc_states.BR[5]={name:"R5",visible:true,nbits:"32",value:0,default_value:0,draw_data:[]};poc_states.BR[6]={name:"R6",visible:true,nbits:"32",value:0,default_value:0,draw_data:[]};poc_states.BR[7]={name:"R7",visible:true,nbits:"32",value:0,default_value:0,draw_data:[]};poc_states.BR[8]={name:"R8",visible:true,nbits:"32",value:0,default_value:0,draw_data:[]};poc_states.BR[9]={name:"R9",visible:true,nbits:"32",value:0,default_value:0,draw_data:[]};poc_states.BR[10]={name:"R10",visible:true,nbits:"32",value:0,default_value:0,draw_data:[]};poc_states.BR[11]={name:"R11",visible:true,nbits:"32",value:0,default_value:0,draw_data:[]};poc_states.BR[12]={name:"R12",visible:true,nbits:"32",value:0,default_value:0,draw_data:[]};poc_states.BR[13]={name:"R13",visible:true,nbits:"32",value:0,default_value:0,draw_data:[]};poc_states.BR[14]={name:"R14",visible:true,nbits:"32",value:0,default_value:0,draw_data:[]};poc_states.BR[15]={name:"R15",visible:true,nbits:"32",value:0,default_value:0,draw_data:[]};poc_states.BR[16]={name:"R16",visible:true,nbits:"32",value:0,default_value:0,draw_data:[]};poc_states.BR[17]={name:"R17",visible:true,nbits:"32",value:0,default_value:0,draw_data:[]};poc_states.BR[18]={name:"R18",visible:true,nbits:"32",value:0,default_value:0,draw_data:[]};poc_states.BR[19]={name:"R19",visible:true,nbits:"32",value:0,default_value:0,draw_data:[]};poc_states.BR[20]={name:"R20",visible:true,nbits:"32",value:0,default_value:0,draw_data:[]};poc_states.BR[21]={name:"R21",visible:true,nbits:"32",value:0,default_value:0,draw_data:[]};poc_states.BR[22]={name:"R22",visible:true,nbits:"32",value:0,default_value:0,draw_data:[]};poc_states.BR[23]={name:"R23",visible:true,nbits:"32",value:0,default_value:0,draw_data:[]};poc_states.BR[24]={name:"R24",visible:true,nbits:"32",value:0,default_value:0,draw_data:[]};poc_states.BR[25]={name:"R25",visible:true,nbits:"32",value:0,default_value:0,draw_data:[]};poc_states.BR[26]={name:"R26",visible:true,nbits:"32",value:0,default_value:0,draw_data:[]};poc_states.BR[27]={name:"R27",visible:true,nbits:"32",value:0,default_value:0,draw_data:[]};poc_states.BR[28]={name:"R28",visible:true,nbits:"32",value:0,default_value:0,draw_data:[]};poc_states.BR[29]={name:"R29",visible:true,nbits:"32",value:0,default_value:0,draw_data:[]};poc_states.BR[30]={name:"R30",visible:true,nbits:"32",value:0,default_value:0,draw_data:[]};poc_states.BR[31]={name:"R31",visible:true,nbits:"32",value:0,default_value:0,draw_data:[]};poc_states.REG_PC={name:"PC",visible:true,nbits:"32",value:0,default_value:0,draw_data:[]};poc_states.REG_MAR={name:"MAR",visible:true,nbits:"32",value:0,default_value:0,draw_data:[]};poc_states.REG_MBR={name:"MBR",visible:true,nbits:"32",value:0,default_value:0,draw_data:[]};poc_states.REG_IR={name:"IR",visible:true,nbits:"32",value:0,default_value:0,draw_data:[]};poc_states.REG_RT1={name:"RT1",visible:true,nbits:"32",value:0,default_value:0,draw_data:[]};poc_states.REG_RT2={name:"RT2",visible:true,nbits:"32",value:0,default_value:0,draw_data:[]};poc_states.REG_RT3={name:"RT3",visible:true,nbits:"32",value:0,default_value:0,draw_data:[]};poc_states.REG_SR={name:"SR",visible:true,nbits:"32",value:0,default_value:0,draw_data:[]};poc_states.BUS_IB={name:"I_BUS",visible:false,nbits:"32",value:0,default_value:0,draw_data:[]};poc_states.BUS_AB={name:"A_BUS",visible:false,nbits:"32",value:0,default_value:0,draw_data:[]};poc_states.BUS_CB={name:"C_BUS",visible:false,nbits:"32",value:0,default_value:0,draw_data:[]};poc_states.BUS_DB={name:"D_BUS",visible:false,nbits:"32",value:0,default_value:0,draw_data:[]};poc_states.C2_T2={name:"C2_T2",visible:false,nbits:"32",value:0,default_value:0,draw_data:[]};poc_states.RA_T9={name:"RA_T9",visible:false,nbits:"32",value:0,default_value:0,draw_data:[]};poc_states.RB_T10={name:"RB_T10",visible:false,nbits:"32",value:0,default_value:0,draw_data:[]};poc_states.SELEC_T3={name:"SELEC_T3",visible:false,nbits:"32",value:0,default_value:0,draw_data:[]};poc_states.SELP_M7={name:"SELP_M7",visible:false,nbits:"32",value:0,default_value:0,draw_data:[]};poc_states.SUM4_M2={name:"SUM4_M2",visible:false,nbits:"32",value:0,default_value:0,draw_data:[]};poc_states.ALU_C6={name:"ALU_C6",visible:false,nbits:"32",value:0,default_value:0,draw_data:[]};poc_states.MA_ALU={name:"MA_ALU",visible:false,nbits:"32",value:0,default_value:0,draw_data:[]};poc_states.MB_ALU={name:"MB_ALU",visible:false,nbits:"32",value:0,default_value:0,draw_data:[]};poc_states.FLAG_C={name:"FLAG_C",visible:true,nbits:"1",value:0,default_value:0,draw_data:[]};poc_states.FLAG_V={name:"FLAG_V",visible:true,nbits:"1",value:0,default_value:0,draw_data:[]};poc_states.FLAG_N={name:"FLAG_N",visible:true,nbits:"1",value:0,default_value:0,draw_data:[]};poc_states.FLAG_Z={name:"FLAG_Z",visible:true,nbits:"1",value:0,default_value:0,draw_data:[]};poc_states.FLAG_I={name:"FLAG_I",visible:true,nbits:"1",value:0,default_value:0,draw_data:[]};poc_states.FLAG_U={name:"FLAG_U",visible:true,nbits:"1",value:0,default_value:0,draw_data:[]};poc_states.REG_MICROADDR={name:"µADDR",visible:true,nbits:"12",value:0,default_value:0,draw_data:["svg_cu:text4667"]};poc_states.REG_MICROINS={name:"µINS",visible:true,nbits:"77",value:{},default_value:{},draw_data:[]};poc_states.FETCH={name:"FETCH",visible:false,nbits:"12",value:0,default_value:0,draw_data:[]};poc_states.ROM_MUXA={name:"ROM_MUXA",visible:false,nbits:"12",value:0,default_value:0,draw_data:[]};poc_states.SUM_ONE={name:"SUM_ONE",visible:false,nbits:"12",value:1,default_value:1,draw_data:[]};poc_states.MUXA_MICROADDR={name:"MUXA_MICROADDR",visible:false,nbits:"12",value:0,default_value:0,draw_data:[]};poc_states.MUXC_MUXB={name:"MUXC_MUXB",visible:false,nbits:"1",value:0,default_value:0,draw_data:[]};poc_states.INEX={name:"INEX",visible:false,nbits:"1",value:0,default_value:0,draw_data:[]};poc_states.BS_M1={name:"BS_M1",visible:false,nbits:"32",value:0,default_value:0,draw_data:[]};poc_states.BS_TD={name:"BS_TD",visible:false,nbits:"32",value:0,default_value:0,draw_data:[]};poc_states.INTV={name:"INTV",visible:false,nbits:"8",value:0,default_value:0,draw_data:[]};poc_states.M2_C2={name:"M2_C2",visible:false,nbits:"32",value:0,default_value:0,draw_data:[]};poc_states.M1_C1={name:"M1_C1",visible:false,nbits:"32",value:0,default_value:0,draw_data:[]};poc_states.M7_C7={name:"M7_C7",visible:false,nbits:"32",value:0,default_value:0,draw_data:[]};poc_states.VAL_ZERO={name:"VAL_ZERO",visible:false,nbits:"1",value:0,default_value:0,draw_data:[]};poc_states.VAL_ONE={name:"VAL_ONE",visible:false,nbits:"32",value:1,default_value:1,draw_data:[]};poc_states.VAL_FOUR={name:"VAL_FOUR",visible:false,nbits:"32",value:4,default_value:4,draw_data:[]};poc_states.REG_IR_DECO={name:"IR_DECO",visible:true,nbits:"0",value:0,default_value:0,draw_data:[]};poc_states.DECO_INS={name:"DECO_INS",visible:true,nbits:"32",value:0,default_value:0,draw_data:[]};poc_states.CLK={name:"CLK",visible:false,nbits:"32",value:0,default_value:0,draw_data:[]};poc_signals.C={name:"C",visible:true,type:"L",value:0,default_value:0,nbits:"4",behavior:["MV MUXC_MUXB VAL_ZERO; FIRE_IFCHANGED B MUXC_MUXB; RESET_CHANGED MUXC_MUXB","MBIT MUXC_MUXB INT 0 1; FIRE_IFCHANGED B MUXC_MUXB; RESET_CHANGED MUXC_MUXB","MBIT MUXC_MUXB IORDY 0 1; FIRE_IFCHANGED B MUXC_MUXB; RESET_CHANGED MUXC_MUXB","MBIT MUXC_MUXB MRDY 0 1; FIRE_IFCHANGED B MUXC_MUXB; RESET_CHANGED MUXC_MUXB","MBIT MUXC_MUXB REG_SR 0 1; FIRE_IFCHANGED B MUXC_MUXB; RESET_CHANGED MUXC_MUXB","MBIT MUXC_MUXB REG_SR 1 1; FIRE_IFCHANGED B MUXC_MUXB; RESET_CHANGED MUXC_MUXB","MBIT MUXC_MUXB REG_SR 28 1; FIRE_IFCHANGED B MUXC_MUXB; RESET_CHANGED MUXC_MUXB","MBIT MUXC_MUXB REG_SR 29 1; FIRE_IFCHANGED B MUXC_MUXB; RESET_CHANGED MUXC_MUXB","MBIT MUXC_MUXB REG_SR 30 1; FIRE_IFCHANGED B MUXC_MUXB; RESET_CHANGED MUXC_MUXB","MBIT MUXC_MUXB REG_SR 31 1; FIRE_IFCHANGED B MUXC_MUXB; RESET_CHANGED MUXC_MUXB","MV MUXC_MUXB INEX; FIRE_IFCHANGED B MUXC_MUXB; RESET_CHANGED MUXC_MUXB"],fire_name:["svg_cu:text3410"],draw_data:[["svg_cu:path3108"],["svg_cu:path3062"],["svg_cu:path3060"],["svg_cu:path3136"],["svg_cu:path3482"],["svg_cu:path3480"],["svg_cu:path3488"],["svg_cu:path3486"],["svg_cu:path3484"],["svg_cu:path3484-9"],["svg_cu:path3108-3","svg_cu:path3260-3-8-6","svg_cu:path3260-3-8","svg_cu:path3260-3"]],draw_name:[["svg_cu:path3496","svg_cu:path3414","svg_cu:path3194-08"]]};poc_signals.B={name:"B",visible:true,type:"L",value:0,default_value:0,nbits:"1",behavior:["MV A1 MUXC_MUXB; FIRE A1","NOT_ES A1 MUXC_MUXB; FIRE A1"],depends_on:["CLK"],fire_name:["svg_cu:text3408"],draw_data:[["svg_cu:path3094-7"],["svg_cu:path3392","svg_cu:path3372","svg_cu:path3390","svg_cu:path3384","svg_cu:path3108-1","svg_cu:path3100-8-7"]],draw_name:[[],["svg_cu:path3194-0","svg_cu:path3138-8","svg_cu:path3498-6"]]};poc_signals.A0={name:"A0",visible:false,type:"L",value:0,default_value:0,nbits:"1",behavior:["SBIT A0A1 A0 1; FIRE A0A1","SBIT A0A1 A0 1; FIRE A0A1"],depends_on:["CLK"],fire_name:["svg_cu:text3406"],draw_data:[["svg_cu:path3096"],["svg_cu:path3096"]],draw_name:[[],["svg_cu:path3138-8-1","svg_cu:path3098-2","svg_cu:path3124-2-5"]]};poc_signals.A1={name:"A1",visible:false,type:"L",value:0,default_value:0,nbits:"1",behavior:["SBIT A0A1 A1 0; FIRE A0A1","SBIT A0A1 A1 0; FIRE A0A1"],depends_on:["CLK"],fire_name:[],draw_data:[["svg_cu:path3094"],["svg_cu:path3094"]],draw_name:[[]]};poc_signals.A0A1={name:"A0A1",visible:true,type:"L",value:0,default_value:0,nbits:"2",behavior:["ADD MUXA_MICROADDR REG_MICROADDR SUM_ONE","MV MUXA_MICROADDR REG_MICROINS/MADDR","MV MUXA_MICROADDR ROM_MUXA","MV MUXA_MICROADDR FETCH"],depends_on:["CLK"],fire_name:[],draw_data:[["svg_cu:path3102","svg_cu:path3100","svg_cu:path3098","svg_cu:path3100-9","svg_cu:path3088"],["svg_cu:path3104","svg_cu:path3134","svg_cu:path3500","svg_cu:path3416"],["svg_cu:path3504","svg_cu:path3100-8","svg_cu:path3234-9"],["svg_cu:path3124"]],draw_name:[[]]};poc_signals.C0={name:"C0",visible:true,type:"E",value:0,default_value:0,nbits:"1",behavior:["NOP","MV REG_MAR BUS_IB"],fire_name:["svg_p:text3077"],draw_data:[["svg_p:path3081"]],draw_name:[["svg_p:path3075"]]};poc_signals.C1={name:"C1",visible:true,type:"E",value:0,default_value:0,nbits:"1",behavior:["NOP","MV REG_MBR M1_C1"],fire_name:["svg_p:text3079"],draw_data:[["svg_p:path3055"]],draw_name:[["svg_p:path3073"]]};poc_signals.C2={name:"C2",visible:true,type:"E",value:0,default_value:0,nbits:"1",behavior:["NOP","MV REG_PC M2_C2; UPDATEDPC"],fire_name:["svg_p:text3179"],draw_data:[["svg_p:path3485"]],draw_name:[["svg_p:path3177"]]};poc_signals.C3={name:"C3",visible:true,type:"E",value:0,default_value:0,nbits:"1",behavior:["NOP","MV REG_IR BUS_IB; DECO; FIRE_IFSET C 10"],fire_name:["svg_p:text3439"],draw_data:[["svg_p:path3339"]],draw_name:[["svg_p:path3337"]]};poc_signals.C4={name:"C4",visible:true,type:"E",value:0,default_value:0,nbits:"1",behavior:["NOP","MV REG_RT1 BUS_IB"],fire_name:["svg_p:text3441"],draw_data:[["svg_p:path3263"]],draw_name:[["svg_p:path3255"]]};poc_signals.C5={name:"C5",visible:true,type:"E",value:0,default_value:0,nbits:"1",behavior:["NOP","MV REG_RT2 BUS_IB"],fire_name:["svg_p:text3443"],draw_data:[["svg_p:path3277"]],draw_name:[["svg_p:path3269"]]};poc_signals.C6={name:"C6",visible:true,type:"E",value:0,default_value:0,nbits:"1",behavior:["NOP","MV REG_RT3 ALU_C6"],fire_name:["svg_p:text3445"],draw_data:[["svg_p:path3325","svg_p:path3323"]],draw_name:[["svg_p:path3245"]]};poc_signals.C7={name:"C7",visible:true,type:"E",value:0,default_value:0,nbits:"1",behavior:["NOP","MV REG_SR M7_C7; FIRE C"],fire_name:["svg_p:text3655"],draw_data:[["svg_p:path3651-9"]],draw_name:[["svg_p:path3681"]]};poc_signals.TA={name:"TA",visible:true,type:"L",value:0,default_value:0,nbits:"1",behavior:["NOP","MV BUS_AB REG_MAR; MOVE_BITSE A1A0 0 2 BUS_AB 0; FIRE_IFCHANGED A1A0 A1A0"],fire_name:["svg_p:text3091"],draw_data:[["svg_p:path3089","svg_p:path3597","svg_p:path3513","svg_p:path3601","svg_p:path3601-2","svg_p:path3187","svg_p:path3087","svg_p:path2995","svg_p:path3535"]],draw_name:[["svg_p:path3085"]]};poc_signals.TD={name:"TD",visible:true,type:"L",value:0,default_value:0,nbits:"1",behavior:["NOP","MV BUS_DB BS_TD; MOVE_BITSE A1A0 0 2 BUS_AB 0; FIRE_IFCHANGED A1A0 A1A0"],fire_name:["svg_p:text3103"],draw_data:[["svg_p:path3101","svg_p:path3587","svg_p:path3515","svg_p:path3071","svg_p:path3419","svg_p:path3099","svg_p:path3097","svg_p:path3559-5","svg_p:path3419-1-0","svg_p:path3583","svg_p:path3419-1","svg_p:path3493","svg_p:path3641","svg_p:path3541"]],draw_name:[["svg_p:path3095"]]};poc_signals.T1={name:"T1",visible:true,type:"L",value:0,default_value:0,nbits:"1",behavior:["NOP","MV BUS_IB REG_MBR; FIRE M7; FIRE M2; FIRE M1"],fire_name:["svg_p:text3105"],draw_data:[["svg_p:path3071","svg_p:path3069","svg_p:path3049","svg_p:path3063-9","svg_p:path3071"]],draw_name:[["svg_p:path3067"]]};poc_signals.T2={name:"T2",visible:true,type:"L",value:0,default_value:0,nbits:"1",behavior:["NOP","MV BUS_IB REG_PC; FIRE M7; FIRE M2; FIRE M1"],fire_name:["svg_p:text3449"],draw_data:[["svg_p:path3199","svg_p:path3201","svg_p:path3049"]],draw_name:[["svg_p:path3329"]]};poc_signals.T3={name:"T3",visible:true,type:"L",value:0,default_value:0,nbits:"1",behavior:["NOP","MV BUS_IB SELEC_T3; FIRE M7; FIRE M2; FIRE M1"],fire_name:["svg_p:text3451"],draw_data:[["svg_p:path3349","svg_p:path3931","svg_p:path3345","svg_p:path3049"]],draw_name:[["svg_p:path3351"]]};poc_signals.T4={name:"T4",visible:true,type:"L",value:0,default_value:0,nbits:"1",behavior:["NOP","MV BUS_IB REG_RT1; FIRE M7; FIRE M2; FIRE M1"],fire_name:["svg_p:text3453"],draw_data:[["svg_p:path3261","svg_p:path3259","svg_p:path3049"]],draw_name:[["svg_p:path3305"]]};poc_signals.T5={name:"T5",visible:true,type:"L",value:0,default_value:0,nbits:"1",behavior:["NOP","MV BUS_IB REG_RT2; FIRE M7; FIRE M2; FIRE M1"],fire_name:["svg_p:text3455"],draw_data:[["svg_p:path3275","svg_p:path3273","svg_p:path3049"]],draw_name:[["svg_p:path3307"]]};poc_signals.T6={name:"T6",visible:true,type:"L",value:0,default_value:0,nbits:"1",behavior:["NOP","MV BUS_IB ALU_C6; FIRE M7; FIRE M2; FIRE M1"],fire_name:["svg_p:text3457"],draw_data:[["svg_p:path3589","svg_p:path3317","svg_p:path3163-2","svg_p:path3049"]],draw_name:[["svg_p:path3319"]]};poc_signals.T7={name:"T7",visible:true,type:"L",value:0,default_value:0,nbits:"1",behavior:["NOP","MV BUS_IB REG_RT3; FIRE M7; FIRE M2; FIRE M1"],fire_name:["svg_p:text3459"],draw_data:[["svg_p:path3327","svg_p:path3311","svg_p:path3049"]],draw_name:[["svg_p:path3313"]]};poc_signals.T8={name:"T8",visible:true,type:"L",value:0,default_value:0,nbits:"1",behavior:["NOP","MV BUS_IB REG_SR; FIRE M7; FIRE M2; FIRE M1"],fire_name:["svg_p:text3657"],draw_data:[["svg_p:path3651","svg_p:path3647","svg_p:path3049"]],draw_name:[["svg_p:path3649"]]};poc_signals.T9={name:"T9",visible:true,type:"L",value:0,default_value:0,nbits:"1",behavior:["NOP","MV BUS_IB RA_T9; FIRE M7; FIRE M2; FIRE M1"],fire_name:["svg_p:text3147"],draw_data:[["svg_p:path3143","svg_p:path3139","svg_p:path3049","svg_p:path3143-9"]],draw_name:[["svg_p:path3133"]]};poc_signals.T10={name:"T10",visible:true,type:"L",value:0,default_value:0,nbits:"1",behavior:["NOP","MV BUS_IB RB_T10; FIRE M7; FIRE M2; FIRE M1"],fire_name:["svg_p:text3149"],draw_data:[["svg_p:path3145","svg_p:path3141","svg_p:path3049","svg_p:path3145-5"]],draw_name:[["svg_p:path3137"]]};poc_signals.T11={name:"T11",visible:true,type:"L",value:0,default_value:0,nbits:"1",behavior:["NOP","MV BUS_IB REG_MICROINS/EXCODE; FIRE M7; FIRE M2; FIRE M1"],fire_name:["svg_p:text3147-5","svg_cu:tspan4426"],draw_data:[["svg_p:path3145","svg_p:path3081-3","svg_p:path3139-7","svg_p:path3049","svg_cu:path3081-3","svg_cu:path3139-7","svg_cu:path3502"]],draw_name:[["svg_p:path3133-6","svg_cu:path3133-6"]]};poc_signals.M1={name:"M1",visible:true,type:"L",value:0,default_value:0,nbits:"1",behavior:["MV M1_C1 BUS_IB","MV M1_C1 BS_M1"],depends_on:["C1"],fire_name:["svg_p:text3469"],draw_data:[["svg_p:path3063","svg_p:path3061","svg_p:path3059"],["svg_p:path3057","svg_p:path3641","svg_p:path3419","svg_p:path3583"]],draw_name:[[],["svg_p:path3447"]]};poc_signals.M2={name:"M2",visible:true,type:"L",value:0,default_value:0,nbits:"1",behavior:["MV M2_C2 BUS_IB","ADD M2_C2 REG_PC VAL_FOUR"],depends_on:["C2"],fire_name:["svg_p:text3471"],draw_data:[["svg_p:path3217","svg_p:path3215","svg_p:path3213","svg_p:path3213-9"],["svg_p:path3211","svg_p:path3209","svg_p:path3193","svg_p:path3207","svg_p:path3197","svg_p:path3201"]],draw_name:[[],["svg_p:path3467","svg_p:path3467"]]};poc_signals.M7={name:"M7",visible:true,type:"L",value:0,default_value:0,nbits:"1",behavior:["MV M7_C7 BUS_IB","MV M7_C7 SELP_M7"],depends_on:["C7"],fire_name:["svg_p:text3673"],draw_data:[["svg_p:path3691","svg_p:path3693","svg_p:path3659"],["svg_p:path3695"]],draw_name:[[],["svg_p:path3667"]]};poc_signals.MA={name:"MA",visible:true,type:"L",value:0,default_value:0,nbits:"1",behavior:["MV MA_ALU RA_T9; FIRE COP","MV MA_ALU REG_RT1; FIRE COP"],depends_on:["SELA","SELB","SELC"],fire_name:["svg_p:text3463"],draw_data:[["svg_p:path3249","svg_p:path3161","svg_p:path3165"],["svg_p:path3279"]],draw_name:[[],["svg_p:path3423"]]};poc_signals.MB={name:"MB",visible:true,type:"L",value:0,default_value:0,nbits:"2",behavior:["MV MB_ALU RB_T10; FIRE COP","MV MB_ALU REG_RT2; FIRE COP","MV MB_ALU VAL_FOUR; FIRE COP","MV MB_ALU VAL_ONE; FIRE COP"],depends_on:["SELA","SELB","SELC"],fire_name:["svg_p:text3465"],draw_data:[["svg_p:path3281","svg_p:path3171","svg_p:path3169"],["svg_p:path3283"],["svg_p:path3295","svg_p:path3293"],["svg_p:path3297","svg_p:path3299"]],draw_name:[[],["svg_p:path3425","svg_p:path3427"]]};poc_signals.COP={name:"COP",visible:true,type:"L",value:0,default_value:0,nbits:"4",forbidden:true,behavior:["NOP_ALU","AND ALU_C6 MA_ALU MB_ALU; FIRE_IFSET T6 1; FIRE_IFSET SELP 3","OR ALU_C6 MA_ALU MB_ALU; FIRE_IFSET T6 1; FIRE_IFSET SELP 3","NOT ALU_C6 MA_ALU; FIRE_IFSET T6 1; FIRE_IFSET SELP 3","XOR ALU_C6 MA_ALU MB_ALU; FIRE_IFSET T6 1; FIRE_IFSET SELP 3","SRL ALU_C6 MA_ALU; FIRE_IFSET T6 1; FIRE_IFSET SELP 3","SRA ALU_C6 MA_ALU; FIRE_IFSET T6 1; FIRE_IFSET SELP 3","SL ALU_C6 MA_ALU; FIRE_IFSET T6 1; FIRE_IFSET SELP 3","RR ALU_C6 MA_ALU; FIRE_IFSET T6 1; FIRE_IFSET SELP 3","RL ALU_C6 MA_ALU; FIRE_IFSET T6 1; FIRE_IFSET SELP 3","ADD ALU_C6 MA_ALU MB_ALU; FIRE_IFSET T6 1; FIRE_IFSET SELP 3","SUB ALU_C6 MA_ALU MB_ALU; FIRE_IFSET T6 1; FIRE_IFSET SELP 3","MUL ALU_C6 MA_ALU MB_ALU; FIRE_IFSET T6 1; FIRE_IFSET SELP 3","DIV ALU_C6 MA_ALU MB_ALU; FIRE_IFSET T6 1; FIRE_IFSET SELP 3","MOD ALU_C6 MA_ALU MB_ALU; FIRE_IFSET T6 1; FIRE_IFSET SELP 3","LUI ALU_C6 MA_ALU; FIRE_IFSET T6 1; FIRE_IFSET SELP 3"],depends_on:["SELCOP"],fire_name:["svg_p:text3303"],draw_data:[["svg_p:path3237","svg_p:path3239","svg_p:path3261-8","svg_p:path3321","svg_p:path3901-6","svg_p:path3317-9"]],draw_name:[["svg_p:path3009","svg_p:path3301"]]};poc_signals.SELP={name:"SELP",visible:true,type:"L",value:0,default_value:0,nbits:"2",behavior:["NOP","MV SELP_M7 REG_SR; SBIT SELP_M7 FLAG_U 0; FIRE M7","MV SELP_M7 REG_SR; SBIT SELP_M7 FLAG_I 1; FIRE M7","MV SELP_M7 REG_SR; SBIT SELP_M7 FLAG_C 31; SBIT SELP_M7 FLAG_V 30; SBIT SELP_M7 FLAG_N 29; SBIT SELP_M7 FLAG_Z 28; FIRE M7"],fire_name:["svg_p:text3703"],draw_data:[[],["svg_p:path3643"],["svg_p:path3705"],["svg_p:path3675","svg_p:path3331"]],draw_name:[[],["svg_p:path3697"]]};poc_signals.SELA={name:"SELA",visible:true,type:"L",value:0,default_value:0,nbits:"5",behavior:["FIRE_IFCHANGED MR_RA SELA; RESET_CHANGED SELA"],depends_on:["RA"],fire_name:["svg_cu:text3164"],draw_data:[[]],draw_name:[[]]};poc_signals.SELB={name:"SELB",visible:true,type:"L",value:0,default_value:0,nbits:"5",behavior:["FIRE_IFCHANGED MR_RB SELB; RESET_CHANGED SELB"],depends_on:["RB"],fire_name:["svg_cu:text3168"],draw_data:[[]],draw_name:[[]]};poc_signals.SELC={name:"SELC",visible:true,type:"L",value:0,default_value:0,nbits:"5",behavior:["FIRE_IFCHANGED MR_RC SELC; RESET_CHANGED SELC"],depends_on:["RC"],fire_name:["svg_cu:text3172"],draw_data:[[]],draw_name:[[]]};poc_signals.SELCOP={name:"SELCOP",visible:true,type:"L",value:0,default_value:0,nbits:"4",behavior:["FIRE_IFCHANGED MC SELCOP; RESET_CHANGED SELCOP"],depends_on:["COP"],fire_name:["svg_cu:text3312"],draw_data:[[]],draw_name:[[]]};poc_signals.EXCODE={name:"EXCODE",visible:true,type:"L",value:0,default_value:0,nbits:"4",behavior:["FIRE T11"],fire_name:["svg_cu:text3312-6"],draw_data:[[]],draw_name:[[]]};poc_signals.RA={name:"RA",visible:true,type:"L",value:0,default_value:0,nbits:"5",forbidden:true,behavior:["GET RA_T9 BR RA; FIRE_IFSET T9 1; FIRE_IFSET MA 0"],depends_on:["SELA"],fire_name:["svg_p:text3107"],draw_data:[[]],draw_name:[["svg_p:path3109"]]};poc_signals.RB={name:"RB",visible:true,type:"L",value:0,default_value:0,nbits:"5",forbidden:true,behavior:["GET RB_T10 BR RB; FIRE_IFSET T10 1; FIRE_IFSET MB 0"],depends_on:["SELB"],fire_name:["svg_p:text3123"],draw_data:[[]],draw_name:[["svg_p:path3113"]]};poc_signals.RC={name:"RC",visible:true,type:"L",value:0,default_value:0,nbits:"5",forbidden:true,behavior:["FIRE LC"],depends_on:["SELC"],fire_name:["svg_p:text3125"],draw_data:[[]],draw_name:[["svg_p:path3117"]]};poc_signals.LC={name:"LC",visible:true,type:"E",value:0,default_value:0,nbits:"1",behavior:["NOP","SET BR RC BUS_IB"],fire_name:["svg_p:text3127"],draw_data:[["svg_p:path3153","svg_p:path3151","svg_p:path3129"]],draw_name:[["svg_p:path3121"]]};poc_signals.SE={name:"SE",visible:true,type:"L",value:0,default_value:0,nbits:"1",behavior:["MBITS SELEC_T3 0 REG_IR OFFSET SIZE 0 SE; FIRE T3; MOVE_BITS SBWA 4 1 SE; FIRE_IFCHANGED SBWA SE","MBITS SELEC_T3 0 REG_IR OFFSET SIZE 0 SE; FIRE T3; MOVE_BITS SBWA 4 1 SE; FIRE_IFCHANGED SBWA SE"],depends_on:["T3"],fire_name:["svg_p:text3593","svg_p:text3431"],draw_data:[[]],draw_name:[["svg_p:path3591","svg_p:path3447-7-7"]]};poc_signals.SIZE={name:"SIZE",visible:true,type:"L",value:0,default_value:0,nbits:"5",behavior:["MBITS SELEC_T3 0 REG_IR OFFSET SIZE 0 SE; FIRE T3"],depends_on:["T3"],fire_name:["svg_p:text3363"],draw_data:[[]],draw_name:[["svg_p:path3355"]]};poc_signals.OFFSET={name:"OFFSET",visible:true,type:"L",value:0,default_value:0,nbits:"5",behavior:["MBITS SELEC_T3 0 REG_IR OFFSET SIZE 0 SE; FIRE T3"],depends_on:["T3"],fire_name:["svg_p:text3707"],draw_data:[[]],draw_name:[["svg_p:path3359"]]};poc_signals.MC={name:"MC",visible:true,type:"L",value:0,default_value:0,nbits:"1",behavior:["MBIT COP REG_IR 0 4; FIRE_IFCHANGED COP MC","MV COP REG_MICROINS/SELCOP; FIRE_IFCHANGED COP MC"],depends_on:["SELCOP"],fire_name:["svg_cu:text3322","svg_cu:text3172-1-5"],draw_data:[["svg_cu:path3320","svg_cu:path3142"],["svg_cu:path3318","svg_cu:path3502-6","svg_cu:path3232-6"]],draw_name:[[],["svg_cu:path3306"]]};poc_signals.MR={name:"MR",visible:true,type:"L",value:0,default_value:0,nbits:"1",behavior:["MV MR_RA MR; FIRE_IFCHANGED MR_RA MR; MV MR_RB MR; FIRE_IFCHANGED MR_RB MR; MV MR_RC MR; FIRE_IFCHANGED MR_RC MR; RESET_CHANGED MR","MV MR_RA MR; FIRE_IFCHANGED MR_RA MR; MV MR_RB MR; FIRE_IFCHANGED MR_RB MR; MV MR_RC MR; FIRE_IFCHANGED MR_RC MR; RESET_CHANGED MR"],depends_on:["SELA","SELB","SELC"],fire_name:["svg_cu:text3222","svg_cu:text3242","svg_cu:text3254","svg_cu:text3172-1"],draw_data:[["svg_cu:path3494","svg_cu:path3492","svg_cu:path3490","svg_cu:path3142b","svg_cu:path3188","svg_cu:path3190","svg_cu:path3192","svg_cu:path3194","svg_cu:path3276","svg_cu:path3290","svg_cu:path3260","svg_cu:path3196","svg_cu:path3502","svg_cu:path3278","svg_cu:path3232","svg_cu:path3292"],["svg_cu:path3270","svg_cu:path3282","svg_cu:path3300","svg_cu:path3258","svg_cu:path3260","svg_cu:path3278","svg_cu:path3196","svg_cu:path3502","svg_cu:path3294","svg_cu:path3292","svg_cu:path3288","svg_cu:path3232","svg_cu:path3280"]],draw_name:[[],["svg_cu:path3220","svg_cu:path3240","svg_cu:path3252"]]};poc_signals.MR_RA={name:"MR_RA",visible:true,type:"L",value:0,default_value:0,nbits:"1",behavior:["MBIT_SN RA REG_IR REG_MICROINS/SELA 5; FIRE RA;","MV RA REG_MICROINS/SELA; FIRE RA;"],fire_name:[],draw_data:[[]],draw_name:[[]]};poc_signals.MR_RB={name:"MR_RB",visible:true,type:"L",value:0,default_value:0,nbits:"1",behavior:["MBIT_SN RB REG_IR REG_MICROINS/SELB 5; FIRE RB;","MV RB REG_MICROINS/SELB; FIRE RB;"],fire_name:[],draw_data:[[]],draw_name:[[]]};poc_signals.MR_RC={name:"MR_RC",visible:true,type:"L",value:0,default_value:0,nbits:"1",behavior:["MBIT_SN RC REG_IR REG_MICROINS/SELC 5; FIRE RC;","MV RC REG_MICROINS/SELC; FIRE RC;"],fire_name:[],draw_data:[[]],draw_name:[[]]};poc_signals.BW={name:"BW",visible:true,type:"L",value:0,default_value:0,nbits:"2",behavior:["MOVE_BITS BWA 2 2 BW; MOVE_BITS SBWA 2 2 BW; FIRE_IFCHANGED BWA BW; FIRE SBWA; RESET_CHANGED BW","MOVE_BITS BWA 2 2 BW; MOVE_BITS SBWA 2 2 BW; FIRE_IFCHANGED BWA BW; FIRE SBWA; RESET_CHANGED BW","MOVE_BITS BWA 2 2 BW; MOVE_BITS SBWA 2 2 BW; FIRE_IFCHANGED BWA BW; FIRE SBWA; RESET_CHANGED BW","MOVE_BITS BWA 2 2 BW; MOVE_BITS SBWA 2 2 BW; FIRE_IFCHANGED BWA BW; FIRE SBWA; RESET_CHANGED BW"],fire_name:["svg_p:text3433"],draw_data:[["svg_p:path3061-2-6","svg_p:path3101-8","svg_p:path3535-8"]],draw_name:[[],[]]};poc_signals.A1A0={name:"A1A0",visible:true,type:"L",value:0,default_value:0,nbits:"2",behavior:["MOVE_BITS BWA 0 2 A1A0; MOVE_BITS SBWA 0 2 A1A0; FIRE BWA; FIRE SBWA","MOVE_BITS BWA 0 2 A1A0; MOVE_BITS SBWA 0 2 A1A0; FIRE BWA; FIRE SBWA","MOVE_BITS BWA 0 2 A1A0; MOVE_BITS SBWA 0 2 A1A0; FIRE BWA; FIRE SBWA","MOVE_BITS BWA 0 2 A1A0; MOVE_BITS SBWA 0 2 A1A0; FIRE BWA; FIRE SBWA"],fire_name:["svg_p:text3603"],draw_data:[[],[]],draw_name:[[],[]]};poc_signals.BWA={name:"BWA",visible:false,type:"L",value:0,default_value:0,nbits:"4",behavior:["BSEL BS_TD 0 8 REG_MBR 0; FIRE TD; FIRE R; FIRE W","BSEL BS_TD 8 8 REG_MBR 0; FIRE TD; FIRE R; FIRE W","BSEL BS_TD 16 8 REG_MBR 0; FIRE TD; FIRE R; FIRE W","BSEL BS_TD 24 8 REG_MBR 0; FIRE TD; FIRE R; FIRE W","BSEL BS_TD 0 16 REG_MBR 0; FIRE TD; FIRE R; FIRE W","BSEL BS_TD 0 16 REG_MBR 0; FIRE TD; FIRE R; FIRE W","BSEL BS_TD 0 16 REG_MBR 0; FIRE TD; FIRE R; FIRE W","BSEL BS_TD 0 16 REG_MBR 0; FIRE TD; FIRE R; FIRE W","BSEL BS_TD 16 16 REG_MBR 0; FIRE TD; FIRE R; FIRE W","BSEL BS_TD 16 16 REG_MBR 0; FIRE TD; FIRE R; FIRE W","BSEL BS_TD 16 16 REG_MBR 0; FIRE TD; FIRE R; FIRE W","BSEL BS_TD 16 16 REG_MBR 0; FIRE TD; FIRE R; FIRE W","MV BS_TD REG_MBR; FIRE TD; FIRE R; FIRE W","MV BS_TD REG_MBR; FIRE TD; FIRE R; FIRE W","MV BS_TD REG_MBR; FIRE TD; FIRE R; FIRE W","MV BS_TD REG_MBR; FIRE TD; FIRE R; FIRE W"],fire_name:["svg_p:text3533-5"],draw_data:[[],[]],draw_name:[[],[]]};poc_signals.SBWA={name:"SBWA",visible:false,type:"L",value:0,default_value:0,nbits:"5",behavior:["BSEL BS_M1 0 8 BUS_DB 0; FIRE M1","BSEL BS_M1 0 8 BUS_DB 8; FIRE M1","BSEL BS_M1 0 8 BUS_DB 16; FIRE M1","BSEL BS_M1 0 8 BUS_DB 24; FIRE M1","BSEL BS_M1 0 16 BUS_DB 0; FIRE M1","BSEL BS_M1 0 16 BUS_DB 0; FIRE M1","BSEL BS_M1 0 16 BUS_DB 0; FIRE M1","BSEL BS_M1 0 16 BUS_DB 0; FIRE M1","BSEL BS_M1 0 16 BUS_DB 16; FIRE M1","BSEL BS_M1 0 16 BUS_DB 16; FIRE M1","BSEL BS_M1 0 16 BUS_DB 16; FIRE M1","BSEL BS_M1 0 16 BUS_DB 16; FIRE M1","MV BS_M1 BUS_DB; FIRE M1","MV BS_M1 BUS_DB; FIRE M1","MV BS_M1 BUS_DB; FIRE M1","MV BS_M1 BUS_DB; FIRE M1","BSEL BS_M1 0 8 BUS_DB 0; EXT_SIG BS_M1 7; FIRE M1","BSEL BS_M1 0 8 BUS_DB 8; EXT_SIG BS_M1 7; FIRE M1","BSEL BS_M1 0 8 BUS_DB 16; EXT_SIG BS_M1 7; FIRE M1","BSEL BS_M1 0 8 BUS_DB 24; EXT_SIG BS_M1 7; FIRE M1","BSEL BS_M1 0 16 BUS_DB 0; EXT_SIG BS_M1 15; FIRE M1","BSEL BS_M1 0 16 BUS_DB 0; EXT_SIG BS_M1 15; FIRE M1","BSEL BS_M1 0 16 BUS_DB 0; EXT_SIG BS_M1 15; FIRE M1","BSEL BS_M1 0 16 BUS_DB 0; EXT_SIG BS_M1 15; FIRE M1","BSEL BS_M1 0 16 BUS_DB 16; EXT_SIG BS_M1 15; FIRE M1","BSEL BS_M1 0 16 BUS_DB 16; EXT_SIG BS_M1 15; FIRE M1","BSEL BS_M1 0 16 BUS_DB 16; EXT_SIG BS_M1 15; FIRE M1","BSEL BS_M1 0 16 BUS_DB 16; EXT_SIG BS_M1 15; FIRE M1","MV BS_M1 BUS_DB; FIRE M1","MV BS_M1 BUS_DB; FIRE M1","MV BS_M1 BUS_DB; FIRE M1","MV BS_M1 BUS_DB; FIRE M1"],fire_name:[],draw_data:[[],[]],draw_name:[[],[]]};poc_signals.IOR={name:"IOR",visible:true,type:"L",value:0,default_value:0,nbits:"1",behavior:["NOP","MOVE_BITS KBD_IOR 0 1 IOR; MOVE_BITS SCR_IOR 0 1 IOR; FIRE KBD_IOR; FIRE SCR_IOR"],fire_name:["svg_p:text3715"],draw_data:[[],["svg_p:path3733","svg_p:path3493","svg_p:text3715","svg_p:path3493"]],draw_name:[[],[]]};poc_signals.IOW={name:"IOW",visible:true,type:"L",value:0,default_value:0,nbits:"1",behavior:["NOP","MOVE_BITS SCR_IOW 0 1 IOW; FIRE SCR_IOW; MOVE_BITS IO_IOW 0 1 IOW; FIRE IO_IOW;"],fire_name:["svg_p:text3715"],draw_data:[[],["svg_p:path3735","svg_p:path3493","svg_p:text3717","svg_p:path3493"]],draw_name:[[],[]]};poc_signals.TEST_C={name:"TEST_C",visible:true,type:"L",value:0,default_value:0,nbits:"1",forbidden:true,behavior:["MV FLAG_C VAL_ZERO; FIRE_IFSET SELP 2","MV FLAG_C VAL_ONE; FIRE_IFSET SELP 3"],depends_on:["SELCOP"],fire_name:["svg_p:text3701-3"],draw_data:[["svg_p:text3701-3"]],draw_name:[[]]};poc_signals.TEST_V={name:"TEST_V",visible:true,type:"L",value:0,default_value:0,nbits:"1",forbidden:true,behavior:["MV FLAG_V VAL_ZERO; FIRE_IFSET SELP 2","MV FLAG_V VAL_ONE; FIRE_IFSET SELP 3"],depends_on:["SELCOP"],fire_name:["svg_p:text3701-3-1"],draw_data:[["svg_p:text3701-3-1"]],draw_name:[[]]};poc_signals.TEST_N={name:"TEST_N",visible:true,type:"L",value:0,default_value:0,nbits:"1",forbidden:true,behavior:["MV FLAG_N VAL_ZERO; FIRE_IFSET SELP 2","MV FLAG_N VAL_ONE; FIRE_IFSET SELP 3"],depends_on:["SELCOP"],fire_name:["svg_p:text3701-3-2"],draw_data:[["svg_p:text3701-3-2"]],draw_name:[[]]};poc_signals.TEST_Z={name:"TEST_Z",visible:true,type:"L",value:0,default_value:0,nbits:"1",forbidden:true,behavior:["MV FLAG_Z VAL_ZERO; FIRE_IFSET SELP 2","MV FLAG_Z VAL_ONE; FIRE_IFSET SELP 3"],depends_on:["SELCOP"],fire_name:["svg_p:text3701-3-5"],draw_data:[["svg_p:text3701-3-5"]],draw_name:[[]]};poc_signals.TEST_I={name:"TEST_I",visible:true,type:"L",value:0,default_value:0,nbits:"1",behavior:["MV FLAG_I VAL_ZERO; FIRE_IFSET SELP 2","MV FLAG_I VAL_ONE; FIRE_IFSET SELP 2"],depends_on:["CLK"],fire_name:["svg_p:text3669"],draw_data:[["svg_p:text3669"]],draw_name:[[]]};poc_signals.TEST_U={name:"TEST_U",visible:true,type:"L",value:0,default_value:0,nbits:"1",behavior:["MV FLAG_U VAL_ZERO; FIRE_IFSET SELP 1","MV FLAG_U VAL_ONE; FIRE_IFSET SELP 1"],depends_on:["CLK"],fire_name:["svg_p:text3669-1"],draw_data:[["svg_p:text3669-1"]],draw_name:[[]]};poc_signals.TEST_INTV={name:"TEST_INTV",visible:true,type:"L",value:0,default_value:0,nbits:"8",forbidden:true,behavior:["MBIT INTV TEST_INTV 0 32"],depends_on:["INT"],fire_name:["svg_p:tspan4225"],draw_data:[["svg_p:path3749"]],draw_name:[[]]};poc_behaviors.NOP={nparameters:1,operation:function(a){}};poc_behaviors.NOP_ALU={nparameters:1,operation:function(a){update_nzvc(0,0,0,0)}};poc_behaviors.MV={nparameters:3,types:["X","X"],operation:function(a){r=a[2].split("/");sim_elto_dst=get_reference(a[1]);sim_elto_org=get_reference(r[0]);newval=get_value(sim_elto_org);if(1!=r.length){newval=newval[r[1]]}if(typeof newval!="undefined"){set_value(sim_elto_dst,newval)}}};poc_behaviors.NOT_ES={nparameters:3,types:["S","E"],operation:function(a){set_value(poc_signals[a[1]],Math.abs(get_value(poc_states[a[2]])-1))}};poc_behaviors.GET={nparameters:4,types:["E","E","S"],operation:function(a){set_value(poc_states[a[1]],get_value(poc_states[a[2]][poc_signals[a[3]].value]))}};poc_behaviors.SET={nparameters:4,types:["E","S","E"],operation:function(a){set_value(poc_states[a[1]][poc_signals[a[2]].value],get_value(poc_states[a[3]]))}};poc_behaviors.AND={nparameters:4,types:["E","E","E"],operation:function(b){var a=get_value(poc_states[b[2]])&get_value(poc_states[b[3]]);set_value(poc_states[b[1]],a);update_nzvc((a<0)?1:0,(a==0)?1:0,0,0)}};poc_behaviors.OR={nparameters:4,types:["E","E","E"],operation:function(b){var a=get_value(poc_states[b[2]])|get_value(poc_states[b[3]]);set_value(poc_states[b[1]],a);update_nzvc((a<0)?1:0,(a==0)?1:0,0,0)}};poc_behaviors.NOT={nparameters:3,types:["E","E"],operation:function(b){var a=~(get_value(poc_states[b[2]]));set_value(poc_states[b[1]],a);update_nzvc((a<0)?1:0,(a==0)?1:0,0,0)}};poc_behaviors.XOR={nparameters:4,types:["E","E","E"],operation:function(b){var a=get_value(poc_states[b[2]])^get_value(poc_states[b[3]]);set_value(poc_states[b[1]],a);update_nzvc((a<0)?1:0,(a==0)?1:0,0,0)}};poc_behaviors.SRL={nparameters:3,types:["E","E"],operation:function(b){var a=(get_value(poc_states[b[2]]))>>>1;set_value(poc_states[b[1]],a);update_nzvc((a<0)?1:0,(a==0)?1:0,0,0)}};poc_behaviors.SRA={nparameters:3,types:["E","E"],operation:function(b){var a=(get_value(poc_states[b[2]]))>>1;set_value(poc_states[b[1]],a);update_nzvc((a<0)?1:0,(a==0)?1:0,0,0)}};poc_behaviors.SL={nparameters:3,types:["E","E"],operation:function(b){var a=(get_value(poc_states[b[2]]))<<1;set_value(poc_states[b[1]],a);update_nzvc((a<0)?1:0,(a==0)?1:0,0,(a)>>>31)}};poc_behaviors.RR={nparameters:3,types:["E","E"],operation:function(b){var a=((get_value(poc_states[b[2]]))>>>1)|(((get_value(poc_states[b[2]]))&1)<<31);set_value(poc_states[b[1]],a);update_nzvc((a<0)?1:0,(a==0)?1:0,0,0)}};poc_behaviors.RL={nparameters:3,types:["E","E"],operation:function(b){var a=((get_value(poc_states[b[2]]))<<1)|(((get_value(poc_states[b[2]]))&2147483648)>>>31);set_value(poc_states[b[1]],a);update_nzvc((a<0)?1:0,(a==0)?1:0,0,0)}};poc_behaviors.ADD={nparameters:4,types:["E","E","E"],operation:function(m){var k=get_value(poc_states[m[2]])<<0;var f=get_value(poc_states[m[3]])<<0;var e=k+f;set_value(poc_states[m[1]],e>>>0);var h=(e<0)?1:0;var d=(e==0)?1:0;var g=(k>>>31)&&(f>>>31);var n=0;if((e<0)&&(k>=0)&&(f>=0)){n=1}if((e>=0)&&(k<0)&&(f<0)){n=1}update_nzvc(h,d,n,g)}};poc_behaviors.SUB={nparameters:4,types:["E","E","E"],operation:function(m){var k=get_value(poc_states[m[2]])<<0;var f=get_value(poc_states[m[3]])<<0;var e=k-f;set_value(poc_states[m[1]],e>>>0);var h=(e<0)?1:0;var d=(e==0)?1:0;var g=(k>>>31)&&(f>>>31);var n=0;if((e<0)&&(k>=0)&&(f>=0)){n=1}if((e>=0)&&(k<0)&&(f<0)){n=1}update_nzvc(h,d,n,g)}};poc_behaviors.MUL={nparameters:4,types:["E","E","E"],operation:function(m){var k=get_value(poc_states[m[2]])<<0;var f=get_value(poc_states[m[3]])<<0;var e=k*f;set_value(poc_states[m[1]],e>>>0);var h=(e<0)?1:0;var d=(e==0)?1:0;var g=0;var n=0;if((e<0)&&(k>=0)&&(f>=0)){n=1}if((e>=0)&&(k<0)&&(f<0)){n=1}update_nzvc(h,d,n,g)}};poc_behaviors.DIV={nparameters:4,types:["E","E","E"],operation:function(g){var f=(get_value(poc_states[g[2]])<<0);var e=(get_value(poc_states[g[3]])<<0);if(0==e){set_value(poc_states[g[1]],0);update_nzvc(0,1,1,0);return}var d=Math.floor(f/e);set_value(poc_states[g[1]],d);update_nzvc((d<0)?1:0,(d==0)?1:0,0,0)}};poc_behaviors.MOD={nparameters:4,types:["E","E","E"],operation:function(b){var a=(get_value(poc_states[b[2]])<<0)%(get_value(poc_states[b[3]])<<0);set_value(poc_states[b[1]],a);update_nzvc((a<0)?1:0,(a==0)?1:0,0,0)}};poc_behaviors.LUI={nparameters:3,types:["E","E"],operation:function(b){var a=(get_value(poc_states[b[2]]))<<16;set_value(poc_states[b[1]],a);update_nzvc((a<0)?1:0,(a==0)?1:0,0,0)}};poc_behaviors.MBIT={nparameters:5,types:["X","X","I","I"],operation:function(a){sim_elto_org=get_reference(a[2]);sim_elto_dst=get_reference(a[1]);var f=parseInt(a[3]);var d=parseInt(a[4]);var e=get_value(sim_elto_org).toString(2);var b="00000000000000000000000000000000".substring(0,32-e.length)+e;b=b.substr(31-(f+d-1),d);set_value(sim_elto_dst,parseInt(b,2))}};poc_behaviors.MBIT_SN={nparameters:5,types:["S","E","E","I"],operation:function(b){var g=0;var f=b[3].split("/");if(1==f.length){g=get_value(poc_states[b[3]])}else{if(typeof poc_states[f[0]].value[f[1]]!="undefined"){g=poc_states[f[0]].value[f[1]]}else{if(typeof poc_signals[f[1]].default_value!="undefined"){g=poc_signals[f[1]].default_value}else{if(typeof poc_states[f[1]].default_value!="undefined"){g=poc_states[f[1]].default_value}else{alert("WARN: undefined state/field pair -> "+f[0]+"/"+f[1])}}}}var h=parseInt(b[4]);var e=get_value(poc_states[b[2]]).toString(2);var d="00000000000000000000000000000000".substring(0,32-e.length)+e;var a=d.substr(31-(g+h-1),h);set_value(poc_signals[b[1]],parseInt(a,2))}};poc_behaviors.SBIT={nparameters:4,types:["X","X","I"],operation:function(a){sim_elto_org=get_reference(a[2]);sim_elto_dst=get_reference(a[1]);var b=(sim_elto_dst.value&~(1<<a[3]))|(sim_elto_org.value<<a[3]);set_value(sim_elto_dst,(b>>>0))}};poc_behaviors.MBITS={nparameters:8,types:["E","I","E","S","S","I","S"],operation:function(b){var g=parseInt(poc_signals[b[4]].value);var e=parseInt(poc_signals[b[5]].value);var f=get_value(poc_states[b[3]]).toString(2);var d=("00000000000000000000000000000000".substring(0,32-f.length)+f);d=d.substr(31-(g+e-1),e);var a="00000000000000000000000000000000".substring(0,32-d.length)+d;if(("1"==poc_signals[b[7]].value)&&("1"==d.substr(0,1))){a="11111111111111111111111111111111".substring(0,32-d.length)+d}set_value(poc_states[b[1]],parseInt(a,2))}};poc_behaviors.BSEL={nparameters:6,types:["E","I","I","E","I"],operation:function(e){var k=parseInt(e[2]);var h=parseInt(e[5]);var a=parseInt(e[3]);var g=get_value(poc_states[e[4]]).toString(2);var f="00000000000000000000000000000000".substring(0,32-g.length)+g;f=f.substr(31-(h+a)+1,a);var d="00000000000000000000000000000000".substring(0,32-f.length)+f;var b="00000000000000000000000000000000".substr(0,k);d=d+b;set_value(poc_states[e[1]],parseInt(d,2))}};poc_behaviors.EXT_SIG={nparameters:3,types:["E","I"],operation:function(d){var f=get_value(poc_states[d[1]]).toString(2);var e=("00000000000000000000000000000000".substring(0,32-f.length)+f);var b=e.substr(31-d[2],31);var a=b;if("1"==e[31-d[2]]){a="11111111111111111111111111111111".substring(0,32-b.length)+a}set_value(poc_states[d[1]],parseInt(a,2))}};poc_behaviors.MOVE_BITS={nparameters:5,types:["S","I","I","S"],operation:function(h){var d=parseInt(h[2]);var a=0;var f=parseInt(h[3]);var g=poc_signals[h[4]].value.toString(2);g=("00000000000000000000000000000000".substring(0,32-g.length)+g);g=g.substr(31-a-f+1,f);var e=poc_signals[h[1]].value.toString(2);e=("00000000000000000000000000000000".substring(0,32-e.length)+e);var m=e.substr(0,32-(d+f));var k=e.substr(31-d+1,d);var b=m+g+k;set_value(poc_signals[h[1]],parseInt(b,2))}};poc_behaviors.MOVE_BITSE={nparameters:6,types:["S","I","I","E","I"],operation:function(h){var d=parseInt(h[2]);var a=parseInt(h[5]);var f=parseInt(h[3]);var g=get_value(poc_states[h[4]]).toString(2);g=("00000000000000000000000000000000".substring(0,32-g.length)+g);g=g.substr(31-a-f+1,f);var e=poc_signals[h[1]].value.toString(2);e=("00000000000000000000000000000000".substring(0,32-e.length)+e);var m=e.substr(0,32-(d+f));var k=e.substr(31-d+1,d);var b=m+g+k;set_value(poc_signals[h[1]],parseInt(b,2))}};poc_behaviors.DECO={nparameters:1,operation:function(k){var m=get_value(poc_states.REG_IR).toString(2);m="00000000000000000000000000000000".substring(0,32-m.length)+m;var b=parseInt(m.substr(0,6),2);var e=parseInt(m.substr(28,4),2);poc_states.INEX.value=0;var h=decode_instruction(m);if(null==h){alert("ERROR: undefined instruction code in firmware (co:"+b.toString(2)+", cop:"+e.toString(2)+")");poc_states.ROM_MUXA.value=0;poc_states.INEX.value=1;return -1}var d=b<<6;if(typeof h.cop!="undefined"){d=d+e}if(typeof poc_internal_states.ROM[d]=="undefined"){alert("ERROR: undefined rom address "+d+" in firmware");poc_states.ROM_MUXA.value=0;return -1}poc_states.ROM_MUXA.value=poc_internal_states.ROM[d];var a=get_value(poc_states.DECO_INS);set_value(poc_states.DECO_INS,a+1);var g=get_value(poc_states.REG_PC)-4;var f=get_deco_from_pc(g);set_value(poc_states.REG_IR_DECO,f);show_dbg_ir(get_value(poc_states.REG_IR_DECO))}};poc_behaviors.FIRE={nparameters:2,types:["S"],operation:function(a){if(poc_internal_states.fire_stack.indexOf(a[1])!=-1){return}poc_internal_states.fire_stack.push(a[1]);update_draw(poc_signals[a[1]],poc_signals[a[1]].value);if("L"==poc_signals[a[1]].type){update_state(a[1])}poc_internal_states.fire_stack.pop(a[1]);check_buses(a[1])}};poc_behaviors.FIRE_IFSET={nparameters:3,types:["S","I"],operation:function(a){if(get_value(poc_signals[a[1]])!=parseInt(a[2])){return}poc_behaviors.FIRE.operation(a)}};poc_behaviors.FIRE_IFCHANGED={nparameters:3,types:["S","X"],operation:function(a){sim_elto=get_reference(a[2]);if(sim_elto.changed==false){return}poc_behaviors.FIRE.operation(a)}};poc_behaviors.RESET_CHANGED={nparameters:2,types:["X"],operation:function(a){sim_elto=get_reference(a[1]);sim_elto.changed=false}};poc_behaviors.CLOCK={nparameters:1,operation:function(s_expr){var val=get_value(poc_states.CLK);set_value(poc_states.CLK,val+1);for(var i=0;i<jit_fire_order.length;i++){fn_updateE_now(jit_fire_order[i])}var new_maddr=get_value(poc_states.MUXA_MICROADDR);set_value(poc_states.REG_MICROADDR,new_maddr);if(typeof poc_internal_states.MC[new_maddr]!="undefined"){var new_mins=Object.create(poc_internal_states.MC[new_maddr])}else{var new_mins=Object.create(poc_states.REG_MICROINS.default_value)}poc_states.REG_MICROINS.value=new_mins;for(var key in poc_signals){if(typeof new_mins[key]!="undefined"){set_value(poc_signals[key],new_mins[key])}else{set_value(poc_signals[key],poc_signals[key].default_value)}}for(var i=0;i<jit_fire_order.length;i++){fn_updateL_now(jit_fire_order[i])}if(typeof new_mins.NATIVE_JIT!="undefined"){new_mins.NATIVE_JIT()}else{if(typeof new_mins.NATIVE!="undefined"){eval(new_mins.NATIVE)}}}};poc_behaviors.RESET={nparameters:1,operation:function(a){for(var d in poc_states){reset_value(poc_states[d])}for(var d in poc_signals){reset_value(poc_signals[d])}poc_events.screen={};poc_events.keybd={};poc_events.io={};poc_events.mem={};for(var b=0;b<poc_internal_states.io_int_factory.length;b++){set_value(poc_internal_states.io_int_factory[b].accumulated,0);set_value(poc_internal_states.io_int_factory[b].active,false)}}};poc_behaviors.UPDATEDPC={nparameters:1,operation:function(a){show_asmdbg_pc()}};poc_components.MEMORY={name:"MEMORY",version:"1",write_state:function(d){if(typeof d.MEMORY=="undefined"){d.MEMORY={}}var b=0;var e=0;for(var a in poc_internal_states.MP){e=parseInt(poc_internal_states.MP[a]);if(e!=0){b=parseInt(a).toString(16);d.MEMORY["0x"+b]={type:"memory",default_value:0,id:"0x"+b,op:"=",value:"0x"+e.toString(16)}}}return d},read_state:function(d,a){if(typeof d.MEMORY=="undefined"){d.MEMORY={}}var b=parseInt(a.id).toString(16);var e=parseInt(a.value).toString(16);if("MEMORY"==a.type.toUpperCase().trim()){d.MEMORY["0x"+b]={type:"memory",default_value:0,id:"0x"+b,op:a.condition,value:"0x"+e};return true}return false},get_state:function(b){var a=parseInt(b);if(typeof poc_internal_states.MP[a]!="undefined"){return"0x"+parseInt(poc_internal_states.MP[a]).toString(16)}return null}};poc_internal_states.segments={};poc_internal_states.MP={};poc_internal_states.MP_wc=0;poc_signals.MRDY={name:"MRDY",visible:true,type:"L",value:0,default_value:0,nbits:"1",depends_on:["CLK"],behavior:["FIRE_IFCHANGED MRDY C","FIRE_IFCHANGED MRDY C"],fire_name:["svg_p:tspan3916"],draw_data:[[],["svg_p:path3895","svg_p:path3541"]],draw_name:[[],[]]};poc_signals.R={name:"R",visible:true,type:"L",value:0,default_value:0,nbits:"1",behavior:["NOP","MEM_READ BUS_AB BUS_DB BWA MRDY CLK; FIRE MRDY"],fire_name:["svg_p:text3533-5-2","svg_p:text3713"],draw_data:[[],["svg_p:path3557","svg_p:path3571"]],draw_name:[[],[]]};poc_signals.W={name:"W",visible:true,type:"L",value:0,default_value:0,nbits:"1",behavior:["NOP","MEM_WRITE BUS_AB BUS_DB BWA MRDY CLK; FIRE MRDY"],fire_name:["svg_p:text3533-5-08","svg_p:text3527","svg_p:text3431-7"],draw_data:[[],["svg_p:path3559","svg_p:path3575","svg_p:path3447-7"]],draw_name:[[],[]]};poc_behaviors.MEM_READ={nparameters:6,types:["E","E","S","S","E"],operation:function(b){var a=poc_states[b[1]].value;var d=poc_states[b[2]].value;var h=poc_signals[b[3]].value;var f=get_value(poc_states[b[5]].value);poc_signals[b[4]].value=0;var g=get_value(poc_internal_states.MP_wc);if((typeof poc_events.mem[f-1]!="undefined")&&(poc_events.mem[f-1]>0)){g=poc_events.mem[f-1]-1}poc_events.mem[f]=g;if(g>0){return}var e=0;a=a&4294967292;if(typeof poc_internal_states.MP[a]!="undefined"){e=poc_internal_states.MP[a]}if(0==(h&12)){if(0==(h&3)){d=(d&4294967040)|(e&255)}if(1==(h&3)){d=(d&4294902015)|(e&65280)}if(2==(h&3)){d=(d&4278255615)|(e&16711680)}if(3==(h&3)){d=(d&16777215)|(e&4278190080)}}else{if(1==(h&12)){if(0==(h&2)){d=(d&4294901760)|(e&65535)}if(1==(h&2)){d=(d&65535)|(e&4294901760)}}else{d=e}}poc_states[b[2]].value=(d>>>0);poc_signals[b[4]].value=1;show_main_memory(poc_internal_states.MP,a,false,false)}};poc_behaviors.MEM_WRITE={nparameters:6,types:["E","E","S","S","E"],operation:function(b){var a=poc_states[b[1]].value;var d=poc_states[b[2]].value;var h=poc_signals[b[3]].value;var f=get_value(poc_states[b[5]].value);poc_signals[b[4]].value=0;var g=get_value(poc_internal_states.MP_wc);if((typeof poc_events.mem[f-1]!="undefined")&&(poc_events.mem[f-1]>0)){g=poc_events.mem[f-1]-1}poc_events.mem[f]=g;if(g>0){return}var e=0;a=a&4294967292;if(typeof poc_internal_states.MP[a]!="undefined"){e=poc_internal_states.MP[a]}if(0==(h&12)){if(0==(h&3)){e=(e&4294967040)|(d&255)}if(1==(h&3)){e=(e&4294902015)|(d&65280)}if(2==(h&3)){e=(e&4278255615)|(d&16711680)}if(3==(h&3)){e=(e&16777215)|(d&4278190080)}}else{if(1==(h&12)){if(0==(h&2)){e=(e&4294901760)|(d&65535)}if(1==(h&2)){e=(e&65535)|(d&4294901760)}}else{e=d}}poc_internal_states.MP[a]=(e>>>0);poc_signals[b[4]].value=1;show_main_memory(poc_internal_states.MP,a,false,true)}};poc_components.IO={name:"IO",version:"1",write_state:function(a){return a},read_state:function(b,a){return false},get_state:function(a){return null}};poc_internal_states.io_int_factory=[];poc_internal_states.io_int_factory[0]={period:0,probability:0.5,accumulated:0,active:false};poc_internal_states.io_int_factory[1]={period:0,probability:0.5,accumulated:0,active:false};poc_internal_states.io_int_factory[2]={period:0,probability:0.5,accumulated:0,active:false};poc_internal_states.io_int_factory[3]={period:0,probability:0.5,accumulated:0,active:false};poc_internal_states.io_int_factory[4]={period:0,probability:0.5,accumulated:0,active:false};poc_internal_states.io_int_factory[5]={period:0,probability:0.5,accumulated:0,active:false};poc_internal_states.io_int_factory[6]={period:0,probability:0.5,accumulated:0,active:false};poc_internal_states.io_int_factory[7]={period:0,probability:0.5,accumulated:0,active:false};var IOSR_ID=4352;var IOCR_ID=4356;var IODR_ID=4360;poc_internal_states.io_hash[IOSR_ID]="IOSR";poc_internal_states.io_hash[IOCR_ID]="IOCR";poc_internal_states.io_hash[IODR_ID]="IODR";poc_states.IOSR={name:"IOSR",visible:false,nbits:"32",value:0,default_value:0,draw_data:[]};poc_states.IOCR={name:"IOCR",visible:false,nbits:"32",value:0,default_value:0,draw_data:[]};poc_states.IODR={name:"IODR",visible:false,nbits:"32",value:0,default_value:0,draw_data:[]};poc_signals.INT={name:"INT",visible:true,type:"L",value:0,default_value:0,nbits:"1",depends_on:["CLK"],behavior:["FIRE C","FIRE C"],fire_name:["svg_p:tspan4199"],draw_data:[[],["svg_p:path3809"]],draw_name:[[],[]]};poc_signals.IORDY={name:"IORDY",visible:true,type:"L",value:0,default_value:0,nbits:"1",depends_on:["CLK"],behavior:["FIRE_IFCHANGED IORDY C","FIRE_IFCHANGED IORDY C"],fire_name:["svg_p:tspan4089","svg_p:path3793"],draw_data:[[],["svg_p:path3897"]],draw_name:[[],[]]};poc_signals.IO_IOR={name:"IO_IOR",visible:true,type:"L",value:0,default_value:0,nbits:"1",behavior:["NOP","IO_IOR BUS_AB BUS_DB IOSR IOCR IODR CLK; FIRE SBWA"],fire_name:["svg_p:tspan4173","svg_p:text3715"],draw_data:[[],["svg_p:path3795","svg_p:path3733"]],draw_name:[[],[]]};poc_signals.IO_IOW={name:"IO_IOW",visible:true,type:"L",value:0,default_value:0,nbits:"1",behavior:["NOP","IO_IOW BUS_AB BUS_DB IOSR IOCR IODR CLK; FIRE SBWA"],fire_name:["svg_p:text3785-0-6-0-5-5","svg_p:text3717"],draw_data:[[],["svg_p:path3805","svg_p:path3733"]],draw_name:[[],[]]};poc_signals.IO_IE={name:"IO_IE",visible:true,type:"L",value:1,default_value:1,nbits:"1",behavior:["NOP","IO_CHK_I CLK INT INTV; FIRE C"],fire_name:[],draw_data:[[],[]],draw_name:[[],[]]};poc_signals.INTA={name:"INTA",visible:true,type:"L",value:1,default_value:0,nbits:"1",behavior:["NOP","INTA CLK INT INTA BUS_DB INTV; FIRE BW; FIRE C"],fire_name:["svg_p:text3785-0-6-0-5-5-1-1"],draw_data:[[],["svg_p:path3807","svg_p:path3737"]],draw_name:[[],[]]};poc_behaviors.IO_IOR={nparameters:7,types:["E","E","E","E","E","E"],operation:function(a){var f=get_value(poc_states[a[1]]);var b=get_value(poc_states[a[3]]);var d=get_value(poc_states[a[4]]);var e=get_value(poc_states[a[5]]);if(f==IOSR_ID){set_value(poc_states[a[2]],b)}if(f==IOCR_ID){set_value(poc_states[a[2]],d)}if(f==IODR_ID){set_value(poc_states[a[2]],e)}}};poc_behaviors.IO_IOW={nparameters:7,types:["E","E","E","E","E","E"],operation:function(b){var f=get_value(poc_states[b[1]]);var d=get_value(poc_states[b[2]]);if((f!=IOSR_ID)&&(f!=IOCR_ID)&&(f!=IODR_ID)){return}if(f==IOSR_ID){set_value(poc_states[b[3]],d)}if(f==IOCR_ID){set_value(poc_states[b[4]],d)}if(f==IODR_ID){set_value(poc_states[b[5]],d)}var a=get_value(poc_states[b[4]]);var e=get_value(poc_states[b[5]]);if((a<0)||(a>7)){return}set_value(poc_internal_states.io_int_factory[a].period,e);set_value(poc_internal_states.io_int_factory[a].probability,1);if(0==e){set_value(poc_internal_states.io_int_factory[a].probability,0)}}};poc_behaviors.IO_CHK_I={nparameters:4,types:["E","S","E"],operation:function(a){var d=get_value(poc_states[a[1]]);for(var b=poc_internal_states.io_int_factory.length-1;b>=0;b--){if(get_value(poc_internal_states.io_int_factory[b].period)==0){continue}if(get_value(poc_internal_states.io_int_factory[b].active)==true){set_value(poc_signals[a[2]],1);set_value(poc_states[a[3]],b)}if((d%get_value(poc_internal_states.io_int_factory[b].period))==0){if(Math.random()>get_value(poc_internal_states.io_int_factory[b].probability)){continue}set_value(poc_internal_states.io_int_factory[b].accumulated,get_value(poc_internal_states.io_int_factory[b].accumulated)+1);set_value(poc_internal_states.io_int_factory[b].active,true);if(typeof poc_events.io[d]=="undefined"){poc_events.io[d]=[]}poc_events.io[d].push(b);set_value(poc_signals[a[2]],1);set_value(poc_states[a[3]],b)}}}};poc_behaviors.INTA={nparameters:6,types:["E","S","S","E","E"],operation:function(a){var d=get_value(poc_states[a[1]]);if(typeof poc_events.io[d]!="undefined"){set_value(poc_states[a[4]],poc_events.io[d][0]);return}set_value(poc_signals[a[2]],0);set_value(poc_states[a[5]],0);for(var b=0;b<poc_internal_states.io_int_factory.length;b++){if(get_value(poc_internal_states.io_int_factory[b].active)){set_value(poc_signals[a[2]],0);set_value(poc_states[a[5]],b);set_value(poc_states[a[4]],b);if(typeof poc_events.io[d]=="undefined"){poc_events.io[d]=[]}poc_events.io[d].push(b);set_value(poc_internal_states.io_int_factory[b].active,false);break}}}};poc_components.KBD={name:"KBD",version:"1",write_state:function(a){return a},read_state:function(b,a){return false},get_state:function(a){return null}};var KBDR_ID=256;var KBSR_ID=260;poc_internal_states.io_hash[KBDR_ID]="KBDR";poc_internal_states.io_hash[KBSR_ID]="KBSR";poc_states.KBDR={name:"KBDR",visible:false,nbits:"32",value:0,default_value:0,draw_data:[]};poc_states.KBSR={name:"KBSR",visible:false,nbits:"32",value:0,default_value:0,draw_data:[]};poc_signals.KBD_IOR={name:"IOR",visible:true,type:"L",value:0,default_value:0,nbits:"1",behavior:["NOP","KBD_IOR BUS_AB BUS_DB KBDR KBSR CLK; FIRE SBWA"],fire_name:["svg_p:tspan4057"],draw_data:[[],["svg_p:path3863","svg_p:path3847"]],draw_name:[[],[]]};poc_behaviors.KBD_IOR={nparameters:6,types:["E","E","E","E","E"],operation:function(d){var f=get_value(poc_states[d[1]]);var e=get_value(poc_states[d[5]]);if((f!=KBDR_ID)&&(f!=KBSR_ID)){return}if(typeof poc_events.keybd[e]!="undefined"){if(f==KBDR_ID){set_value(poc_states[d[2]],poc_events.keybd[e])}if(f==KBSR_ID){set_value(poc_states[d[2]],1)}return}if(get_value(poc_states[d[4]])==0){var b=get_keyboard_content();if(b.length!=0){var a=b.substr(1,b.length-1);set_keyboard_content(a);set_value(poc_states[d[4]],1);set_value(poc_states[d[3]],b[0].charCodeAt(0))}}if(get_value(poc_states[d[4]])==1){poc_events.keybd[e]=get_value(poc_states[d[3]])}if(f==KBSR_ID){set_value(poc_states[d[2]],get_value(poc_states[d[4]]))}if(f==KBDR_ID){if(get_value(poc_states[d[4]])==1){set_value(poc_states[d[2]],get_value(poc_states[d[3]]))}set_value(poc_states[d[4]],0)}}};poc_components.SCREEN={name:"SCREEN",version:"1",write_state:function(b){if(typeof b.SCREEN=="undefined"){b.SCREEN={}}var e=get_screen_content();var d=e.trim().split("\n");for(var a=0;a<d.length;a++){value=d[a];if(value!=""){b.SCREEN[a]={type:"screen",default_value:"",id:a,op:"==",value:value}}}return b},read_state:function(b,a){if(typeof b.SCREEN=="undefined"){b.SCREEN={}}if("SCREEN"==a.type.toUpperCase().trim()){b.SCREEN[a.id]={type:"screen",default_value:"",id:a.id,op:a.condition,value:a.value};return true}return false},get_state:function(a){var e=get_screen_content();var d=e.trim().split("\n");var b=parseInt(a);if(typeof d[b]!="undefined"){return d[b]}return null}};var DDR_ID=4096;var DSR_ID=4100;poc_internal_states.io_hash[DDR_ID]="DDR";poc_internal_states.io_hash[DSR_ID]="DSR";poc_states.DDR={name:"DDR",visible:false,nbits:"32",value:0,default_value:0,draw_data:[]};poc_states.DSR={name:"DSR",visible:false,nbits:"32",value:0,default_value:0,draw_data:[]};poc_signals.SCR_IOR={name:"IOR",visible:true,type:"L",value:0,default_value:0,nbits:"1",behavior:["NOP","SCR_IOR BUS_AB BUS_DB DDR DSR CLK"],fire_name:["svg_p:tspan4004"],draw_data:[[],["svg_p:path3871","svg_p:path3857"]],draw_name:[[],[]]};poc_signals.SCR_IOW={name:"IOW",visible:true,type:"L",value:0,default_value:0,nbits:"1",behavior:["NOP","SCR_IOW BUS_AB BUS_DB DDR DSR CLK"],fire_name:["svg_p:tspan4006"],draw_data:[[],["svg_p:path3873","svg_p:path3857"]],draw_name:[[],[]]};poc_behaviors.SCR_IOR={nparameters:6,types:["E","E","E","E","E"],operation:function(b){var e=get_value(poc_states[b[1]]);var d=get_value(poc_states[b[3]]);var a=get_value(poc_states[b[4]]);if(e==DDR_ID){set_value(poc_states[b[2]],d)}if(e==DSR_ID){set_value(poc_states[b[2]],a)}}};poc_behaviors.SCR_IOW={nparameters:6,types:["E","E","E","E","E"],operation:function(d){var k=get_value(poc_states[d[1]]);var f=get_value(poc_states[d[2]]);var h=get_value(poc_states[d[5]]);var g=String.fromCharCode(f);if(k!=DDR_ID){return}if(g==String.fromCharCode(7)){timbre.reset();var e=T("sin",{freq:440,mul:0.5});var b=T("sin",{freq:660,mul:0.5});T("perc",{r:500},e,b).on("ended",function(){this.pause()}).bang().play()}else{var a=get_screen_content();if(typeof poc_events.screen[h]!="undefined"){a=a.substr(0,a.length-1)}set_screen_content(a+String.fromCharCode(f))}set_value(poc_states[d[3]],f);set_value(poc_states[d[4]],1);poc_events.screen[h]=f}};function nextToken(d){var a="";var g="";var f="";var e="";while(("# \t\n\r".indexOf(d.text[d.t])!=-1)&&(d.t<d.text.length)){if(d.text[d.t]=="#"){g=d.t+1;while(("\n".indexOf(d.text[d.t])==-1)&&(d.t<d.text.length)){d.t++}f=d.t;a=d.text.substring(g,f);a=a.trim();d.comments.push(a)}if(d.text[d.t]=="\n"){d.line++;d.newlines.push(d.t)}d.t++}if(("{},()=:".indexOf(d.text[d.t])!=-1)&&(d.t<d.text.length)){a=d.text[d.t];d.t++;d.tokens.push(a);d.token_types.push("TOKEN");d.i=d.tokens.length-1;return d}if('"'==d.text[d.t]){g=d.t;d.t++;while(('"'.indexOf(d.text[d.t])==-1)&&(d.t<d.text.length)){if("\\".indexOf(d.text[d.t])!=-1){d.t++}d.t++}d.t++;f=d.t;e="STRING"}else{if("'"==d.text[d.t]){g=d.t;d.t++;while(("'".indexOf(d.text[d.t])==-1)&&(d.t<d.text.length)){if("\\".indexOf(d.text[d.t])!=-1){d.t++}d.t++}d.t++;f=d.t;e="STRING"}else{g=d.t;while(("{},()=:# \t\n\r".indexOf(d.text[d.t])==-1)&&(d.t<d.text.length)){d.t++}f=d.t;e="TOKEN"}}var b=d.t;while(("# \t\n\r".indexOf(d.text[b])!=-1)&&(b<d.text.length)){if(d.text[b]=="#"){while(("\n".indexOf(d.text[b])==-1)&&(b<d.text.length)){b++}}b++}if(":"==d.text[b]){e="TAG";d.t=b+1}a=d.text.substring(g,f);a=a.trim();if("TAG"==e){a=a+":"}d.tokens.push(a);d.token_types.push(e);d.i=d.tokens.length-1;return d}function getToken(a){return a.tokens[a.i]}function getTokenType(a){return a.token_types[a.i]}function isToken(a,b){return(getToken(a)==b.trim())}function langError(f,g){var a=0;if(f.newlines.length>0){a=f.newlines[f.newlines.length-1]+1}var d=0;if(f.newlines.length>1){d=f.newlines[f.newlines.length-2]+1}var b=d;var h=Math.min(f.t-1,a+32);for(;(typeof f.text[h+1]!="undefined")&&(f.text[h+1]!="\n");h++){}var k=h+2;h++;for(;(typeof f.text[h+1]!="undefined")&&(f.text[h+1]!="\n");h++){}h++;f.error="<pre style='background-color: inherit !important'>...\n";for(var e=b;e<h;e++){if(e==d){f.error+=" "+(f.line-1)+"\t"}if(e==a){f.error+="*"+f.line+"\t"}if(e==k){f.error+=" "+(f.line+1)+"\t"}if(typeof f.text[e]!="undefined"){f.error+=f.text[e]}else{f.error+="&lt;EOF&gt;"}}f.error+="\n...\n</pre>(*) Problem around line "+f.line+":<br>"+g+".<br>";if(typeof ga!=="undefined"){ga("send","event","compile","compile.error","compile.error."+g)}return f}function getLabelContext(a){return{t:a.t,line:a.line,newlines:a.newlines.slice()}}function setLabelContext(b,a){b.t=a.t;b.line=a.line;b.newlines=a.newlines}function getComments(a){return a.comments.join("\n")}function resetComments(a){a.comments=[]}function nextNative(b){var f=b.t;var d=b.t;var e=1;while((b.t<b.text.length)&&(e!=0)){if("{"==b.text[b.t]){e++}if("}"==b.text[b.t]){e--}b.t++}d=b.t-1;var a=b.text.substring(f,d);b.tokens.push(a);b.token_types.push("NATIVE");b.i=b.tokens.length-1;return b}function read_microprg(a){var e=[];var p=[];resetComments(a);if(!isToken(a,"{")){return langError(a,"Expected '{' not found")}nextToken(a);while(!isToken(a,"}")){var m={};if(!isToken(a,"(")){var n=getToken(a);n=n.substring(0,n.length-1);if("TAG"!=getTokenType(a)){return langError(a,"Expected '<label>:' not found but '"+n+"'.")}for(var d in a.etiquetas){if(a.etiquetas[d]==n){return langError(a,"Label is repeated: "+getToken(a))}}a.etiquetas[a.contadorMC]=n;if(n.match("[a-zA-Z_0-9]*")[0]!=n){return langError(a,"Label format is not valid for '"+getToken(a)+"'")}nextToken(a)}if(!isToken(a,"(")){return langError(a,"Expected '(' not found")}nextToken(a);while(!isToken(a,")")){var g=getToken(a).toUpperCase();if(g=="MADDR"){nextToken(a);if(!isToken(a,"=")){return langError(a,"Expected '=' not found")}nextToken(a);var o={};o.nombre=getToken(a);o.cycle=e.length;o.index=a.i;o.instruction=a.instrucciones.length;var f=0;for(var h in a.etiquetas){if(isToken(a,a.etiquetas[h])){m[g]=h.toString();f=1}}if(f==0){a.labelsNotFound.push(o)}nextToken(a);if(isToken(a,",")){nextToken(a)}continue}if(typeof simhw_sim_signal(g)=="undefined"){return langError(a,"Signal does not exists: '"+g+"'")}if(typeof simhw_sim_signal(g).forbidden!="undefined"){return langError(a,"Signal '"+g+"' cannot be used directly, please use the Control Unit signals instead.")}m[g]=1;nextToken(a);if(isToken(a,"=")){nextToken(a);m[g]=parseInt(getToken(a),2);if(getToken(a).match("[01]*")[0]!=getToken(a)){return langError(a,"Incorrect binary format: "+getToken(a))}if(m[g]>=Math.pow(2,simhw_sim_signal(g).nbits)){return langError(a,"Value out of range: "+getToken(a))}nextToken(a)}if(isToken(a,",")){nextToken(a)}}var b=getComments(a);p.push(b);resetComments(a);e.push(m);a.contadorMC++;nextToken(a);if(isToken(a,",")){nextToken(a)}}if(e.length==0){return langError(a,"Empty microcode")}nextToken(a);return{microprograma:e,microcomments:p}}function read_native(b){var e=[];var a=[];if(!isToken(b,"{")){return langError(b,"Expected '{' not found")}nextNative(b);var d={};d.NATIVE=getToken(b);e.push(d);a.push("");nextToken(b);return{microprograma:e,microcomments:a}}function loadFirmware(text){var context={};context.line=1;context.error=null;context.i=0;context.contadorMC=0;context.etiquetas={};context.labelsNotFound=[];context.instrucciones=[];context.co_cop={};context.registers=[];context.text=text;context.tokens=[];context.token_types=[];context.t=0;context.newlines=[];context.pseudoInstructions=[];context.stackRegister=null;context.comments=[];nextToken(context);while(context.t<context.text.length){if(isToken(context,"registers")){nextToken(context);if(!isToken(context,"{")){return langError(context,"Expected '{' not found")}nextToken(context);while(!isToken(context,"}")){var nombre_reg=getToken(context);nextToken(context);if(!isToken(context,"=")){return langError(context,"Expected '=' not found")}nextToken(context);context.registers[nombre_reg]=getToken(context);nextToken(context);if(isToken(context,"(")){if(context.stackRegister!=null){return langError(context,"Duplicate definition of stack pointer")}nextToken(context);if(!isToken(context,"stack_pointer")){return langError(context,"Expected stack_pointer token not found")}context.stackRegister=nombre_reg;nextToken(context);if(!isToken(context,")")){return langError(context,"Expected ')' not found")}nextToken(context)}if(isToken(context,",")){nextToken(context)}}nextToken(context);continue}if(isToken(context,"pseudoinstructions")){nextToken(context);if(!isToken(context,"{")){return langError(context,"Expected '{' not found")}nextToken(context);while(!isToken(context,"}")){var pseudoInstructionAux={};var pseudoInitial={};pseudoInitial.signature="";pseudoInitial.name="";pseudoInitial.fields=[];pseudoInitial.name=getToken(context);pseudoInitial.signature=pseudoInitial.signature+getToken(context)+",";nextToken(context);while(!isToken(context,"{")){var pseudoFieldAux={};pseudoFieldAux.name=getToken(context);pseudoFieldAux.type=getToken(context).replace("num","inm");pseudoFieldAux.type=pseudoFieldAux.type.replace(/[_0-9]+$/,"");switch(pseudoFieldAux.type){case"reg":case"inm":case"addr":case"address":break;default:return langError(context,"Invalid parameter '"+pseudoFieldAux.type+"'. It only allows the following fields: reg, num, inm, addr, address")}pseudoInitial.fields.push(pseudoFieldAux);pseudoInitial.signature=pseudoInitial.signature+getToken(context)+",";nextToken(context);if(isToken(context,",")){nextToken(context)}}nextToken(context);pseudoInitial.signature=pseudoInitial.signature.substr(0,pseudoInitial.signature.length-1).replace(/num/g,"inm");pseudoInstructionAux.initial=pseudoInitial;var contPseudoFinish=0;var pseudoFinishAux={};pseudoFinishAux.signature="";var inStart=0;var cont=false;while(!isToken(context,"}")){if(inStart==0){for(i=0;i<context.instrucciones.length;i++){if(context.instrucciones[i].name==getToken(context)){cont=true;break}}if(!cont){return langError(context,"Undefined instruction '"+getToken(context)+"'")}}if(getToken(context)==";"){inStart=0}else{inStart++}pseudoFinishAux.signature=pseudoFinishAux.signature+getToken(context)+" ";nextToken(context)}pseudoInstructionAux.finish=pseudoFinishAux;pseudoInstructionAux.finish.signature=pseudoInstructionAux.finish.signature.replace(";","\n");context.pseudoInstructions.push(pseudoInstructionAux);nextToken(context)}nextToken(context);continue}if(isToken(context,"begin")){var instruccionAux={};instruccionAux.name=getToken(context);instruccionAux["mc-start"]=context.contadorMC;nextToken(context);if(isToken(context,",")){nextToken(context)}instruccionAux["native"]=false;if(isToken(context,"native")){instruccionAux["native"]=true;nextToken(context);if(isToken(context,",")){nextToken(context)}context.etiquetas[context.contadorMC]="fetch"}if(true==instruccionAux["native"]){var ret=read_native(context)}else{var ret=read_microprg(context)}if(typeof ret.error!="undefined"){return ret}instruccionAux.signature="begin";instruccionAux.signatureGlobal="begin";instruccionAux.signatureUser="begin";instruccionAux.signatureRaw="begin";instruccionAux.microcode=ret.microprograma;instruccionAux.microcomments=ret.microcomments;context.instrucciones.push(instruccionAux);context.contadorMC=context.contadorMC+9;continue}var instruccionAux={};instruccionAux.name=getToken(context);instruccionAux["mc-start"]=context.contadorMC;if(instruccionAux.name.match("[a-zA-Z_0-9]*")[0]!=instruccionAux.name){return langError(context,"Instruction name '"+instruccionAux.name+"' is not valid for [a-zA-Z_0-9]*")}var firma="";var firmaGlobal="";var firmaUsuario="";var numeroCampos=0;var campos=[];firma=getToken(context)+",";firmaUsuario=getToken(context)+" ";nextToken(context);while(isToken(context,",")){nextToken(context)}while(!isToken(context,"{")){while(isToken(context,",")){nextToken(context)}var plus_found=false;if(!isToken(context,",")&&!isToken(context,"(")&&!isToken(context,")")){var campoAux={};var auxValue=getToken(context);if(auxValue[auxValue.length-1]=="+"){auxValue=auxValue.substring(0,auxValue.length-1);plus_found=true}campoAux.name=auxValue;campos.push(campoAux);numeroCampos++;firma=firma+auxValue;firmaUsuario=firmaUsuario+auxValue;nextToken(context);if(numeroCampos>100){return langError(context,"more than 100 fields in a single instruction.")}if(auxValue=="co"){return langError(context,"instruction field has 'co' as name.")}if(auxValue=="nwords"){return langError(context,"instruction field has 'nwords' as name.")}}if(isToken(context,"(")){firma=firma+",(";if(plus_found){firmaUsuario=firmaUsuario+"+("}else{firmaUsuario=firmaUsuario+" ("}nextToken(context);if(!isToken(context,",")&&!isToken(context,"(")&&!isToken(context,")")){var campoAux={};campoAux.name=getToken(context);campos.push(campoAux);numeroCampos++;firma=firma+getToken(context);firmaUsuario=firmaUsuario+getToken(context);nextToken(context)}else{return langError(context,"'token' is missing after '(' on: "+context.co_cop[instruccionAux.co].signature)}if(isToken(context,")")){firma=firma+")";firmaUsuario=firmaUsuario+")";nextToken(context)}else{return langError(context,"')' is missing on: "+context.co_cop[instruccionAux.co].signature)}}firma=firma+",";firmaUsuario=firmaUsuario+" "}firma=firma.substr(0,firma.length-1);firmaUsuario=firmaUsuario.substr(0,firmaUsuario.length-1);instruccionAux.signature=firma;instruccionAux.signatureGlobal=firma;instruccionAux.signatureUser=firmaUsuario;instruccionAux.signatureRaw=firmaUsuario;nextToken(context);if(!isToken(context,"co")){return langError(context,"Expected keyword 'co' not found")}nextToken(context);if(!isToken(context,"=")){return langError(context,"Expected '=' not found")}nextToken(context);instruccionAux.co=getToken(context);if((getToken(context).match("[01]*")[0]!=getToken(context))||(getToken(context).length!=6)){return langError(context,"Incorrect binary format on 'co': "+getToken(context))}if(instruccionAux.co!="111111"){if((typeof context.co_cop[instruccionAux.co]!="undefined")&&(context.co_cop[instruccionAux.co].cop==null)){return langError(context,"'co' is already been used by: "+context.co_cop[instruccionAux.co].signature)}if(typeof context.co_cop[instruccionAux.co]=="undefined"){context.co_cop[instruccionAux.co]={};context.co_cop[instruccionAux.co].signature=instruccionAux.signature;context.co_cop[instruccionAux.co].cop=null}}nextToken(context);if(isToken(context,",")){nextToken(context)}if(isToken(context,"cop")){nextToken(context);if(!isToken(context,"=")){return langError(context,"Expected '=' not found")}nextToken(context);instruccionAux.cop=getToken(context);if((getToken(context).match("[01]*")[0]!=getToken(context))||(getToken(context).length!=4)){return langError(context,"Incorrect binary format on 'cop': "+getToken(context))}if((context.co_cop[instruccionAux.co].cop!=null)&&(typeof context.co_cop[instruccionAux.co].cop[instruccionAux.cop]!="undefined")){return langError(context,"'co+cop' is already been used by: "+context.co_cop[instruccionAux.co].cop[instruccionAux.cop])}if(context.co_cop[instruccionAux.co].cop==null){context.co_cop[instruccionAux.co].cop={}}context.co_cop[instruccionAux.co].cop[instruccionAux.cop]=instruccionAux.signature;nextToken(context);if(isToken(context,",")){nextToken(context)}}if(!isToken(context,"nwords")){return langError(context,"Expected keyword 'nwords' not found")}nextToken(context);if(!isToken(context,"=")){return langError(context,"Expected '=' not found")}nextToken(context);instruccionAux.nwords=getToken(context);nextToken(context);if(isToken(context,",")){nextToken(context)}var camposInsertados=0;var overlapping={};while(camposInsertados<numeroCampos){var tmp_name=getToken(context);if(campos[camposInsertados]["name"]!=tmp_name){return langError(context,"Unexpected field found: '"+tmp_name+"'")}nextToken(context);if(!isToken(context,"=")){return langError(context,"Expected '=' not found")}nextToken(context);if(!isToken(context,"reg")&&!isToken(context,"inm")&&!isToken(context,"address")){return langError(context,"Incorrect type of field (reg, inm or address)")}campos[camposInsertados]["type"]=getToken(context);firma=firma.replace(","+campos[camposInsertados]["name"],","+campos[camposInsertados]["type"]);firma=firma.replace("("+campos[camposInsertados]["name"],"("+campos[camposInsertados]["type"]);firma=firma.replace(")"+campos[camposInsertados]["name"],")"+campos[camposInsertados]["type"]);firmaUsuario=firmaUsuario.replace(campos[camposInsertados]["name"],campos[camposInsertados]["type"]);instruccionAux.signature=firma;instruccionAux.signatureUser=firmaUsuario;firmaGlobal=firma.replace("address","num");firmaGlobal=firmaGlobal.replace("inm","num");instruccionAux.signatureGlobal=firmaGlobal;nextToken(context);if(!isToken(context,"(")){return langError(context,"Expected '(' not found")}nextToken(context);campos[camposInsertados]["startbit"]=getToken(context);var start=parseInt(campos[camposInsertados]["startbit"]);if(start>32*parseInt(instruccionAux.nwords)-1){return langError(context,"startbit out of range: "+getToken(context))}nextToken(context);if(!isToken(context,",")){return langError(context,"Expected ',' not found")}nextToken(context);campos[camposInsertados]["stopbit"]=getToken(context);var stop=parseInt(campos[camposInsertados]["stopbit"]);if(stop>32*parseInt(instruccionAux.nwords)){return langError(context,"stopbit out of range: "+getToken(context))}for(var i=stop;i<=start;i++){if(typeof overlapping[i]!="undefined"){return langError(context,"overlapping field: "+campos[camposInsertados]["name"])}overlapping[i]=1}nextToken(context);if(!isToken(context,")")){return langError(context,"Expected ')' not found")}nextToken(context);if(campos[camposInsertados]["type"]=="address"){if(getToken(context)!="abs"&&getToken(context)!="rel"){return langError(context,"Type of addressing incorrect (abs or rel)")}campos[camposInsertados]["address_type"]=getToken(context);nextToken(context)}if(isToken(context,",")){nextToken(context)}camposInsertados++}instruccionAux.fields=campos;instruccionAux["native"]=false;if(isToken(context,"native")){instruccionAux["native"]=true;nextToken(context);if(isToken(context,",")){nextToken(context)}}if(true==instruccionAux["native"]){var ret=read_native(context)}else{var ret=read_microprg(context)}if(typeof ret.error!="undefined"){return ret}instruccionAux.microcode=ret.microprograma;instruccionAux.microcomments=ret.microcomments;context.instrucciones.push(instruccionAux);context.contadorMC=context.contadorMC+9;if(!isToken(context,"}")){return langError(context,"Expected '}' not found")}nextToken(context)}if(context.stackRegister==null){return langError(context,"Stack pointer register was not defined")}var found=false;for(var i=0;i<context.instrucciones.length;i++){if(context.instrucciones[i].name=="begin"){for(var j=0;j<context.instrucciones[i].microcode.length;j++){if((typeof context.etiquetas[j]!="undefined")&&(context.etiquetas[j]=="fetch")){found=true}}if(found===false){return langError(context,"label 'fetch' not defined")}}}if(found===false){return langError(context,"'begin' not found")}var first_co=0;var last_co=Math.pow(2,6)-1;var label="";for(var i=0;i<context.instrucciones.length;i++){if((context.instrucciones[i].name!="begin")&&(context.instrucciones[i].co=="111111")){for(var j=first_co;j<last_co;j++){label=j.toString(2);label="000000".substring(0,6-label.length)+label;if(typeof context.co_cop[label]=="undefined"){break}}if(j>=last_co){return langError(context,"There is not enough 'co' codes available for instructions")}context.instrucciones[i].co=label;context.co_cop[label]={};context.co_cop[label].signature=context.instrucciones[i].signature;context.co_cop[label].cop=null;first_co=j}}var labelsFounded=0;if(context.labelsNotFound.length>0){for(var i=0;i<context.labelsNotFound.length;i++){for(var j in context.etiquetas){if(context.etiquetas[j]==context.labelsNotFound[i].nombre){context.instrucciones[context.labelsNotFound[i].instruction].microcode[context.labelsNotFound[i].cycle].MADDR=j;labelsFounded++}}if(labelsFounded==0){return langError(context,"MADDR label not found : "+context.labelsNotFound[i].nombre)}labelsFounded=0}}var mk_native="";for(var i=0;i<context.instrucciones.length;i++){var ins=context.instrucciones[i];if(false==ins["native"]){continue}for(var j=0;j<ins.microcode.length;j++){if(typeof ins.microcode[j].NATIVE!="undefined"){mk_native+="context.instrucciones["+i+']["microcode"]['+j+']["NATIVE_JIT"] =  function() {\n\t var fields = wepsim_native_get_fields("'+ins.signatureRaw+'");\n'+ins.microcode[j].NATIVE+"\n};\n "}}}eval(mk_native);var ret={};ret.error=null;ret.firmware=context.instrucciones;ret.labels_firm=context.etiquetas;ret.mp={};ret.seg={};ret.registers=context.registers;ret.pseudoInstructions=context.pseudoInstructions;ret.stackRegister=context.stackRegister;return ret}function saveFirmware(a){var f="";for(var e=0;e<a.firmware.length;e++){f+=a.firmware[e].signatureRaw;f+=" {\n";if(typeof a.firmware[e].co!="undefined"){f+="\tco="+a.firmware[e].co+",\n"}if(typeof a.firmware[e].cop!="undefined"){f+="\tcop="+a.firmware[e].cop+",\n"}if(typeof a.firmware[e].nwords!="undefined"){f+="\tnwords="+a.firmware[e].nwords+",\n"}if(typeof a.firmware[e].fields!="undefined"){if(a.firmware[e].fields.length>0){for(var d=0;d<a.firmware[e].fields.length;d++){f+="\t"+a.firmware[e].fields[d].name+" = "+a.firmware[e].fields[d].type;f+="("+a.firmware[e].fields[d].startbit+","+a.firmware[e].fields[d].stopbit+")";if(a.firmware[e].fields[d].type=="address"){f+=a.firmware[e].fields[d].address_type}f+=",\n"}}}if(typeof a.firmware[e].microcode!="undefined"){var m=a.firmware[e]["mc-start"];if(a.firmware[e].name!="begin"){f+="\t{"}for(var d=0;d<a.firmware[e].microcode.length;d++){if(""!=a.firmware[e].microcomments[d]){f+="\n\t\t# "+a.firmware[e].microcomments[d]}if(typeof a.labels_firm[m]!="undefined"){f+="\n"+a.labels_firm[m]+":\t"}else{f+="\n\t\t"}f+="(";var g=0;for(var b in a.firmware[e].microcode[d]){if("MADDR"==b){var h=a.firmware[e].microcode[d][b];if(typeof a.labels_firm[h]=="undefined"){f+=b+"="+h.toString(2)+", "}else{f+=b+"="+a.labels_firm[h]+", "}continue}f+=b+"="+a.firmware[e].microcode[d][b].toString(2)+", ";g=1}if(g==1){f=f.substr(0,f.length-2)}f+="),";m++}f=f.substr(0,f.length-1);if(a.firmware[e].name!="begin"){f+="\n\t}"}}f+="\n}\n\n"}if((typeof a.registers!="undefined")&&(a.registers.length>0)){f+="registers\n{\n";for(var e=0;e<a.registers.length;e++){if(a.stackRegister==e){f+="\t"+e+"="+a.registers[e]+" (stack_pointer),\n"}else{f+="\t"+e+"="+a.registers[e]+",\n"}}f=f.substr(0,f.length-2);f+="\n}\n"}return f}function decode_instruction(d){var b=simhw_internalState("FIRMWARE");var e=d.substring(0,6);var g=d.substring(28,32);var a=null;for(var f in b.firmware){if(b.firmware[f].name=="begin"){continue}if((b.firmware[f].co==e)&&(typeof b.firmware[f].cop=="undefined")){a=b.firmware[f];break}if((b.firmware[f].co==e)&&(typeof b.firmware[f].cop!="undefined")&&(b.firmware[f].cop==g)){a=b.firmware[f];break}}return a}function decode_ram(){var e="\n";var b=simhw_internalState("MP");for(var a in b){var d=b[a].toString(2);d="00000000000000000000000000000000".substring(0,32-d.length)+d;e+="0x"+parseInt(a).toString(16)+":"+decode_instruction(d)+"\n"}return e}BYTE_LENGTH=8;WORD_BYTES=4;WORD_LENGTH=WORD_BYTES*BYTE_LENGTH;directives={};directives[".kdata"]={name:".kdata",kindof:"segment",size:0};directives[".ktext"]={name:".ktext",kindof:"segment",size:0};directives[".data"]={name:".data",kindof:"segment",size:0};directives[".text"]={name:".text",kindof:"segment",size:0};directives[".byte"]={name:".byte",kindof:"datatype",size:1};directives[".half"]={name:".half",kindof:"datatype",size:2};directives[".word"]={name:".word",kindof:"datatype",size:4};directives[".space"]={name:".space",kindof:"datatype",size:1};directives[".ascii"]={name:".ascii",kindof:"datatype",size:1};directives[".asciiz"]={name:".asciiz",kindof:"datatype",size:1};directives[".align"]={name:".align",kindof:"datatype",size:0};function get_datatype_size(a){if(typeof directives[a]=="undefined"){console.log("data type: "+a+" is not defined!!!\n");return 0}return directives[a].size}function isTokenKindOf(b,a){if(typeof directives[b]=="undefined"){return false}return(directives[b].kindof==a)}function is_directive(a){return(typeof directives[a]!="undefined")}function is_directive_segment(a){return isTokenKindOf(a,"segment")}function is_directive_datatype(a){return isTokenKindOf(a,"datatype")}function isDecimal(b){if(b.length>1&&b[0]=="0"){return false}if(!isNaN(parseFloat(b))&&isFinite(b)){var a=parseInt(b);if(typeof b=="string"&&b.includes(".")){alert("Truncating conversion has occurred: "+b+" became "+a)}return a}return false}function isOctal(d){if(d.substring(0,1)=="0"){var b=d.substring(1).replace(/\b0+/g,"");var a=parseInt(b,8);return(a.toString(8)===b)?a:false}return false}function isHex(d){if(d.substring(0,2).toLowerCase()=="0x"){var b=d.substring(2).toLowerCase().replace(/\b0+/g,"");if(b==""){b="0"}var a=parseInt(b,16);return(a.toString(16)===b)?a:false}return false}function isChar(d){var b=treatControlSequences(d);if(true==b.error){return false}var a=b.string;if(a[0]=="'"&&a[2]=="'"){return a.charCodeAt(1)}return false}function decimal2binary(d,b){var a=d.toString(2);if(a.length>WORD_LENGTH){return[a,b-a.length]}a=(d>>>0).toString(2);if(d>=0){return[a,b-a.length]}a="1"+a.replace(/^[1]+/g,"");if(a.length>b){return[a,b-a.length]}a="1".repeat(b-a.length)+a;return[a,b-a.length]}function isValidTag(a){if(!(isDecimal(a[0])===false)){return false}var b=/[^a-z,_\d]/i;return !(b.test(a))}function sum_array(b){return b.reduce(function(e,d){return e+d},0)}function get_candidate(g,a){var e=false;var f={};var h={};for(b=0;b<g.length;b++){if(g[b]){f[b]=a[b].nwords;h[a[b].signature]=0}}if(Object.keys(h).length==1){var d=false;for(var b in f){if(d==false){d=f[b];e=b}else{if(d==f[b]){e=false}else{if(d>f[b]){d=f[b];e=b}}}}}return e?parseInt(e):e}function reset_assembly(a){return"0".repeat(WORD_LENGTH*a)}function assembly_replacement(g,d,e,b,a){var f=g.substring(0,g.length-e+a);g=f+d+g.substring(g.length-b);return g}function assembly_co_cop(d,a,b){if(a!==false){d=assembly_replacement(d,a,WORD_LENGTH,WORD_LENGTH-6,0)}if(b!==false){d=assembly_replacement(d,b,4,0,0)}return d}function writememory_and_reset(b,d,a){if(d.byteWord>=WORD_BYTES){b["0x"+d.seg_ptr.toString(16)]=d.machineCode;d.seg_ptr=d.seg_ptr+WORD_BYTES;d.byteWord=0;d.machineCode=reset_assembly(a)}}function is_end_of_file(a){return""===getToken(a)&&a.t>=a.text.length}function treatControlSequences(a){var b={};b.string="";b.error=false;for(var d=0;d<a.length;d++){if("\\"!=a[d]){b.string=b.string+a[d];continue}d++;switch(a[d]){case"b":b.string=b.string+"\b";break;case"f":b.string=b.string+"\f";break;case"n":b.string=b.string+"\n";break;case"r":b.string=ret_string+"\r";break;case"t":b.string=b.string+"\t";break;case"v":b.string=b.string+"\v";break;case"a":b.string=b.string+String.fromCharCode(7);break;case"'":b.string=b.string+"'";break;case'"':b.string=b.string+'"';break;case"0":b.string=b.string+"\0";break;default:b.string="Unknown escape char '\\"+a[d]+"'";b.error=true;return b}}return b}function read_data(b,q,m){var k=getToken(b);var g={};g.byteWord=0;g.machineCode=reset_assembly(1);g.seg_ptr=m.seg[k].begin;nextToken(b);while(!is_directive_segment(getToken(b))&&!is_end_of_file(b)){var s="";while(!is_directive_datatype(getToken(b))&&!is_end_of_file(b)){s=getToken(b);if("TAG"!=getTokenType(b)){return langError(b,"Expected tag or directive but found '"+s+"' instead")}var u=s.substring(0,s.length-1);if(!isValidTag(u)){return langError(b,"A tag must follow an alphanumeric format (starting with a letter or underscore) but found '"+u+"' instead")}if(b.firmware[u]){return langError(b,"A tag can not have the same name as an instruction ("+u+")")}if(m.labels2[u]){return langError(b,"Repeated tag: '"+u+"'")}m.labels2[u]="0x"+(g.seg_ptr+g.byteWord).toString(16);nextToken(b)}if(is_end_of_file(b)){break}var d=getToken(b);if((".word"==d)||(".half"==d)||(".byte"==d)){nextToken(b);var f=getToken(b);while(!is_directive(getToken(b))&&!is_end_of_file(b)){var e;var n=false;if((e=isOctal(f))!==false){}else{if((e=isHex(f))!==false){}else{if((e=isDecimal(f))!==false){}else{if((e=isChar(f))!==false){}else{if(".word"==d){if(!isValidTag(f)){return langError(b,"A tag must follow an alphanumeric format (starting with a letter or underscore) but found '"+f+"' instead")}if(b.firmware[f]){return langError(b,"A tag can not have the same name as an instruction ("+f+")")}e=0;n=true}else{return langError(b,"Expected value for numeric datatype but found '"+f+"' instead")}}}}}var t=get_datatype_size(d);var p=decimal2binary(e,t*BYTE_LENGTH);num_bits=p[0];free_space=p[1];if(free_space<0){return langError(b,"Expected value that fits in a '"+d+"' ("+t*BYTE_LENGTH+" bits), but inserted '"+f+"' ("+num_bits.length+" bits) instead")}writememory_and_reset(m.mp,g,1);while(((g.seg_ptr+g.byteWord)%t)!=0){g.byteWord++;writememory_and_reset(m.mp,g,1)}if(""!=s){m.labels2[s.substring(0,s.length-1)]="0x"+(g.seg_ptr+g.byteWord).toString(16);s=""}if(n){m.labels["0x"+g.seg_ptr.toString(16)]={name:f,addr:g.seg_ptr,startbit:31,stopbit:0,rel:undefined,nwords:1,labelContext:getLabelContext(b)}}g.machineCode=assembly_replacement(g.machineCode,num_bits,BYTE_LENGTH*(t+g.byteWord),BYTE_LENGTH*g.byteWord,free_space);g.byteWord+=t;nextToken(b);if(","==getToken(b)){nextToken(b)}if(is_directive(getToken(b))||("TAG"==getTokenType(b))||"."==getToken(b)[0]){break}f=getToken(b)}}else{if(".space"==d){nextToken(b);var f=getToken(b);if(!isDecimal(f)){return langError(b,"Expected number of bytes to reserve in .space but found '"+f+"' as number")}if(f<0){return langError(b,"Expected positive number but found '"+f+"' as positive number")}for(i=0;i<f;i++){writememory_and_reset(m.mp,g,1);g.byteWord++}nextToken(b)}else{if(".align"==d){nextToken(b);var f=getToken(b);if(!isDecimal(f)&&f>=0){return langError(b,"Expected the align parameter as positive number but found '"+f+"'. Remember that number is the power of two for alignment, see MIPS documentation..")}writememory_and_reset(m.mp,g,1);var h=Math.pow(2,parseInt(f));switch(h){case 1:break;case 2:if(g.byteWord&1==1){g.byteWord++}break;default:while(true){writememory_and_reset(m.mp,g,1);if(g.seg_ptr%h==0&&g.byteWord==0){break}g.byteWord++}}nextToken(b)}else{if(".ascii"==d||".asciiz"==d){nextToken(b);var f=getToken(b);var o=treatControlSequences(f);if(true==o.error){return langError(b,o.string)}f=o.string;while(!is_directive(getToken(b))&&!is_end_of_file(b)){writememory_and_reset(m.mp,g,1);if(""==f){return langError(b,"String is not closed (forgot to end it with quotation marks)")}if("STRING"!=getTokenType(b)){return langError(b,"Expected string between quotation marks but found '"+f+"' instead")}for(i=0;i<f.length;i++){writememory_and_reset(m.mp,g,1);if(f[i]=='"'){continue}num_bits=f.charCodeAt(i).toString(2);g.machineCode=assembly_replacement(g.machineCode,num_bits,BYTE_LENGTH*(1+g.byteWord),BYTE_LENGTH*g.byteWord,BYTE_LENGTH-num_bits.length);g.byteWord++}if(".asciiz"==d){writememory_and_reset(m.mp,g,1);num_bits="\0".charCodeAt(0).toString(2);g.machineCode=assembly_replacement(g.machineCode,num_bits,BYTE_LENGTH*(1+g.byteWord),BYTE_LENGTH*g.byteWord,BYTE_LENGTH-num_bits.length);g.byteWord++}nextToken(b);if(","==getToken(b)){nextToken(b)}if(is_directive(getToken(b))||("TAG"==getTokenType(b))||"."==getToken(b)[0]){break}f=getToken(b);o=treatControlSequences(f);if(true==o.error){return langError(b,o.string)}f=o.string}}else{return langError(b,"Unexpected datatype name '"+d)}}}}}if(g.byteWord>0){m.mp["0x"+g.seg_ptr.toString(16)]=g.machineCode;g.seg_ptr=g.seg_ptr+WORD_BYTES}m.seg[k].end=g.seg_ptr}function read_text(S,b,E){var H=getToken(S);var g=E.seg[H].begin;var D=S.firmware;var y=S.pseudoInstructions;var v=false;var e=-1;var R={};for(i=0;i<b.registers.length;i++){var n="$"+i;R[n]=i;R[b.registers[i]]=R[n]}nextToken(S);while(!is_directive_segment(getToken(S))&&!is_end_of_file(S)){while(!v&&typeof D[getToken(S)]=="undefined"&&!is_end_of_file(S)){var d=getToken(S);if("TAG"!=getTokenType(S)){return langError(S,"Expected tag or instruction but found '"+d+"' instead")}var M=d.substring(0,d.length-1);if(!isValidTag(M)){return langError(S,"A tag must follow an alphanumeric format (starting with a letter or underscore) but found '"+M+"' instead")}if(D[M]){return langError(S,"A tag can not have the same name as an instruction ("+M+")")}if(E.labels2[M]){return langError(S,"Repeated tag: '"+M+"'")}E.labels2[M]="0x"+g.toString(16);nextToken(S)}if(is_end_of_file(S)){break}if(!v){var x=getToken(S);var m=[]}else{var x=m[N][e++]}var O=[];var a=[];var k=[];var Q=0;var L=[];for(i=0;i<D[x].length;i++){O[i]=D[x][i].signature.split(",");a[i]=D[x][i].signatureUser.split(" ");O[i].shift();a[i].shift();k[i]=1;L[i]=[];Q=Math.max(Q,O[i].length);if(y[x]){m[i]=D[x][i].finish.replace(/ ,/g,"").replace(/num/g,"inm").split(" ");m[i].pop();v=true;var P=0;var u={}}}var K=[];K[0]=x;for(i=0;i<Q;i++){if(e==-1){nextToken(S);if(","==getToken(S)){nextToken(S)}var J=getToken(S)}else{var G=m[N][e++];if(u[G]){var J=u[G]}else{var J=G}}var I;if("TAG"!=getTokenType(S)&&!D[J]){K[i+1]=J}for(j=0;j<k.length;j++){if(k[j]==0){continue}if(i>=O[j].length){if("TAG"!=getTokenType(S)&&!D[J]){k[j]=0}continue}var h=D[x][j].fields[i];var f=h.startbit-h.stopbit+1;var w=false;var p=false;switch(h.type){case"address":case"inm":if(v&&"sel"==J){e++;var A=m[N][e++];var q=m[N][e++];var J=u[m[N][e++]];e++;p=true}if((I=isOctal(J))!==false){}else{if((I=isHex(J))!==false){}else{if((I=isDecimal(J))!==false){}else{if((I=isChar(J))!==false){}else{if((J[0]=="'")){var B="Unexpected inmediate value, found: '"+J+"' instead";k[j]=0;break}if(!isValidTag(J)){var B="A tag must follow an alphanumeric format (starting with a letter or underscore) but found '"+J+"' instead";k[j]=0;break}if(D[J]){var B="A tag can not have the same name as an instruction ("+J+")";k[j]=0;break}w=true}}}}if(p){F=decimal2binary(I,WORD_LENGTH);if(F[1]<0){return langError(S,"'"+J+"' is bigger than "+WORD_LENGTH+" bits")}I="0".repeat(F[1])+F[0];I=I.substring(WORD_LENGTH-A-1,WORD_LENGTH-q);I=parseInt(I,2);K[i+1]="0x"+I.toString(16)}if(!w){var F=decimal2binary(I,f);if(h.type=="address"&&"rel"==h.address_type){F=decimal2binary(I-g-WORD_BYTES,f)}}break;case"reg":var n=false;if("("==J){if("(reg)"!=O[j][i]){var B="Expected register but found register beween parenthesis";k[j]=0;break}if(e==-1){nextToken(S);J=getToken(S)}else{J=u[m[N][e++]]}n=true}else{if("(reg)"==O[j][i]){var B="Expected register between parenthesis but found '"+J+"' instead";k[j]=0;break}}if(typeof R[J]=="undefined"){var B="Expected register ($1, ...) but found '"+J+"' instead";k[j]=0;break}if(n){K[i+1]="("+J+")";if(e==-1){nextToken(S);n=getToken(S)}else{n=m[N][e++]}if(")"!=n){var B="String without end parenthesis ')'";k[j]=0;break}}I=isDecimal(R[J]);var F=decimal2binary(I,f);break;default:return langError(S,"An unknown error ocurred (1)")}if(k[j]==1&&!w){if(F[1]<0){if(h.type=="address"&&"rel"==h.address_type){B="Relative value ("+(I-g-WORD_BYTES)+" in decimal) needs "+F[0].length+" bits in binary but there is space for only "+f+" bits"}else{var B="'"+J+"' needs "+F[0].length+" bits in binary but there is space for only "+f+" bits"}k[j]=0}}if(k[j]==1&&(!(v&&e==-1))){L[j][i]={num_bits:(w?false:F[0]),free_space:(w?false:F[1]),startbit:h.startbit,stopbit:h.stopbit,rel:(w?h.address_type:false),islabel:w,field_name:J}}}if(sum_array(k)==0){break}if("TAG"==getTokenType(S)||D[J]){break}}var N;for(i=0;i<k.length;i++){if(k[i]==1){N=i}}var C="";for(i=0;i<D[x].length;i++){if(i>0&&i<D[x].length-1){C+=", "}if(i>0&&i==D[x].length-1){C+=" or "}C+="'"+D[x][i].signatureUser+"'"}var z=sum_array(k);if(z==0){if(k.length==1){return langError(S,B+". Remember that the instruction format has been defined as: "+C)}return langError(S,"Instruction and fields don't match with microprogram. Remember that the instruction formats have been defined as: "+C+". Please check the microcode. Probably you forgot to add a field, a number does not fit in its space, or you just used a wrong instruction")}if(z>1){N=get_candidate(k,D[x]);if(N===false){return langError(S,"Instruction and fields match with more than one microprogram. Please check the microcode. Currently, the instruction format can be: "+C)}}if(v){if(e==-1){var o="";for(i=0;i<K.length;i++){o=o+K[i]+" "}o=o.substring(0,o.length-1);for(i=0;i<O[N].length;i++){u[O[N][i]]=K[i+1]}e++;continue}else{P++}if(P>1){o="&nbsp;"}if(m[N][e]=="\n"){e++}}var t=reset_assembly(D[x][N].nwords);t=assembly_co_cop(t,D[x][N].co,D[x][N].cop);for(i=0;i<L[N].length;i++){if(L[N][i].islabel){E.labels["0x"+g.toString(16)]={name:L[N][i].field_name,addr:g,startbit:L[N][i].startbit,stopbit:L[N][i].stopbit,rel:L[N][i].rel,nwords:D[x][N].nwords,labelContext:getLabelContext(S)}}else{t=assembly_replacement(t,L[N][i].num_bits,L[N][i].startbit-(-1),L[N][i].stopbit,L[N][i].free_space)}}s_def=K[0];for(i=0,j=1;i<a[N].length;i++,j++){switch(a[N][i]){case"address":case"inm":case"reg":case"(reg)":s_def=s_def+" "+K[j];break;default:s_def=s_def+" "+K[j]+K[j+1];j++}}if(!v){var o=s_def}for(i=D[x][N].nwords-1;i>=0;i--){if(i<D[x][N].nwords-1){s_def="---"}E.assembly["0x"+g.toString(16)]={breakpoint:false,binary:t.substring(i*WORD_LENGTH,(i+1)*WORD_LENGTH),source:s_def,source_original:o};E.mp["0x"+g.toString(16)]=t.substring(i*WORD_LENGTH,(i+1)*WORD_LENGTH);g=g+WORD_BYTES}if(!v&&Q==O[N].length){nextToken(S)}if(v&&e==m[N].length){e=-1;P=0;v=false;nextToken(S)}if(S.t>=S.text.length){break}}E.seg[H].end=g}function simlang_compile(s,t){var d={};d.line=1;d.error=null;d.i=0;d.contadorMC=0;d.etiquetas={};d.labelsNotFound=[];d.instrucciones=[];d.co_cop={};d.registers=[];d.text=s;d.tokens=[];d.token_types=[];d.t=0;d.newlines=[];d.pseudoInstructions=[];d.stackRegister=null;d.firmware={};d.pseudoInstructions={};d.comments=[];for(i=0;i<t.firmware.length;i++){var e=t.firmware[i];if(typeof d.firmware[e.name]=="undefined"){d.firmware[e.name]=[]}d.firmware[e.name].push({name:e.name,nwords:parseInt(e.nwords),co:(typeof e.co!="undefined"?e.co:false),cop:(typeof e.cop!="undefined"?e.cop:false),fields:(typeof e.fields!="undefined"?e.fields:false),signature:e.signature,signatureUser:(typeof e.signatureUser!="undefined"?e.signatureUser:e.name),isPseudoinstruction:false})}for(i=0;i<t.pseudoInstructions.length;i++){var g=t.pseudoInstructions[i].initial;var o=t.pseudoInstructions[i].finish;if(typeof d.pseudoInstructions[g.name]=="undefined"){d.pseudoInstructions[g.name]=0;d.firmware[g.name]=[]}d.pseudoInstructions[g.name]++;d.firmware[g.name].push({name:g.name,fields:(typeof g.fields!="undefined"?g.fields:false),signature:g.signature,signatureUser:g.signature.replace(/,/g," "),finish:o.signature,isPseudoinstruction:true})}var h={};h.seg={".kdata":{name:".kdata",begin:0,end:255,color:"#FF99CC",kindof:"data"},".ktext":{name:".ktext",begin:256,end:4095,color:"#A9D0F5",kindof:"text"},".data":{name:".data",begin:4096,end:32767,color:"#FACC2E",kindof:"data"},".text":{name:".text",begin:32768,end:65280,color:"#BEF781",kindof:"text"},".stack":{name:".stack",begin:65535,end:65535,color:"#F1F2A3",kindof:"stack"}};h.mp={};h.labels={};h.labels2={};h.assembly={};data_found=false;text_found=false;nextToken(d);while(!is_end_of_file(d)){var f=getToken(d);if(typeof h.seg[f]=="undefined"){return langError(d,"Expected .data/.text/... segment but found '"+f+"' as segment")}if("data"==h.seg[f].kindof){read_data(d,t,h);data_found=true}if("text"==h.seg[f].kindof){read_text(d,t,h);text_found=true}if(d.error!=null){h.error=d.error;return h}}for(i in h.labels){var p=h.labels2[h.labels[i].name];if(typeof p==="undefined"){setLabelContext(d,h.labels[i].labelContext);return langError(d,"Label '"+h.labels[i].name+"' used but not defined in the assembly code")}var n="";var b=h.labels[i].addr;for(j=0;j<h.labels[i].nwords;j++){n=h.mp["0x"+b.toString(16)]+n;b+=WORD_BYTES}var u=h.labels[i].startbit-h.labels[i].stopbit+1;var q;if((q=isHex(p))!==false){var m=decimal2binary(q,u);num_bits=m[0];free_space=m[1];var k="'"+h.labels[i].name+"' needs "+num_bits.length+" bits in binary but there is space for only "+u+" bits";if("rel"==h.labels[i].rel){var m=decimal2binary(q-h.labels[i].addr-WORD_BYTES,u);num_bits=m[0];free_space=m[1];k="Relative value ("+(q-h.labels[i].addr-WORD_BYTES)+" in decimal) needs "+num_bits.length+" bits in binary but there is space for only "+u+" bits"}}else{return langError(d,"Unexpected error (2)")}if(free_space<0){setLabelContext(d,h.labels[i].labelContext);return langError(d,k)}n=assembly_replacement(n,num_bits,h.labels[i].startbit-(-1),h.labels[i].stopbit,free_space);b=h.labels[i].addr;for(j=h.labels[i].nwords-1;j>=0;j--){h.mp["0x"+b.toString(16)]=n.substring(j*WORD_LENGTH,(j+1)*WORD_LENGTH);b+=WORD_BYTES}}if(text_found){if((typeof h.labels2.main=="undefined")&&(typeof h.labels2.kmain=="undefined")){return langError(d,"Tags 'main' or 'kmain' are not defined in the text segment(s). It is compulsory to define at least one of those tags in order to execute a program")}}return h}var WSCFG={};WSCFG.version={value:"1.9.1",type:"string"};function get_cfg(a){return WSCFG[a].value}function set_cfg(b,a){WSCFG[b].value=a}function reset_cfg(){WSCFG.color_data_active={value:"#0066FF",type:"string"};WSCFG.color_data_inactive={value:"rgb(0, 0, 0)",type:"string"};WSCFG.color_name_active={value:"red",type:"string"};WSCFG.color_name_inactive={value:"rgb(0, 0, 0)",type:"string"};WSCFG.size_active={value:1.25,type:"float"};WSCFG.size_inactive={value:0.02,type:"float"};WSCFG.is_byvalue={value:false,type:"boolean"};WSCFG.RF_display_format={value:16,type:"int"};WSCFG.RF_display_name={value:"numerical",type:"string"};WSCFG.is_editable={value:true,type:"boolean"};WSCFG.DBG_delay={value:5,type:"int"};WSCFG.DBG_level={value:"instruction",type:"string"};WSCFG.DBG_limitins={value:10000,type:"int"};WSCFG.DBG_limitick={value:1000,type:"int"};WSCFG.ICON_theme={value:"classic",type:"string"};WSCFG.NOTIF_delay={value:1500,type:"int"};WSCFG.CPUCU_size={value:6,type:"int"};WSCFG.C1C2_size={value:8,type:"int"};WSCFG.is_interactive={value:true,type:"boolean"};WSCFG.ws_idiom={value:"en",type:"string"};WSCFG.ws_mode={value:"intro",type:"string"};WSCFG.use_voice={value:false,type:"boolean"};WSCFG.editor_theme={value:"default",type:"string"};WSCFG.editor_mode={value:"default",type:"string"};set_secondary_cfg()}function set_secondary_cfg(){cfg_show_eltos_delay=130;if(get_cfg("DBG_delay")<5){cfg_show_eltos_delay=390}cfg_show_rf_delay=125;if(get_cfg("DBG_delay")<5){cfg_show_rf_delay=375}cfg_show_main_memory_delay=150;if(get_cfg("DBG_delay")<5){cfg_show_main_memory_delay=450}cfg_show_control_memory_delay=120;if(get_cfg("DBG_delay")<5){cfg_show_control_memory_delay=360}cfg_show_asmdbg_pc_delay=50;if(get_cfg("DBG_delay")<3){cfg_show_asmdbg_pc_delay=200}cfg_show_dbg_ir_delay=100;if(get_cfg("DBG_delay")<5){cfg_show_dbg_ir_delay=300}cfg_show_rf_refresh_delay=30;if(get_cfg("DBG_delay")<5){cfg_show_rf_refresh_delay=120}}function save_cfg(){try{for(var b in WSCFG){localStorage.setItem("wepsim_"+b,get_cfg(b))}}catch(a){console.log("WepSIM can not save the configuration in a persistent way on this web browser, found error: \n"+a.message)}set_secondary_cfg()}function restore_cfg(){reset_cfg();for(var b in WSCFG){if(b=="version"){continue}try{set_cfg(b,localStorage.getItem("wepsim_"+b));if(WSCFG[b].type!="string"){set_cfg(b,JSON.parse(get_cfg(b)))}if(get_cfg(b)==null){throw"null values discarted"}}catch(a){console.log("WepSIM can not restore the configuration on this web browser, found error: \n"+a.message);reset_cfg();return}}set_secondary_cfg()}function get_simware(){var a=simhw_internalState("FIRMWARE");if(typeof a.firmware=="undefined"){a.firmware=new Array()}if(typeof a.mp=="undefined"){a.mp=new Object()}if(typeof a.seg=="undefined"){a.seg=new Object()}if(typeof a.assembly=="undefined"){a.assembly=new Object()}if(typeof a.labels=="undefined"){a.labels=new Object()}if(typeof a.labels2=="undefined"){a.labels2=new Object()}if(typeof a.labels_firm=="undefined"){a.labels_firm=new Object()}if(typeof a.registers=="undefined"){a.registers=new Object()}if(typeof a.cihash=="undefined"){a.cihash=new Object()}if(typeof a.pseudoInstructions=="undefined"){a.pseudoInstructions=new Object()}if(typeof a.stackRegister=="undefined"){a.stackRegister=new Object()}return a}function set_simware(b){var a=simhw_internalState("FIRMWARE");if(typeof b.firmware!="undefined"){a.firmware=b.firmware}if(typeof b.mp!="undefined"){a.mp=b.mp}if(typeof b.registers!="undefined"){a.registers=b.registers}if(typeof b.cihash!="undefined"){a.cihash=b.cihash}if(typeof b.assembly!="undefined"){a.assembly=b.assembly}if(typeof b.pseudoInstructions!="undefined"){a.pseudoInstructions=b.pseudoInstructions}if(typeof b.seg!="undefined"){a.seg=b.seg}if(typeof b.labels!="undefined"){a.labels=b.labels}if(typeof b.labels2!="undefined"){a.labels2=b.labels2}if(typeof b.labels_firm!="undefined"){a.labels_firm=b.labels_firm}if(typeof b.stackRegister!="undefined"){a.stackRegister=b.stackRegister}}function check_buses(h){var f=simhw_internalState("tri_state_names");if(simhw_internalState_get("fire_visible","databus")==true){var k=document.getElementById("svg_p");if(k!=null){k=k.contentDocument}if(k!=null){k=k.getElementById("databus_fire")}if(k!=null){k.setAttributeNS(null,"visibility","hidden")}simhw_internalState_set("fire_visible","databus",false)}if((simhw_sim_signal("TD").value!=0)&&(simhw_sim_signal("R").value!=0)){var k=document.getElementById("svg_p");if(k!=null){k=k.contentDocument}if(k!=null){k=k.getElementById("databus_fire")}if(k!=null){k.setAttributeNS(null,"visibility","visible")}simhw_internalState_set("fire_visible","databus",true);simhw_sim_state("BUS_DB").value=4294967295}if(f.indexOf(h)==-1){return}var a="";var e=0;var g="";var d=0;for(var b=0;b<f.length;b++){g=f[b];d=parseInt(get_value(simhw_sim_signal(g)));e+=d;if(d>0){a=g}if(e>1){break}}if(e>0){update_draw(simhw_sim_signal(a),1)}if(simhw_internalState_get("fire_visible","internalbus")==true){var k=document.getElementById("svg_p");if(k!=null){k=k.contentDocument}if(k!=null){k=k.getElementById("internalbus_fire")}if(k!=null){k.setAttributeNS(null,"visibility","hidden")}simhw_internalState_set("fire_visible","internalbus",false)}if(e>1){var k=document.getElementById("svg_p");if(k!=null){k=k.contentDocument}if(k!=null){k=k.getElementById("internalbus_fire")}if(k!=null){k.setAttributeNS(null,"visibility","visible")}simhw_internalState_set("fire_visible","internalbus",true);simhw_sim_state("BUS_IB").value=4294967295}}function fn_updateE_now(a){if("E"==simhw_sim_signal(a).type){update_state(a)}}function fn_updateE_future(a){if(jit_fire_ndep[a]<1){fn_updateE_now(a)}else{return new Promise(function(d,b){fn_updateE_now(a)})}}function fn_updateL_now(a){update_draw(simhw_sim_signal(a),simhw_sim_signal(a).value);if("L"==simhw_sim_signal(a).type){update_state(a)}}function fn_updateL_future(a){if(jit_fire_ndep[a]<1){fn_updateL_now(a)}else{return new Promise(function(d,b){fn_updateL_now(a)})}}function update_state(b){var a=0;switch(simhw_sim_signal(b).behavior.length){case 0:return;break;case 1:a=0;break;default:a=simhw_sim_signal(b).value;if(simhw_sim_signal(b).behavior.length<a){alert("ALERT: there are more signals values than behaviors defined!!!!\nkey: "+b+" and signal value: "+a);return}break}compute_signal_behavior(b,a)}function show_memories_values(){var a=new Promise(function(e,d){show_main_memory(simhw_internalState("MP"),get_value(simhw_sim_state("REG_PC")),true,true);e(1)});var b=new Promise(function(e,d){show_control_memory(simhw_internalState("MC"),simhw_internalState("MC_dashboard"),get_value(simhw_sim_state("REG_MICROADDR")),true);e(1)});Promise.all([a,b])}function update_signal_firmware(d){var a=get_simware();var g=-1;for(var b=0;b<a.firmware.length;b++){if(parseInt(a.firmware[b]["mc-start"])>get_value(simhw_sim_state("REG_MICROADDR"))){break}g=b}if(-1==g){alert("A new 'unknown' instruction is inserted,\nplease edit it (co, nwords, etc.) in the firmware textarea.");var e=new Object();e.name="unknown";e.signature="unknown";e.signatureGlobal="unknown";e.co=0;e.nwords=0;e["mc-start"]=0;e.fields=new Array();e.microcode=new Array();e.microcomments=new Array();a.firmware.push(e);g=a.firmware.length-1}var h=get_value(simhw_sim_state("REG_MICROADDR"))-parseInt(a.firmware[g]["mc-start"]);if(typeof a.firmware[g]["microcode"][h]=="undefined"){a.firmware[g]["microcode"][h]=new Object();a.firmware[g]["microcomments"][h]=""}a.firmware[g]["microcode"][h][d]=simhw_sim_signal(d).value;if(simhw_sim_signal(d).default_value==simhw_sim_signal(d).value){delete a.firmware[g]["microcode"][h][d]}var f=get_value(simhw_sim_state("REG_IR")).toString(2);f="00000000000000000000000000000000".substring(0,32-f.length)+f;show_memories_values()}function update_signal_loadhelp(a,d){var b="help/signals-"+get_cfg("ws_idiom")+".html #"+d;$(a).load(b,function(f,e,g){if($(a).html()==""){$(a).html("<br>Sorry, No more details available for this signal.<p>\n")}$(a).trigger("create")});ga("send","event","help","help.signal","help.signal."+d)}function update_signal(b){if(false===get_cfg("is_interactive")){return}for(var s in simhw_sim_signals()){for(var f=0;f<simhw_sim_signal(s).fire_name.length;f++){var a=simhw_sim_signal(s).fire_name[f].split(":");if(a[1]==b.currentTarget.id){var p=(simhw_sim_signal(s).value>>>0);var q="";var g="";var o="";var t=new Array();var d=0;var m=Math.pow(2,simhw_sim_signal(s).nbits);if(simhw_sim_signal(s).behavior.length==m){for(var e=0;e<simhw_sim_signal(s).behavior.length;e++){if(e==p){g=' checked="checked" '}else{g=" "}t=simhw_sim_signal(s).behavior[e].split(";");if(simhw_sim_signal(s).default_value!=e){q=t[0]}else{q="<b>"+t[0]+"</b>"}d=simhw_sim_signal(s).behavior[e].indexOf(";");if(-1==d){d=simhw_sim_signal(s).behavior[e].length}q="&nbsp;"+q+'<span style="color:#CCCCCC">'+simhw_sim_signal(s).behavior[e].substring(d)+"</span>";d=e.toString(10);o+='<li><label><input aria-label="value '+d+'" type="radio" name="ask_svalue"        value="'+d+'" '+g+" />"+q+"</label></li>"}}else{o+='<div><center><label><input aria-label="value for '+s+'" type="number" size=4 min=0 max='+(m-1)+' class=dial        name="ask_svalue" value="'+simhw_sim_signal(s).value+'"/>&nbsp;&nbsp; 0 - '+(m-1)+"</center></label></div>\n"}var h=bootbox.dialog({title:"<center>"+s+':  <div class="btn-group">   <button onclick="$(\'#bot_signal\').carousel(0);"            type="button" class="btn btn-info">Value</button>   <button onclick="$(\'#bot_signal\').carousel(1); update_signal_loadhelp(\'#help2\',$(\'#ask_skey\').val());"            type="button" class="btn btn-success">Help</button>   <button type="button" class="btn btn-success dropdown-toggle dropdown-toggle-split"            data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">     <span class="caret"></span>     <span class="sr-only">Toggle Help Idiom</span>   </button>   <div class="dropdown-menu">        <a href="#" class="dropdown-item"                     onclick="set_cfg(\'ws_idiom\',\'es\'); save_cfg(); $(\'#bot_signal\').carousel(1);                              update_signal_loadhelp(\'#help2\',$(\'#ask_skey\').val());"         >ES<span class="d-none d-sm-inline-flex">&nbsp;(Spanish)</span></a>        <a href="#" class="dropdown-item"                     onclick="set_cfg(\'ws_idiom\',\'en\'); save_cfg(); $(\'#bot_signal\').carousel(1);                              update_signal_loadhelp(\'#help2\',$(\'#ask_skey\').val());"         >EN<span class="d-none d-sm-inline-flex">&nbsp;(English)</span></a>   </div> </div></center>',message:'<div id="bot_signal" class="carousel slide" data-ride="carousel" data-interval="false">  <div class="carousel-inner" role="listbox">    <div class="carousel-item active">         <div style="max-height:70vh; width:inherit; overflow:auto; -webkit-overflow-scrolling:touch;">         <form class="form-horizontal" style="white-space:nowrap;">         <input aria-label="value for '+s+'" id="ask_skey" name="ask_skey" type="hidden" value="'+s+'" class="form-control input-md">          <ol start="0">'+o+'         </ol>         </form>         </div>    </div>    <div class="carousel-item">         <div id=help2 style="max-height:65vh; width:inherit; overflow:auto; -webkit-overflow-scrolling:touch;">Loading...</div>    </div>  </div></div>',value:simhw_sim_signal(s).value,animate:false,size:"large",buttons:{success:{label:"Save",className:"btn-primary btn-sm col-xs-3 col-sm-2 float-right",callback:function(){s=$("#ask_skey").val();user_input=$("input[name='ask_svalue']:checked").val();if(typeof user_input=="undefined"){user_input=$("input[name='ask_svalue']").val()}simhw_sim_signal(s).value=user_input;if(true===get_cfg("is_interactive")){if(simhw_sim_signal(s).value!=simhw_sim_signal(s).default_value){simhw_sim_state("REG_MICROINS").value[s]=simhw_sim_signal(s).value}else{delete (simhw_sim_state("REG_MICROINS").value[s])}var n=get_value(simhw_sim_state("REG_MICROADDR"));if(typeof simhw_internalState_get("MC",n)=="undefined"){simhw_internalState_set("MC",n,new Object());simhw_internalState_set("MC_dashboard",n,new Object())}simhw_internalState_get("MC",n)[s]=simhw_sim_signal(s).value;simhw_internalState_get("MC_dashboard",n)[s]={comment:"",breakpoint:false,state:false,notify:new Array()};update_signal_firmware(s);var k=get_simware();document.getElementById("inputFirmware").value=saveFirmware(k)}compute_behavior("FIRE "+s)}},close:{label:"Close",className:"btn-danger btn-sm col-xs-3 col-sm-2 float-right",callback:function(){}}}});h.find(".modal-title").addClass("mx-auto");$(".dial").knob({min:0,max:(m-1)}).val(simhw_sim_signal(s).value).trigger("change")}}}show_states();show_rf_values()}function update_nzvc(d,a,e,b){set_value(simhw_sim_state("FLAG_N"),d);set_value(simhw_sim_state("FLAG_Z"),a);set_value(simhw_sim_state("FLAG_V"),e);set_value(simhw_sim_state("FLAG_C"),b);set_value(simhw_sim_signal("TEST_N"),d);set_value(simhw_sim_signal("TEST_Z"),a);set_value(simhw_sim_signal("TEST_V"),e);set_value(simhw_sim_signal("TEST_C"),b)}function update_memories(u){set_simware(u);var f=get_simware();simhw_internalState_reset("MC",{});simhw_internalState_reset("MC_dashboard",{});for(var s=0;s<f.firmware.length;s++){var t=false;var m=false;var o=new Array();var h=f.firmware[s]["microcode"].length;var q=f.firmware[s]["mc-start"];for(var p=0;p<h;p++){var b=f.firmware[s]["microcomments"][p];t=(b.trim().split("state:").length>1);m=(b.trim().split("break:").length>1);o=b.trim().split("notify:");for(var n=0;n<o.length;n++){o[n]=o[n].split("\n")[0]}simhw_internalState_set("MC",q,f.firmware[s]["microcode"][p]);simhw_internalState_set("MC_dashboard",q,{comment:b,state:t,breakpoint:m,notify:o});q++}}simhw_internalState_reset("ROM",{});for(var s=0;s<f.firmware.length;s++){if("begin"==f.firmware[s]["name"]){continue}var a=f.firmware[s]["mc-start"];var g=parseInt(f.firmware[s]["co"],2);var e=0;if(typeof f.firmware[s]["cop"]!="undefined"){e=parseInt(f.firmware[s]["cop"],2)}var d=64*g+e;simhw_internalState_set("ROM",d,a);f.cihash[d]=f.firmware[s]["signature"]}simhw_internalState_reset("MP",{});for(var x in f.mp){var v=parseInt(x);var w=parseInt(f.mp[x].replace(/ /g,""),2);simhw_internalState_set("MP",v,w)}simhw_internalState_reset("segments",{});for(var x in f.seg){simhw_internalState_set("segments",x,f.seg[x])}show_main_memory(simhw_internalState("MP"),0,true,true);show_control_memory(simhw_internalState("MC"),simhw_internalState("MC_dashboard"),0,true)}function obj_draw(a,g,k,e,f,d){var b=a.split(":");var h=document.getElementById(b[0]);if(h==null){return}h=h.contentDocument;if(h==null){return}h=h.getElementById(b[1]);if(h==null){return}if(g){h.style.setProperty("stroke",k,"");h.style.setProperty("fill",k,"");h.style.setProperty("stroke-width",f,"")}else{if(h.style.getPropertyValue("stroke")==e){return}h.style.setProperty("stroke",e,"");h.style.setProperty("fill",e,"");h.style.setProperty("stroke-width",d,"")}}var DRAW_stop=false;function start_drawing(){DRAW_stop=false}function stop_drawing(){DRAW_stop=true}function is_drawing(){return DRAW_stop}function update_draw(g,f){if(true==DRAW_stop){return}var h=get_cfg("is_byvalue");if(typeof simhw_sim_state("REG_MICROINS").value[g.name]!="undefined"){h=true}if((false==h)&&(typeof g.depends_on!="undefined")){for(var b=0;b<g.depends_on.length;b++){var a=g.depends_on[b];if(typeof simhw_sim_state("REG_MICROINS").value[a]!="undefined"){h=true;break}else{if("CLK"==a){h=true;break}}}}if(g.draw_data.length>1){for(var e=0;e<g.draw_data.length;e++){for(var d=0;d<g.draw_data[e].length;d++){obj_draw(g.draw_data[e][d],(e==f)&&h,get_cfg("color_data_active"),get_cfg("color_data_inactive"),get_cfg("size_active"),get_cfg("size_inactive"))}}}else{if(g.nbits==1){for(var d=0;d<g.draw_data[0].length;d++){obj_draw(g.draw_data[0][d],(0!=f)&&h,get_cfg("color_data_active"),get_cfg("color_data_inactive"),get_cfg("size_active"),get_cfg("size_inactive"))}}else{if(g.draw_data.length==1){for(var d=0;d<g.draw_data[0].length;d++){obj_draw(g.draw_data[0][d],h,get_cfg("color_data_active"),get_cfg("color_data_inactive"),get_cfg("size_active"),get_cfg("size_inactive"))}}}}if(g.draw_name.length>1){for(var e=0;e<g.draw_name.length;e++){for(var d=0;d<g.draw_name[e].length;d++){obj_draw(g.draw_name[e][d],(e==f)&&h,get_cfg("color_name_active"),get_cfg("color_name_inactive"),get_cfg("size_active"),get_cfg("size_inactive"))}}}else{if(g.nbits==1){for(var d=0;d<g.draw_name[0].length;d++){obj_draw(g.draw_name[0][d],(0!=f)&&h,get_cfg("color_name_active"),get_cfg("color_name_inactive"),get_cfg("size_active"),get_cfg("size_inactive"))}}else{if(g.draw_name.length==1){for(var d=0;d<g.draw_name[0].length;d++){obj_draw(g.draw_name[0][d],h,get_cfg("color_name_active"),get_cfg("color_name_inactive"),get_cfg("size_active"),get_cfg("size_inactive"))}}}}}function refresh(){for(var a in simhw_sim_signals()){update_draw(simhw_sim_signals()[a],simhw_sim_signals()[a].value);check_buses(a)}show_dbg_ir(get_value(simhw_sim_state("REG_IR_DECO")))}function simcoreui_notify(g,h,a,b){var e=$("#alerts-container");if(e.length==0){e=$('<div id="alerts-container"      style="position: fixed; width: 50%; left: 25%; top: 10%; z-index:256;">');$("body").append(e)}var d=$('<button type="button" class="close" data-dismiss="alert">');var f=$('<div class="alert alert-'+a+'">');e.prepend(f.append(d.append("&times;")).append(h));if(b!=0){window.setTimeout(function(){f.alert("close")},b)}}function simcoreui_notify_close(){$(".alert").alert("close")}function hex2float(d){var a=(d&2147483648)?-1:1;var f=((d>>23)&255)-127;var b=1+((d&8388607)/8388608);var e=a*b*Math.pow(2,f);if(-127==f){if(1==b){e=(a==1)?"+0":"-0"}else{e=a*((d&8388607)/8388607)*Math.pow(2,-126)}}if(128==f){if(1==b){e=(a==1)?"+Inf":"-Inf"}else{e="NaN"}}return e}function hex2char8(a){var b=new Array();b[0]=String.fromCharCode((a&4278190080)>>24);b[1]=String.fromCharCode((a&16711680)>>16);b[2]=String.fromCharCode((a&65280)>>8);b[3]=String.fromCharCode((a&255)>>0);return b}function pack5(a){return"00000".substring(0,5-a.length)+a}function pack8(a){return"00000000".substring(0,8-a.length)+a}function pack32(a){return"00000000000000000000000000000000".substring(0,32-a.length)+a}function hex2bin(a){var b=a.toString(2);b=pack32(b);b=b.substring(0,4)+" "+b.substring(4,8)+" "+b.substring(8,12)+" "+b.substring(12,16)+" "+b.substring(16,20)+" "+b.substring(20,24)+" "+b.substring(24,28)+" "+b.substring(28,32);return b}function hex2values_update(a){var b=parseInt($("#popover1")[0].value);if(typeof simhw_sim_states()["BR"][a]!="undefined"){set_value(simhw_sim_states()["BR"][a],b);fullshow_rf_values();$("#rf"+a).click();$("#rf"+a).click()}if(typeof simhw_sim_states()[a]!="undefined"){if(1==simhw_sim_states()[a].nbits){b=b%2}set_value(simhw_sim_states()[a],b);fullshow_eltos(simhw_sim_states(),filter_states);$("#rp"+a).click();$("#rp"+a).click()}}function hex2values(o,m){var k=/[0-9A-F]{1,8}/gi;if(!k.test(o)){o=0}var f=o>>0;var n=o>>>0;var a=hex2char8(n);var h=hex2float(n);var d=hex2bin(n);var g=n.toString(16).toUpperCase();g="0x"+pack8(g);var b="";if(get_cfg("is_editable")==true){b="<tr><td colspan=5 align=center><input type=text id='popover1' value='"+n+"' data-mini='true' style='width:65%'>&nbsp;<span class='badge badge-secondary'       onclick='hex2values_update(\""+m+"\");'>update</span></td></tr>"}var e="<table width='100%' class='table table-bordered table-sm'><tr><td><small><b>hex.</b></small></td>    <td colspan=4><small>"+g+"</small></td></tr><tr><td><small><b>bin.</b></small></td>    <td colspan=4><small><font face='monospace'><b>"+d+"</b></font></smallspan></td></tr><tr><td><small><b>signed</b></small></td>    <td colspan=4><small>"+f+"</small></td></tr><tr><td><small><b>unsig.</b></small></td>    <td colspan=4><small>"+n+"</small></td></tr><tr><td width=30%><small><b>char</b></small></td>    <td width=15% align=center><small>"+a[0]+"</small></td>    <td width=15% align=center><small>"+a[1]+"</small></td>    <td width=15% align=center><small>"+a[2]+"</small></td>    <td width=15% align=center><small>"+a[3]+"</small></td></tr><tr><td><small><b>float</b></small></td>    <td colspan=4><small><font face='monospace'><b>"+h+"</b></font></small></td></tr>"+b+"</table>";return e}function init_rf(e){if(e==""){return}var a="";var d="";for(var b=0;b<simhw_sim_states()["BR"].length;b++){d="R"+b;if(b<10){d=d+'<span style="opacity: 0.0;">_</span>'}a+="<div class='col pb-1 px-1'><button type='button' class='btn py-0 px-0 ml-0'         style='width:inherit; border-color:#cecece; background-color:#f5f5f5' data-role='none'         data-toggle='popover-up' data-popover-content='"+b+"' data-container='body'         id='rf"+b+"'>  <span id='name_RF"+b+"' style='float:center; padding:0 0 0 0; color:black;'>"+d+"</span>  <span class='badge badge-secondary' style='background-color:#CEECF5; color:black;' id='tbl_RF"+b+"'>"+(get_value(simhw_sim_states()["BR"][b])>>>0).toString(get_cfg("RF_display_format")).toUpperCase()+"  </span></button></div>"}$(e).html("<div class='row justify-content-center'>"+a+"</div>");$("[data-toggle=popover-up]").popover({html:true,placement:"auto",animation:false,content:function(){var g=$(this).attr("data-popover-content");var f=get_value(simhw_sim_states()["BR"][g]);return hex2values(f,g)},title:function(){var f=$(this).attr("data-popover-content");var g="&quot;#rf"+f+"&quot;";return'<span class="text-info"><strong>R'+f+'</strong></span><button type="button" id="close" class="close"         onclick="$('+g+').click();">&times;</button>'}})}function fullshow_rf_values(){if(typeof document=="undefined"){return}var b=get_simware();for(var d=0;d<simhw_sim_states()["BR"].length;d++){var a=(get_value(simhw_sim_states()["BR"][d])>>>0).toString(get_cfg("RF_display_format")).toUpperCase();if(16==get_cfg("RF_display_format")){a=pack8(a)}$("#tbl_RF"+d).html(a)}}var show_rf_values_deferred=null;function innershow_rf_values(){fullshow_rf_values();show_rf_values_deferred=null}function show_rf_values(){if(null!=show_rf_values_deferred){return}show_rf_values_deferred=setTimeout(innershow_rf_values,cfg_show_rf_delay)}function show_rf_names(){if(typeof document=="undefined"){return}var b=get_simware();var a="";for(var d=0;d<simhw_sim_states()["BR"].length;d++){a="R"+d;if(d<10){a=a+'<span style="opacity: 0.0;">_</span>'}if("logical"==get_cfg("RF_display_name")){if(typeof b.registers[d]!="undefined"){a=b.registers[d]}}var e=document.getElementById("name_RF"+d);if(e!=null){e.innerHTML=a}}}function init_eltos(h,p,a,m){if(h==""){return}var f="";var e="";var d="";for(var k=0;k<a.length;k++){var q=a[k].split(",")[0];var g=p[q].name;if(p[q].nbits>1){e=g.substring(0,3);d=g.substring(3,g.length);if(d.length>0){g=e+'<span class="d-none d-sm-inline-flex">'+d+"</span>"}if(g.length<3){g=g+'<span style="opacity: 0.0;">_</span>'}}var o=a[k].split(",")[1];var n=m[o];f+="<div class='"+n+" pb-1 px-1'><button type='button' class='btn py-0 px-0 ml-1'         style='width:inherit; border-color:#cecece; background-color:#f5f5f5' data-role='none'         data-toggle='popover-bottom' data-popover-content='"+q+"' data-container='body'         id='rp"+q+"'>"+g+"<span class='badge badge-secondary' style='background-color:#CEECF5; color:black;' id='tbl_"+q+"'>"+p[q].value.toString(get_cfg("RF_display_format"))+"</span></button></div>"}$(h).html("<div class='row justify-content-center'>"+f+"</div>");$("[data-toggle=popover-bottom]").popover({html:true,placement:"bottom",animation:false,content:function(){var s=$(this).attr("data-popover-content");var b=get_value(simhw_sim_states()[s]);return hex2values(b,s)},title:function(){var b=$(this).attr("data-popover-content");var s="&quot;#rp"+b+"&quot;";return'<span class="text-info"><strong>'+simhw_sim_states()[b].name+'</strong></span><button type="button" id="close" class="close"         onclick="$('+s+').click();">&times;</button>'}})}function fullshow_eltos(h,d){if(typeof document=="undefined"){return}for(var b=0;b<d.length;b++){var e=d[b].split(",");var a=e[0];var f=h[a].value.toString(get_cfg("RF_display_format"));if(h[a].nbits>1){f=(simhw_sim_state(a).value>>>0).toString(get_cfg("RF_display_format")).toUpperCase();if(16==get_cfg("RF_display_format")){f=pack8(f)}}var g=document.getElementById("tbl_"+a);if(g!=null){g.innerHTML=f}}}var show_eltos_deferred=null;function show_eltos(b,a){if(null!=show_eltos_deferred){return}show_eltos_deferred=setTimeout(function(){fullshow_eltos(b,a);show_eltos_deferred=null},cfg_show_eltos_delay)}var filter_states=["REG_IR_DECO,0","REG_IR,1","REG_PC,1","REG_SR,1","REG_RT1,1","REG_RT2,1","REG_RT3,1","REG_MAR,1","REG_MBR,1","REG_MICROADDR,1"];var divclasses=["col-11","col"];function init_states(a){return init_eltos(a,simhw_sim_states(),filter_states,divclasses)}function show_states(){return show_eltos(simhw_sim_states(),filter_states)}function ko_observable(a){if(typeof ko!="undefined"){return ko.observable(a).extend({rateLimit:cfg_show_rf_refresh_delay})}else{return a}}function ko_rebind_state(d,e){if(typeof ko=="undefined"){return}var b=simhw_sim_state(d);if(typeof b.value!="function"){b.value=ko.observable(b.value).extend({rateLimit:cfg_show_rf_refresh_delay})}var a=document.getElementById(e);ko.cleanNode(a);ko.applyBindings(simhw_sim_state(d),a)}function init_io(f){var e=simhw_internalState("io_int_factory");if(f==""){for(var b=0;b<e.length;b++){e[b].accumulated=ko_observable(e[b].accumulated);e[b].active=ko_observable(e[b].active)}return}var d="<div class='col-12'><table class='table table-hover table-sm table-bordered'>";for(var b=0;b<e.length;b++){d+="<tr id='int"+b+"_context'><td align=center width=50%><span data-bind=\"style: {fontWeight: active() ? 'bold' : ''}\">Interrupt "+b+"</span></td><td align=center width=50%><span data-bind='text: accumulated'>&nbsp;</span></td></tr>"}d+="</table></div>";$(f).html("<div class='row'>"+d+"</div>");for(var b=0;b<e.length;b++){if(typeof e[b].accumulated!="function"){e[b].accumulated=ko_observable(e[b].accumulated)}if(typeof e[b].active!="function"){e[b].active=ko_observable(e[b].active)}var a=document.getElementById("int"+b+"_context");ko.cleanNode(a);ko.applyBindings(e[b],a)}}function init_cpu(b){if(b==""){simhw_sim_state("CLK").value=ko_observable(simhw_sim_state("CLK").value);simhw_sim_state("DECO_INS").value=ko_observable(simhw_sim_state("DECO_INS").value);return}var a="<div class='col-12'><table class='table table-hover table-sm table-bordered'><tr><td align=center width=50%>Instructions</td><td align=center width=50%><div id='ins_context'><span data-bind='text: value'>&nbsp;</span></div></td></tr><tr><td align=center width=50%>CLK ticks</td><td align=center width=50%><div id='clk_context'><span data-bind='text: value'>&nbsp;</span></div></td></tr></table></div>";$(b).html("<div class='row'>"+a+"</div>");ko_rebind_state("CLK","clk_context");ko_rebind_state("DECO_INS","ins_context")}function init_config_mp(d){if(d==""){simhw_internalState_reset("MP_wc",ko_observable(0));return}var b="<div class='container-fluid'><div class='row'>";b+="<div class='col-12' style='padding:0 0 10 0;'><div class='card bg-light'><div class='card-body' id='mempanel' style='padding:0 0 0 0;'><table class='table table-hover table-sm table-bordered'        style='margin:0'><tbody class='no-ui-mini'><tr><td align=center'>Wait cycles (<b>0</b> - &infin;)</td>    <td align=center'><div id='mp_wc'><input type=number data-bind='value: simhw_internalState(\"MP_wc\")' min='0' max='99999999'></div>    </td></tr></tbody></table></div></div></div>";$(d).html(b);simhw_internalState_reset("MP_wc",ko_observable(0));var a=document.getElementById("mp_wc");ko.applyBindings(simhw_internalState("MP_wc"),a)}function init_config_io(f){var e=simhw_internalState("io_int_factory");if(f==""){for(var b=0;b<e.length;b++){e[b].period=ko_observable(e[b].period);e[b].probability=ko_observable(e[b].probability)}return}var d="<div class='container-fluid'><div class='row'>";d+="<div class='col-12' style='padding:0 0 0 0;'><div class='card bg-light' style='margin:0 0 0 0;'><div class='card-body' id='iopanel' style='padding: 0 0 0 0'>";d+="<center><table class='table table-hover table-sm table-bordered'        style='margin:0'><tbody class='no-ui-mini'><tr><td align=center width='33%'>  <span class='d-none d-sm-inline-flex'>Interrupt identificator</span>  <span class='d-sm-none'>Int. Id.<br>(0 - 7)</span></td><td align=center width='33%'>  <span class='d-none d-sm-inline-flex'>CLK period (<b>0</b> - &infin;)</span>  <span class='d-sm-none'>CLK ticks <br>(<b>0</b> - &infin;)</span></td><td align=center width='33%'>  <span class='d-none d-sm-inline-flex'>Probability (0 - 1)</span>  <span class='d-sm-none'>Probability <br>(0 - 1)</span></td></tr>";for(var b=0;b<8;b++){d+="<tr><td align=center style='padding:0 0 0 0; vertical-align: middle !important'><span style='padding:0 0 0 0; margin:0 0 0 0'>"+b+"</span></td><td align=center style='padding:0 0 0 0'><div id='int"+b+"_per' style='margin:0 3 0 3'><input type=number data-bind='value: period' min='0' max='99999999'></div></td><td align=center style='padding:0 0 0 0'><div id='int"+b+"_pro' style='margin:0 3 0 3'><input type=number data-bind='value: probability' min='0' max='1' step='.05'></div></td></tr>"}d+="</tbody></table></center>";d+="</div></div></div>";$(f).html(d);for(var b=0;b<e.length;b++){if(typeof e[b].period!="function"){e[b].period=ko_observable(e[b].period)}var a=document.getElementById("int"+b+"_per");ko.cleanNode(a);ko.applyBindings(e[b],a);if(typeof e[b].probability!="function"){e[b].probability=ko_observable(e[b].probability)}var a=document.getElementById("int"+b+"_pro");ko.cleanNode(a);ko.applyBindings(e[b],a)}}function get_deco_from_pc(a){var d="0x"+a.toString(16);var b=simhw_internalState("FIRMWARE");if((typeof b.assembly=="undefined")||(typeof b.assembly[d]=="undefined")||(typeof b.assembly[d].source=="undefined")){return""}return b.assembly[d].source}function show_visgraph(n,p){var m=new Object();var g=new Array();var h=0;for(var s in simhw_sim_signals()){m[s]=h;g.push({id:h,label:s,title:s});h++}for(var d=0;d<p.length;d++){g[m[p[d]]].color="#7BE141"}var k=new vis.DataSet(g);var o=new Array();for(var s in simhw_sim_signals()){for(var a in n[s]){o.push({from:m[a],to:m[s],arrows:"to"})}}var q=new vis.DataSet(o);var b=document.getElementById("depgraph1");var e={nodes:k,edges:q};var f={interaction:{hover:true},nodes:{borderWidth:2,shadow:true},edges:{width:2,shadow:true}};jit_dep_network=new vis.Network(b,e,f)}var screen_content="";var keyboard_content="";function get_screen_content(){var a=null;if(typeof document!="undefined"){a=document.getElementById("kdb_con")}if(a!=null){screen_content=a.value}return screen_content}function set_screen_content(a){screen_content=a;if(typeof document=="undefined"){console.log("screen> "+screen_content);return}var b=null;if(typeof document!="undefined"){b=document.getElementById("kdb_con")}if(b!=null){b.value=a}}function get_keyboard_content(){if(typeof document=="undefined"){var a=require("readline-sync");var d=a.question("keyboard> ");keyboard_content=d.toString();return keyboard_content}var b=null;if(typeof document!="undefined"){b=document.getElementById("kdb_key")}if(b!=null){keyboard_content=b.value}return keyboard_content}function set_keyboard_content(b){keyboard_content=b;var a=null;if(typeof document!="undefined"){a=document.getElementById("kdb_key")}if(a!=null){a.value=b}}var show_main_memory_deferred=null;var show_main_memory_redraw=false;function show_main_memory(e,a,d,b){if(get_cfg("DBG_delay")>5){show_main_memory_redraw=d||show_main_memory_redraw}if(null!=show_main_memory_deferred){return}show_main_memory_redraw=d;show_main_memory_deferred=setTimeout(function(){if(show_main_memory_redraw==false){light_refresh_main_memory(e,a,b)}else{hard_refresh_main_memory(e,a,b)}show_main_memory_deferred=null;show_main_memory_updates=false},cfg_show_main_memory_delay)}function hard_refresh_main_memory(f,m,t){if(typeof document=="undefined"){return}var e="";var q="";var d="";var n="";var g=new Array();var o=get_simware();var p=new Object();for(var s in o.labels2){p[o.labels2[s]]=s}var b=new Object();var a=simhw_internalState("segments");for(skey in a){b[parseInt(a[skey].begin)]=skey}for(var s in f){q=main_memory_getword(p,g,f,s);d=b[parseInt(s)];if(typeof d!="undefined"){e+='<div style="position:sticky;top:0px;z-index:1;width:50%;background:#FFFFFF;"><b><small>'+d+"</small></b></div>"}n="<small>0x</small>"+pack5(g[3])+'<span class="d-none d-sm-inline-flex"> </span>-<span class="d-none d-sm-inline-flex"><small> 0x</small></span>'+pack5(g[0]);if(s==m){e+="<div class='row' id='addr"+s+"'     style='color:blue; font-size:small; font-weight:bold;    border-bottom: 1px solid lightgray !important'><div class='col-xs-5 col-sm-5 col-md-5 col-lg-5' align='right'  style='padding:5'>"+n+"</div><div class='col-xs-1 col-sm-1 col-md-1 col-lg-1' align='center' style='padding:0'></div><div class='col-xs-6 col-sm-6 col-md-6 col-lg-6' align='left'   style='padding:5' id='mpval"+s+"'>"+q+"</div></div>"}else{e+="<div class='row' id='addr"+s+"'     style='color:black; font-size:small; font-weight:normal; border-bottom: 1px solid lightgray !important'><div class='col-xs-5 col-sm-5 col-md-5 col-lg-5' align='right'  style='padding:5'>"+n+"</div><div class='col-xs-1 col-sm-1 col-md-1 col-lg-1' align='center' style='padding:0'></div><div class='col-xs-6 col-sm-6 col-md-6 col-lg-6' align='left'   style='padding:5' id='mpval"+s+"'>"+q+"</div></div>"}}if(typeof f[m]=="undefined"){e+="<div class='row' id='addr"+m+"'     style='color:blue; font-size:small; font-weight:bold;    border-bottom: 1px solid lightgray !important'><div class='col-xs-5 col-sm-5 col-md-5 col-lg-5' align='right'  style='padding:5'>0x"+parseInt(m).toString(16)+"</div><div class='col-xs-1 col-sm-1 col-md-1 col-lg-1' align='center' style='padding:5'></div><div class='col-xs-6 col-sm-6 col-md-6 col-lg-6' align='left'   style='padding:5' id='mpval>"+m+"'>00 00 00 00</div></div>"}$("#memory_MP").html("<div class='container-fluid'>"+e+"</div>");var k=$("#addr"+m);if((t)&&(k.length>0)){var h=k[0].offsetTop;var k=$("#memory_MP");if(k.length>0){k[0].scrollTop=h-100}}old_main_addr=m}function main_memory_getword(f,a,g,d){if(typeof g[d]=="undefined"){return"00 00 00 00"}var e=g[d].toString(16);e=pack8(e);var b=0;for(b=0;b<4;b++){a[b]=(parseInt(d)+b).toString(16)}value2="";for(b=0;b<4;b++){labeli=f["0x"+a[3-b]];valuei=e[b*2]+e[b*2+1];if(typeof labeli!="undefined"){value2+='<span><span style="border:1px solid gray;">'+valuei+'</span><span class="badge badge-pill badge-info"      style="position:relative;top:-8px;">'+labeli+"</span></span>"}else{value2+=valuei+" "}}return value2}var old_main_addr=0;function light_refresh_main_memory(k,d,h){if(h){var b=new Array();var a=get_simware();var g=new Object();for(var f in a.labels2){g[a.labels2[f]]=f}var e=main_memory_getword(g,b,k,d);o1=$("#mpval"+d);o1.html(e)}o1=$("#addr"+old_main_addr);o1.css("color","black");o1.css("font-weight","normal");old_main_addr=d;o1=$("#addr"+old_main_addr);o1.css("color","blue");o1.css("font-weight","bold")}var show_control_memory_deferred=null;function show_control_memory(e,a,b,d){if(null!=show_control_memory_deferred){return}show_control_memory_deferred=setTimeout(function(){if(false==d){light_refresh_control_memory(e,a,b)}else{hard_refresh_control_memory(e,a,b,d)}show_control_memory_deferred=null},cfg_show_control_memory_delay)}function controlmemory_lineToString(e,a){var b="";for(var d in e[a]){if(1==e[a][d]){b+=d+" ";continue}if("NATIVE"==d){b+="&lt;native&gt; ";continue}if("NATIVE_JIT"==d){b+="&lt;built-in&gt; ";continue}b+=d+"="+parseInt(e[a][d]).toString(2)+" "}return b}function hard_refresh_control_memory(g,f,m,s){if(typeof document=="undefined"){return}var e="";var p="";var a=get_cfg("ICON_theme");var n=get_simware();var o=new Object();for(var q in n.firmware){o[n.firmware[q]["mc-start"]]=n.firmware[q]["name"]}var d="";var b="";for(var q in g){p=controlmemory_lineToString(g,q);d="0x"+parseInt(q).toString(16);if(typeof o[q]!="undefined"){d='<span><span class="badge badge-pill badge-info"       style="position:relative;top:4px;">'+o[q]+'</span><span style="border:1px solid gray;">'+d+"</span></span>"}b="&nbsp;";if(true==f[q].breakpoint){b="<img alt='stop icon' height=22 src='images/stop_"+a+".gif'>"}if(q==m){e+="<tr id='maddr"+q+"'     style='color:blue; font-size:small; font-weight:bold'     onclick='dbg_set_breakpoint("+q+");              if (event.stopPropagation) event.stopPropagation();'><td width=15% align=right>"+d+"</td><td width=1% id='mcpin"+q+"' style='padding:5 0 0 0;'>"+b+"</td><td>"+p+"</td></tr>"}else{e+="<tr id='maddr"+q+"'     style='color:black; font-size:small; font-weight:normal'     onclick='dbg_set_breakpoint("+q+");              if (event.stopPropagation) event.stopPropagation();'><td width=15% align=right>"+d+"</td><td width=1% id='mcpin"+q+"' style='padding:5 0 0 0;'>"+b+"</td><td>"+p+"</td></tr>"}}if(typeof g[m]=="undefined"){e+="<tr><td width=15%><font style='color:blue; font-size:small; font-weight:bold'>0x"+parseInt(m).toString(16)+"</font></td><td><font style='color:blue; font-size:small; font-weight:bold'><b>&nbsp;</b></font></td></tr>"}$("#memory_MC").html("<center><table class='table table-hover table-sm'><tbody id=none>"+e+"</tbody></table></center>");var k=$("#maddr"+m);if((s)&&(k.length>0)){var h=k[0].offsetTop;var k=$("#memory_MC");if(k.length>0){k[0].scrollTop=h}}old_mc_addr=m}var old_mc_addr=0;function light_refresh_control_memory(d,a,b){o1=$("#maddr"+old_mc_addr);o1.css("color","black");o1.css("font-weight","normal");old_mc_addr=b;o1=$("#maddr"+old_mc_addr);o1.css("color","blue");o1.css("font-weight","bold")}function firmware2html(z,B){var n=["A0,0","B,0","C,0","SELA,5","SELB,5","SELC,2","SELCOP,0","MR,0","MC,0","C0,0","C1,0","C2,0","C3,0","C4,0","C5,0","C6,0","C7,0","T1,0","T2,0","T3,0","T4,0","T5,0","T6,0","T7,0","T8,0","T9,0","T10,0","T11,0","M1,0","M2,0","M7,0","MA,0","MB,0","SELP,0","LC,0","SE,0","SIZE,0","OFFSET,0","BW,0","R,0","W,0","TA,0","TD,0","IOR,0","IOW,0","TEST_I,0","TEST_U,0"];var D="<tr bgcolor=#FF9900><td bgcolor=white     style='border-style: solid; border-width:0px; border-color:lightgray;'></td><td bgcolor=lightblue style='border-style: solid; border-width:1px; border-color:lightgray;'>co</td><td bgcolor=#FFCC00   style='border-style: solid; border-width:1px; border-color:lightgray;' align=center><small><b>&#181;dir</b></small></td><td bgcolor=white     style='border-style: solid; border-width:0px; border-color:lightgray;'>&nbsp;&nbsp;</td>";var A=1;for(var C=0;C<n.length;C++){var q=n[C].split(",")[0];D+="<td align=center style='border-style: solid; border-width:1px;'><small><b>"+simhw_sim_signals()[q].name+"</b></small></td>";A++}D+="</tr>";var w="<center>";w+="<table style='table-layout:auto; border-style: solid: border-width:0px; border-collapse:collapse;'>";var x=0;var m="";var g="";var F="";for(var C=0;C<z.length;C++){var v=z[C]["mc-start"];var e=z[C].microcode;for(j=0;j<e.length;j++){if(++x%10==1){w=w+D}g="";if(typeof z[C].co!="undefined"){g=parseInt(z[C].co,2)}var t=z[C].signature.split(",")[0];m="";if(j==0){m+="<td style='border-style: solid; border-width:0px; border-color:lightgray;'><span class='badge badge-pill badge-secondary float-left'>"+t+"</span>&nbsp;</td><td style='border-style: solid; border-width:1px; border-color:lightgray;'>"+g+"</td>"}else{m+="<td style='border-style: solid; border-width:0px; border-color:lightgray;'>&nbsp;</td><td style='border-style: solid; border-width:1px; border-color:lightgray;'>&nbsp;</td>"}if(B){F="0x"+(v+j).toString(16)}else{F=v+j}m+="<td align=center  style='border-style: solid; border-width:1px; border-color:lightgray;' bgcolor=white>"+F+"</td><td bgcolor=white style='border-style: solid; border-width:0px; border-color:lightgray;'>&nbsp;</td>";var f=e[j];for(var y=0;y<n.length;y++){var q=n[y].split(",")[0];var E=parseInt(simhw_sim_signals()[q].default_value);var p=false;if((typeof f[q]!="undefined")&&(!isNaN(parseInt(f[q])))){E=parseInt(f[q]);p=true}if((q=="SELA"||q=="SELB"||q=="SELC")&&(typeof f.MADDR!="undefined")&&(!isNaN(parseInt(f.MADDR)))){var b=parseInt(f.MADDR).toString(2);b="000000000000".substring(0,12-b.length)+b+"000";if(q=="SELA"){E=parseInt(b.substring(0,5),2);p=true}if(q=="SELB"){E=parseInt(b.substring(5,10),2);p=true}if(q=="SELC"){E=parseInt(b.substring(10,15),2);p=true}}if(B){var b=E.toString(2);var u=parseInt(simhw_sim_signals()[q].nbits);E="00000000000000000000000000000000".substring(0,u-b.length)+b;var G=n[y].split(",")[1];var d=E.substring(0,G);var a=E.substring(G);E="<font color=green>"+d+"</font>"+a}if(p){m+="<td align=center style='border-style: solid; border-width:1px;'><b>"+E+"</b></td>"}else{m+="<td align=center style='border-style: solid; border-width:1px;'><font color='grey'>"+E+"</font></td>"}}w+="<tr>"+m+"</tr>"}}w+="</table></center>";return w}function labels2html_aux(a,g){var f="";var d="";for(var b=3;b>=0;b--){d="0x"+(parseInt(g)+b).toString(16);if(typeof a[d]!="undefined"){for(var e=0;e<a[d].length;e++){f=f+"<span class='badge badge-pill badge-secondary float-left'>"+a[d][e]+"</span>"}}else{f=f+"&nbsp;"}}return f}function mp2html(b,k,g){var f=new Object();for(var d in k){if(typeof f[k[d]]=="undefined"){f[k[d]]=new Array()}f[k[d]].push(d)}var a="";a+="<center><table style='table-layout:auto; border-style: solid; border-width:0px;'><tr><th style='border-style: solid; border-width:0px;'>labels</th><th style='border-style: solid; border-width:1px;'>address</th><th style='border-style: solid; border-width:1px;'><table border=0 width=100%><tr align=center>  <td width=25% align=center><small><b>byte 3</b></small></td>  <td width=25% align=center><small><b>byte 2</b></small></td>  <td width=25% align=center><small><b>byte 1</b></small></td>  <td width=25% align=center><small><b>byte 0</b></small></td></tr><tr>  <td width=12% align=center >&nbsp;<sup>31&nbsp;&nbsp;......&nbsp;&nbsp;24</sup>&nbsp;</td>  <td width=12% align=center >&nbsp;<sup>23&nbsp;&nbsp;......&nbsp;&nbsp;16</sup>&nbsp;</td>  <td width=12% align=center >&nbsp;<sup>15&nbsp;&nbsp;......&nbsp;&nbsp;8</sup>&nbsp;</td>  <td width=12% align=center >&nbsp;<sup>7&nbsp;&nbsp;......&nbsp;&nbsp;0</sup>&nbsp;</td></tr></table><th style='border-style: solid; border-width:0px;' align=right>&nbsp;&nbsp;segment</th></tr>";var e="white";for(var n in g){c_begin=parseInt(g[n].begin);c_end=parseInt(g[n].end);e=g[n].color;rows=0;var m="";for(var h=c_begin;h<c_end;h++){c="0x"+h.toString(16);if(typeof b[c]=="undefined"){continue}if(0==rows){a+="<tr style=\"font-family:'Consolas'; font-size:11pt;\"><td align=right  style='border-style: solid; border-width:0px;'>"+labels2html_aux(f,c)+"</td><td              style='border-style: solid; border-width:1px;' bgcolor="+e+">"+c.toUpperCase()+"</td><td              style='border-style: solid; border-width:1px;' bgcolor="+e+">"+b[c].substr(0,8)+"&nbsp;"+b[c].substr(8,8)+"&nbsp;"+b[c].substr(16,8)+"&nbsp;"+b[c].substr(24,8)+"</td><td rowspan="}else{m+="<tr style=\"font-family:'Consolas'; font-size:11pt;\"><td align=right  style='border-style: solid; border-width:0px;'>"+labels2html_aux(f,c)+"</td><td              style='border-style: solid; border-width:1px;' bgcolor="+e+">"+c.toUpperCase()+"</td><td              style='border-style: solid; border-width:1px;' bgcolor="+e+">"+b[c].substr(0,8)+"&nbsp;"+b[c].substr(8,8)+"&nbsp;"+b[c].substr(16,8)+"&nbsp;"+b[c].substr(24,8)+"</td></tr>"}rows++}if(0==rows){a+="<tr style=\"font-family:'Consolas'; font-size:12pt;\"><td>&nbsp;</td><td style='border-style: solid; border-width:1px;' bgcolor="+e+">0x"+parseInt(g[n].begin).toString(16).toUpperCase()+"</td><td style='border-style: solid; border-width:1px;' bgcolor="+e+">&nbsp;</td><td rowspan=";m+="<tr style=\"font-family:'Consolas'; font-size:12pt;\"><td>&nbsp;</td><td style='border-style: solid; border-width:1px;' bgcolor="+e+">0x"+parseInt(g[n].end).toString(16).toUpperCase()+"</td><td style='border-style: solid; border-width:1px;' bgcolor="+e+">&nbsp;</td><td>&nbsp;</td></tr>";rows=2}a+=rows+" align=right>"+g[n].name+"&nbsp;</td></tr>"+m;if(g[n].name!=".stack"){a+="<tr style=\"font-family:'Consolas'; font-size:12pt;\"><td>&nbsp;</td><td valign=middle align=center height=25px>...</td><td valign=middle align=center height=25px>...</td><td>&nbsp;</td></tr>"}}a+="</table></center><br>";return a}function segments2html(b){var e="<br>";e+=" <center> <table height=400px> <tr> <td><table style='border-style: solid' border=1 width=100% height=100%>";for(var a in b){if(b[a].name!=".stack"){e+="<tr><td valign=middle align=center height=60px bgcolor="+b[a].color+">"+b[a].name+"</td></tr><tr><td valign=middle align=center height=25px>...</td></tr>"}}e+="<tr><td valign=middle align=center bgcolor="+b[".stack"].color+">"+b[".stack"].name+"</td></tr></table> </td> <td width=20px>&nbsp;</td> <td> <table style='border-style: solid; border-width:0px; width:100%; height:100%'>";var f="";var d="";for(a in b){f="<tr>    <td valign=top align=left height=30px style=''>    <div id='compile_begin_"+b[a].name+"'>"+b[a].begin+"</div>    </td> </tr> <tr>    <td valign=bottom align=left height=30px style=''>    <div id='compile_end_"+b[a].name+"'>"+b[a].end+"</div>    </td> </tr>";if(b[a].name!=".stack"){e+=f+"<tr><td valign=middle align=center height=25px>...</td></tr>"}else{d=f}}e+=d+" </table> </td> </tr> </table> </center>";return e}function assembly2html(d,k,g,f){var e="";var p="";var m="";var b="#F0F0F0";var a="";var q=new Object();for(l in k){if(typeof q[k[l]]=="undefined"){q[k[l]]=new Array()}q[k[l]].push(l)}var n=new Object();for(l in g){laddr="0x"+g[l].begin.toString(16);n[laddr]=l}a+="<center><table data-role=table class='table ui-responsive table-sm'><tbody>";for(l in f){if(b=="#F0F0F0"){b="#F8F8F8"}else{b="#F0F0F0"}f[l].bgcolor=b;p=f[l].source;m=f[l].source_original;e="";if(typeof q[l]!="undefined"){for(var h=0;h<q[l].length;h++){e=e+"<span class='badge badge-info'>"+q[l][h]+"</span>"}}if(typeof n[l]!="undefined"){a+="<tr bgcolor='#FEFEFE'><td colspan='7' style='line-height:0.3;' align=left><small><font color=gray>"+n[l]+"</font></small></td>"}"</tr>";a+="<tr id='asmdbg"+l+"' bgcolor='"+f[l].bgcolor+"'    onclick='asmdbg_set_breakpoint("+l+");              if (event.stopPropagation) event.stopPropagation();'><td                                             width='2%'></td><td class='asm_break'  style='line-height:0.9; padding:5 0 0 0;' width='10%' align='center' id='bp"+l+"'>&nbsp;</td><td class='asm_addr'   style='line-height:0.9;' width='15%'>"+l+"</td><td class='asm_label2' style='line-height:0.9;' width='10%' align=right>"+e+"</td><td class='asm_pins'   style='line-height:0.9;' width='20%' align=left>"+m+"</td><td class='asm_label1' style='line-height:0.9;' width='10%' align=right>"+e+"</td><td class='asm_ins'    style='line-height:0.9;' width='25%' align=left>"+p+"</td></tr>"}a+="</tbody></table></center>";return a}var show_asmdbg_pc_deferred=null;function innershow_asmdbg_pc(){fullshow_asmdbg_pc();show_asmdbg_pc_deferred=null}function show_asmdbg_pc(){if(get_cfg("DBG_delay")>5){return fullshow_asmdbg_pc()}if(null==show_asmdbg_pc_deferred){show_asmdbg_pc_deferred=setTimeout(innershow_asmdbg_pc,cfg_show_asmdbg_pc_delay)}}var old_addr=0;function fullshow_asmdbg_pc(){if(typeof document=="undefined"){return}var d=null;var b=get_value(simhw_sim_state("REG_PC"));var e="0x"+b.toString(16);var a=simhw_internalState("FIRMWARE");if(typeof a.assembly[old_addr]!="undefined"){d=$("#asmdbg"+old_addr);d.css("background-color",a.assembly[old_addr].bgcolor)}else{for(l in a.assembly){d=$("#asmdbg"+l);d.css("background-color",a.assembly[l].bgcolor)}}old_addr=e;d=$("#asmdbg"+e);d.css("background-color","#00EE88");return d}function asmdbg_set_breakpoint(g){var b=get_cfg("ICON_theme");var a="0x"+g.toString(16);var d=simhw_internalState("FIRMWARE");var f=document.getElementById("bp"+a);var e=d.assembly[a].breakpoint;if(e===true){e=false;f.innerHTML="&nbsp;"}else{e=true;f.innerHTML="<img alt='stop icon' height=22 src='images/stop_"+b+".gif'>"}d.assembly[a].breakpoint=e}function dbg_set_breakpoint(e){var a=get_cfg("ICON_theme");var d=document.getElementById("mcpin"+e);var b=simhw_internalState_get("MC_dashboard",e).breakpoint;if(b===true){b=false;d.innerHTML="&nbsp;"}else{b=true;d.innerHTML="<img alt='stop icon' height='22' src='images/stop_"+a+".gif'>"}simhw_internalState_get("MC_dashboard",e).breakpoint=b;if(b&&("instruction"==get_cfg("DBG_level"))){wepsim_notify_success("<strong>INFO</strong>","Please remember to change configuration to execute at microinstruction level.")}}function show_dbg_mpc(){show_control_memory(simhw_internalState("MC"),simhw_internalState("MC_dashboard"),get_value(simhw_sim_state("REG_MICROADDR")),false)}var show_dbg_ir_deferred=null;function show_dbg_ir(a){if(null!=show_dbg_ir_deferred){return}show_dbg_ir_deferred=setTimeout(function(){fullshow_dbg_ir(a);show_dbg_ir_deferred=null},cfg_show_dbg_ir_delay)}function fullshow_dbg_ir(a){if(typeof document=="undefined"){return}var b=document.getElementById("svg_p");if(b!=null){b=b.contentDocument}if(b!=null){b=b.getElementById("tspan3899")}if(b!=null){b.innerHTML=a}var b=document.getElementById("svg_cu");if(b!=null){b=b.contentDocument}if(b!=null){b=b.getElementById("text3611")}if(b!=null){b.innerHTML=a}}function simstate_checklist2state(h){var b={};var g=false;h=h.replace(/;|==|!=|>=|<=|=|>|</gi,function(n){return" "+n+" "});h=h.replace(/  /g," ");var k=h.split(";");for(var e=0;e<k.length;e++){var m=k[e].trim();if(""==m){continue}var d=m.split(" ");if(d.length<4){continue}var a={type:d[0],id:d[1],condition:d[2],value:decodeURI(d[3])};for(var f in simhw_sim_components()){g=simhw_sim_component(f).read_state(b,a);if(true==g){break}}if(false==g){console.log("ERROR in checklist at component "+a.type+": "+m)}}return b}function simstate_current2state(){var b={};for(var a in simhw_sim_components()){simhw_sim_component(a).write_state(b)}return b}function simstate_state2checklist(f){var e="";for(var d in f){for(var b in f[d]){var a=f[d][b];e=e+a.type+" "+a.id+" "+a.op+" "+encodeURI(a.value)+"; "}}return e}function simstate_check_results(g,f,h){var m={};m.result=[];m.errors=0;m.neltos_expected=0;m.neltos_obtained=0;var a=null;var k={};var e=0;for(var b in simhw_sim_components()){if(typeof g[b]!="undefined"){for(a in g[b]){m.neltos_expected++;e=g[b][a].default_value;if((typeof f[b]!="undefined")&&(typeof f[b][a]!="undefined")){e=f[b][a].value}k={};k.expected=g[b][a].value;k.obtained=e;k.elto_type=b.toLowerCase();k.elto_id=g[b][a].id;k.elto_op=g[b][a].op;k.fulfill=false;if("="==g[b][a].op){k.fulfill=(parseInt(k.obtained)==parseInt(k.expected))}else{if(">"==g[b][a].op){k.fulfill=(parseInt(k.obtained)>parseInt(k.expected))}else{if("<"==g[b][a].op){k.fulfill=(parseInt(k.obtained)<parseInt(k.expected))}else{if(">="==g[b][a].op){k.fulfill=(parseInt(k.obtained)>=parseInt(k.expected))}else{if("<="==g[b][a].op){k.fulfill=(parseInt(k.obtained)<=parseInt(k.expected))}else{if("=="==g[b][a].op){k.fulfill=(k.expected==k.obtained)}else{if("!="==g[b][a].op){k.fulfill=(k.expected!=k.obtained)}}}}}}}m.result.push(k);if(k.fulfill===false){m.errors++}}}if((h)&&(typeof f[b]!="undefined")){for(a in f[b]){m.neltos_obtained++;if((typeof g[b]!="undefined")&&(typeof g[b][a]!="undefined")){continue}k={};k.expected=f[b][a].default_value;k.obtained=f[b][a].value;k.fulfill=(k.expected==k.obtained);k.elto_type=b.toLowerCase();k.elto_id=f[b][a].id;k.elto_op="=";m.result.push(k);if(k.fulfill===false){m.errors++}}}}return m}function simstate_diff_results(b,a){return simstate_check_results(b,a,true)}function simstate_diff_states(b,e){var a=simstate_state2checklist(b).split(";");var d=simstate_state2checklist(e).split(";");return d.filter(function(f){return !a.includes(f)}).join(";").trim()}function simstate_checkreport2txt(b){var d="";for(var a=0;a<b.length;a++){if(b[a].fulfill===false){d+=b[a].elto_type+"["+b[a].elto_id+"]='"+b[a].obtained+"' (expected '"+b[a].expected+"'), "}}return d}function simstate_checkreport2html(e,b){var f="";var a="green";if(typeof b==="undefined"){b=false}f+="<table style='margin:0 0 0 0;'        class='table table-hover table-bordered table-sm'><thead><tr><th>Type</th><th><span class='d-none d-sm-inline-flex'>Identification</span><span class='d-sm-none'>Id.</span></th><th><span class='d-none d-sm-inline-flex'>Values in the</span> clipboard <span class='d-none d-sm-inline-flex'>state</th><th><span class='d-none d-sm-inline-flex'>Values in the</span> selected <span class='d-none d-sm-inline-flex'>state</th></tr></thead><tbody>";for(var d=0;d<e.length;d++){if(e[d].fulfill===false){a="table-danger"}else{a="table-success"}if(b&&e[d].fulfill){continue}f+="<tr class="+a+"><td>"+e[d].elto_type+"</td><td>"+e[d].elto_id+"</td><td>"+e[d].elto_op+"&nbsp;"+e[d].expected+"</td><td>"+e[d].obtained+"</td></tr>"}f+="</tbody></table>";return f}function sim_core_init(a){var b={};b.msg="";b.ok=true;if(a){restore_cfg()}else{reset_cfg();stop_drawing()}return b}function sim_core_init_panel(h,g,d,f,a,b){var e={};e.msg="";e.ok=true;init_states(h);init_rf(g);init_io(d);init_cpu(f);init_config_mp(a);init_config_io(b);return e}function sim_core_init_eventlistener(e){for(var d in simhw_sim_signals()){for(var b=0;b<simhw_sim_signal(d).fire_name.length;b++){var f=simhw_sim_signal(d).fire_name[b].split(":");if(f[0]!=e){continue}var g=document.getElementById(f[0]).contentDocument;if(null==g){console.log('warning: unreferenced graphic element context named "'+f[0]+'".');continue}var a=g.getElementById(f[1]);if(null==a){console.log('warning: unreferenced graphic element named "'+f[0]+":"+f[1]+'".');continue}a.addEventListener("click",update_signal,false)}}}function sim_core_check_if_can_execute(){var b={};b.msg="";b.ok=true;var d=simhw_internalState("segments");if((typeof d[".ktext"]=="undefined")&&(typeof d[".text"]=="undefined")){b.msg="code segment .ktext/.text does not exist!\nPlease load some assembly code.";b.ok=false;return b}var a=get_simware();if((!((typeof d[".ktext"]!="undefined")&&(a.labels2.kmain)))&&(!((typeof d[".text"]!="undefined")&&(a.labels2.main)))){b.msg="labels 'kmain' (in .ktext) or 'main' (in .text) do not exist!";b.ok=false;return b}return b}function sim_core_check_if_can_continue(){var a={};a.ok=true;a.msg="";var e=get_value(simhw_sim_state("REG_MICROADDR"));if(typeof simhw_internalState_get("MC",e)=="undefined"){a.ok=false;a.msg="Error: undefined microinstruction at "+e+".";return a}var f=get_cfg("ws_mode");if(("wepmips"!=f)&&(e!=0)){return a}var d=simhw_internalState("segments");var b=parseInt(get_value(simhw_sim_state("REG_PC")));if((b<d[".ktext"].end)&&(b>=d[".ktext"].begin)){return a}if((b<d[".text"].end)&&(b>=d[".text"].begin)){return a}a.ok=false;a.msg="The program has finished because the PC register points outside .ktext/.text code segments";return a}function sim_core_reset(){var b={};b.msg="";b.ok=true;var a=get_simware();var d=simhw_internalState("FIRMWARE");var e=simhw_internalState("segments");compute_general_behavior("RESET");if((typeof e[".ktext"]!="undefined")&&(a.labels2.kmain)){set_value(simhw_sim_state("REG_PC"),parseInt(a.labels2.kmain));show_asmdbg_pc()}else{if((typeof e[".text"]!="undefined")&&(a.labels2.main)){set_value(simhw_sim_state("REG_PC"),parseInt(a.labels2.main));show_asmdbg_pc()}}if((typeof e[".stack"]!="undefined")&&(typeof simhw_sim_states().BR[d.stackRegister]!="undefined")){set_value(simhw_sim_states().BR[d.stackRegister],parseInt(e[".stack"].begin))}var f=get_cfg("ws_mode");if("wepmips"!=f){compute_general_behavior("CLOCK")}set_screen_content("");show_states();show_rf_values();show_rf_names();show_dbg_ir(get_value(simhw_sim_state("REG_IR_DECO")));show_main_memory(simhw_internalState("MP"),0,true,false);show_control_memory(simhw_internalState("MC"),simhw_internalState("MC_dashboard"),0,true);return b}function sim_core_execute_microinstruction(){var a=sim_core_check_if_can_continue();if(false==a.ok){return a}compute_general_behavior("CLOCK");show_states();show_rf_values();show_dbg_mpc();return a}function sim_core_execute_microprogram(e,a){var h=sim_core_check_if_can_continue();if(false==h.ok){return h}var g=get_cfg("ws_mode");if("wepmips"==g){compute_general_behavior("CLOCK");compute_general_behavior("CLOCK");show_states();show_rf_values();return h}var m=false;if(a<0){m=true}var n=null;var k=null;var f="";var o=simhw_internalState("MC");var d=0;var b=0;do{if(3==e){n=simstate_current2state()}compute_general_behavior("CLOCK");if(3==e){k=simstate_current2state();f="0x"+b.toString(16);h.msg=h.msg+"micropc("+f+"):\t"+controlmemory_lineToString(o,b).trim()+":\t\t\t"+simstate_diff_states(n,k)+"\n"}d++;if(m){a=d+1}if(d>=a){h.msg="Warning: clock cycles limit reached in a single instruction.";h.ok=false;break}b=get_value(simhw_sim_state("REG_MICROADDR"));if(typeof o[b]=="undefined"){h.msg="Error: undefined microinstruction at "+b+".";h.ok=false;break}}while((d<a)&&(0!=b));show_states();show_rf_values();if(get_cfg("DBG_level")=="microinstruction"){show_dbg_mpc()}return h}function sim_core_execute_program(e,f,s){var g={};g.ok=true;g.msg="";var a=simhw_internalState("segments");var m=get_value(simhw_sim_state("REG_PC"));var u=get_value(simhw_sim_state("REG_PC"))-4;var o=0;if((typeof a[".text"]!="undefined")&&(typeof a[".text"].begin!="undefined")){o=parseInt(a[".text"].begin)}var q=0;if((typeof a[".text"]!="undefined")&&(typeof a[".text"].end!="undefined")){q=parseInt(a[".text"].end)}var t=0;if((typeof a[".ktext"]!="undefined")&&(typeof a[".ktext"].begin!="undefined")){t=parseInt(a[".ktext"].begin)}var b=0;if((typeof a[".ktext"]!="undefined")&&(typeof a[".ktext"].end!="undefined")){b=parseInt(a[".ktext"].end)}var n=null;var p=null;var k=null;var d="";var h=get_simware();var v=0;while((m!=u)&&(((m<q)&&(m>=o))||((m<b)&&(m>=t)))){if(2==e){p=simstate_current2state()}n=sim_core_execute_microprogram(e,s);if(false==n.ok){return n}if(3==e){g.msg=g.msg+n.msg}if(2==e){k=simstate_current2state();d="0x"+m.toString(16);g.msg=g.msg+"pc("+d+"):\t"+h.assembly[d].source_original+":\t\t\t"+simstate_diff_states(p,k)+"\n"}v++;if(v>f){g.ok=false;g.msg="more than "+f+" instructions executed before application ends.";return g}u=m;m=get_value(simhw_sim_state("REG_PC"))}return g}function sim_core_compile_firmware(f){var b={};b.msg="";b.ok=true;if(""==f){b.msg="Empty Firmware";b.ok=false;return b}var a=null;try{a=loadFirmware(f);b.simware=a}catch(d){b.msg="ERROR: at line: "+d.lineNumber+" and column: "+d.columnNumber;b.ok=false;return b}if(a.error!=null){b.msg=a.error;b.ok=false;return b}update_memories(a);sim_core_reset();return b}function sim_core_compile_assembly(b){var d={};d.msg="";d.ok=true;var a=get_simware();if(a.firmware.length==0){d.msg="Empty microcode, please load the microcode first.";d.ok=false;return d}var e=simlang_compile(b,a);d.simware=e;if(e.error!=null){d.msg=e.error;d.ok=false;return d}set_simware(e);update_memories(a);sim_core_reset();return d};