var sim={systems:[],active:null,index:0};function simhw_add(a){sim.systems.push(a);sim.active=a;sim.index=sim.systems.length-1;check_behavior();compile_behaviors();firedep_to_fireorder(jit_fire_dep);compute_references();compile_verbals()}function simhw_getActive(){return sim.index}function simhw_setActive(a){if((a>=0)&&(sim.systems.length>=a)){sim.active=sim.systems[a];sim.index=a}compile_behaviors();firedep_to_fireorder(jit_fire_dep);compute_references();compile_verbals()}function simhw_getIdByName(c){for(var a=0;a<sim.systems.length;a++){if(sim.systems[a].sim_short_name==c){return a}}return -1}function simhw_getObjByName(c){for(var a=0;a<sim.systems.length;a++){if(sim.systems[a].sim_short_name==c){return sim.systems[a]}}return null}function simhw_active(){return sim.active}function simhw_short_name(){return sim.active.sim_short_name}function simhw_sim_signals(){return sim.active.signals}function simhw_sim_signal(a){return sim.active.signals[a]}function simhw_sim_states(){return sim.active.states}function simhw_sim_state(a){return sim.active.states[a]}function simhw_syntax_behaviors(){return sim.active.behaviors}function simhw_syntax_behavior(a){return sim.active.behaviors[a]}function simhw_sim_components(){return sim.active.components}function simhw_sim_component(a){return sim.active.components[a]}function simhw_internalState(a){return sim.active.internal_states[a]}function simhw_internalState_get(a,c){return sim.active.internal_states[a][c]}function simhw_internalState_set(a,d,c){sim.active.internal_states[a][d]=c}function simhw_internalState_reset(a,c){if(typeof ep_internal_states!="undefined"){ep_internal_states[a]=c;sim.active.internal_states[a]=ep_internal_states[a]}else{sim.active.internal_states[a]=c}}function simhw_sim_ctrlStates_get(){return sim.active.ctrl_states}function get_value(a){if(typeof a.value=="function"){return a.value()}return a.value}function set_value(a,c){if(typeof a.value=="function"){if(a.value()!=c){a.changed=true}a.value(c)}else{if(a.value!=c){a.changed=true}a.value=c}}function reset_value(c){if(typeof c.value=="function"){if(c.value()!=c.default_value){c.changed=true}set_value(c,c.default_value)}else{if(typeof c.default_value=="object"){c.changed=true;c.value=Object.create(c.default_value)}else{if(c instanceof Array){c.changed=true;for(var a=0;a<c.length;a++){set_value(c[a],c[a].default_value)}}else{if(c.value!=c.default_value){c.changed=true}set_value(c,c.default_value)}}}}function get_var(a){if(typeof a=="function"){return a()}else{return a}}function set_var(c,a){if(typeof c=="function"){c(a)}else{c=a}}var sim_references={};function compute_references(){for(var a in simhw_sim_signals()){sim_references[a]=simhw_sim_signal(a);simhw_sim_signal(a).changed=false}for(a in simhw_sim_states()){sim_references[a]=simhw_sim_state(a);simhw_sim_state(a).changed=false}}function get_reference(a){return sim_references[a]}function show_verbal(c){var a=simhw_sim_state(c);if(typeof a=="undefined"){a=simhw_sim_signal(c)}if("undefined"==typeof a){return c}if("undefined"==typeof a.verbal){return c}return a.verbal}function show_value(a){if(isNaN(a)){return"NaN"}return"0x"+(a>>>0).toString(16)}function check_behavior(){if(0==simhw_sim_signals().length){alert("ALERT: empty signals!!!")}if(0==simhw_sim_states().length){alert("ALERT: empty states!!!")}for(var h in simhw_sim_signals()){for(var g in simhw_sim_signal(h).behavior){var a=simhw_sim_signal(h).behavior[g].split(";");for(var f=0;f<a.length;f++){var d=a[f].trim();var c=d.split(" ");if(""==d){continue}if(typeof(simhw_syntax_behavior(c[0]))=="undefined"){alert("ALERT: Unknown operation -> "+c[0]+" ("+d+")");return}if(c.length!=simhw_syntax_behavior(c[0]).nparameters){alert("ALERT: Behavior has an incorrect number of elements --> "+d+"/"+simhw_syntax_behavior(c[0]).nparameters);return}for(var e=1;e<c.length;e++){var l=c[e].split("/");var k=simhw_syntax_behavior(c[0]).types[e-1];if(("E"==k)&&(typeof simhw_sim_state(l[0])=="undefined")){alert("ALERT: Behavior has an undefined reference to a object state -> '"+d);return}else{if(("S"==k)&&(typeof simhw_sim_signal(l[0])=="undefined")){alert("ALERT: Behavior has an undefined reference to a signal -> '"+d);return}else{if(("X"==k)&&(typeof simhw_sim_state(l[0])=="undefined")&&(typeof simhw_sim_signal(l[0])=="undefined")){alert("ALERT: Behavior has an undefined reference to a object state OR signal -> '"+d);return}}}}}}}}var jit_behaviors=false;var jit_verbals=false;var jit_fire_dep=null;var jit_fire_order=null;var jit_dep_network=null;var jit_fire_ndep=null;function firedep_to_fireorder(c){var a=false;jit_fire_order=[];jit_fire_ndep=[];for(var e in simhw_sim_signals()){if(typeof c[e]=="undefined"){jit_fire_order.push(e);continue}ndep=0;a=false;for(var d in c[e]){ndep++;if(c[e][d]==simhw_sim_signal(d).behavior.length){a=true}}jit_fire_ndep[e]=ndep;if(a==false){jit_fire_order.push(e)}}}function compile_behaviors(){var jit_bes="";jit_fire_dep={};var sig_obj=null;var expr_obj=null;for(var sig in simhw_sim_signals()){jit_bes+="simhw_sim_signal('"+sig+"').behavior_fn = new Array();\n";for(var val in simhw_sim_signal(sig).behavior){var input_behavior=simhw_sim_signal(sig).behavior[val];var jit_be="";var s_exprs=input_behavior.split(";");for(var i=0;i<s_exprs.length;i++){s_exprs[i]=s_exprs[i].trim();if(""==s_exprs[i]){continue}var s_expr=s_exprs[i].split(" ");if(s_expr[0]!="NOP"){jit_be+="simhw_syntax_behavior('"+s_expr[0]+"').operation("+JSON.stringify(s_expr)+");\t"}if("FIRE"==s_expr[0]){sig_obj=simhw_sim_signal(sig);expr_obj=simhw_sim_signal(s_expr[1]);if(typeof expr_obj=="undefined"){alert("ERROR: for signal '"+sig+"', unknow behavior '"+s_exprs[i]+"'")}else{if(sig_obj.type==expr_obj.type){if(typeof jit_fire_dep[s_expr[1]]=="undefined"){jit_fire_dep[s_expr[1]]={}}if(typeof jit_fire_dep[s_expr[1]][sig]=="undefined"){jit_fire_dep[s_expr[1]][sig]=0}jit_fire_dep[s_expr[1]][sig]++}}}}jit_bes+="simhw_sim_signal('"+sig+"').behavior_fn["+val+"] = \t function() {"+jit_be+"};\n"}}eval(jit_bes);jit_behaviors=true}function compute_behavior(d){var e=d.split(";");for(var c=0;c<e.length;c++){e[c]=e[c].trim();if(""==e[c]){continue}var a=e[c].split(" ");simhw_syntax_behavior(a[0]).operation(a)}}function compute_general_behavior(a){if(jit_behaviors){simhw_syntax_behavior(a).operation()}else{compute_behavior(a)}}function compute_signal_behavior(c,a){if(jit_behaviors){simhw_sim_signal(c).behavior_fn[a]()}else{compute_behavior(simhw_sim_signal(c).behavior[a])}}function compile_verbals(){var jit_vbl="";for(var sig in simhw_sim_signals()){jit_vbl+="simhw_sim_signal('"+sig+"').verbal_fn = new Array();\n";for(var val in simhw_sim_signal(sig).behavior){var input_behavior=simhw_sim_signal(sig).behavior[val];var jit_be=' var r = ""; ';var s_exprs=input_behavior.split(";");for(var i=0;i<s_exprs.length;i++){s_exprs[i]=s_exprs[i].trim();if(""==s_exprs[i]){continue}var s_expr=s_exprs[i].split(" ");jit_be+=" r = r + simhw_syntax_behavior('"+s_expr[0]+"').verbal("+JSON.stringify(s_expr)+");\t"}jit_vbl+="simhw_sim_signal('"+sig+"').verbal_fn["+val+"] = \t function() {"+jit_be+" return r; };\n"}}eval(jit_vbl);jit_verbals=true}function compute_verbal(d){var e="";var f=d.split(";");for(var c=0;c<f.length;c++){f[c]=f[c].trim();if(""==f[c]){continue}var a=f[c].split(" ");e=e+simhw_syntax_behavior(a[0]).verbal(a)}return e}function compute_signal_verbals(e,a){var d="";var f=null;f=simhw_sim_signal(e);if(typeof f.behavior=="undefined"){return d}var c=f.behavior.length-1;if(a<c){c=a}if((typeof f.verbal!="undefined")&&(typeof f.verbal[c]!="undefined")){return f.verbal[c]}if(jit_behaviors){d=f.verbal_fn[c]()}else{d=compute_verbal(f.behavior[c])}return d}var ep_components={};var ep_states={};var ep_events={};var ep_signals={};var ep_behaviors={};var ep_internal_states={};var ep_ctrl_states={};var ep_def={sim_name:"Elemental Processor",sim_short_name:"ep",sim_img_processor:"examples/hardware/ep/images/processor.svg",sim_img_controlunit:"examples/hardware/ep/images/controlunit.svg",sim_img_cpu:"examples/hardware/ep/images/cpu.svg",components:ep_components,states:ep_states,signals:ep_signals,behaviors:ep_behaviors,events:ep_events,internal_states:ep_internal_states,ctrl_states:ep_ctrl_states};simhw_add(ep_def);ep_behaviors.PRINT_S={nparameters:2,types:["S"],operation:function(a){console.log(a[1]+": 0x"+ep_signals[a[1]].value.toString(16))},verbal:function(a){return"Print value of signal "+a[1]+": 0x"+ep_signals[a[1]].value.toString(16)+". "}};ep_behaviors.PRINT_E={nparameters:2,types:["E"],operation:function(a){console.log(a[1]+": 0x"+ep_states[a[1]].value.toString(16))},verbal:function(a){return"Print value of state "+a[1]+": 0x"+ep_states[a[1]].value.toString(16)+". "}};ep_components.CPU={name:"CPU",version:"1",abilities:["CPU"],details_name:["REGISTER_FILE","CONTROL_MEMORY","CLOCK","CPU_STATS"],details_fire:[["svg_p:text3029","svg_p:text3031"],["svg_cu:text3010"],["svg_p:text3459-7","svg_cu:text4138","svg_cu:text4138-7"],["svg_p:text3495"]],write_state:function(d){if(typeof d.CPU=="undefined"){d.CPU={}}var a=["PC","SR"];var e=0;for(var c=0;c<ep_states.BR.length;c++){e=parseInt(ep_states.BR[c].value);if(e!=0){d.CPU["R"+c]={type:"register",default_value:0,id:"R"+c,op:"=",value:"0x"+e.toString(16)}}}for(c=0;c<a.length;c++){e=parseInt(ep_states["REG_"+a[c]].value);if(e!=0){d.CPU[a[c]]={type:"register",default_value:0,id:a[c],op:"=",value:"0x"+e.toString(16)}}}return d},read_state:function(d,a){if(typeof d.CPU=="undefined"){d.CPU={}}var c=a.id.toUpperCase().trim();var e=parseInt(a.value).toString(16);if("REGISTER"==a.type.toUpperCase().trim()){d.CPU[c]={type:"register",default_value:0,id:c,op:a.condition,value:"0x"+e};return true}return false},get_state:function(c){var d=c.toUpperCase().trim();if(typeof ep_states["REG_"+d]!="undefined"){return"0x"+get_value(ep_states["REG_"+d]).toString(16)}d=d.replace("R","");var a=parseInt(d);if(typeof ep_states.BR[a]!="undefined"){return"0x"+get_value(ep_states.BR[a]).toString(16)}return null},get_value:function(a){if(Number.isInteger(a)){index=a}else{index=parseInt(a)}if(isNaN(index)){return(get_value(simhw_sim_state(a))>>>0)}return(get_value(simhw_sim_states().BR[index])>>>0)},set_value:function(c,d){var a=simhw_sim_ctrlStates_get().pc.state;if(Number.isInteger(c)){index=c}else{index=parseInt(c)}if(isNaN(index)){set_value(simhw_sim_state(c),d);if(a===c){show_asmdbg_pc()}return d}return set_value(simhw_sim_states().BR[index],d)}};ep_ctrl_states.pc={name:"PC",state:"REG_PC"};ep_ctrl_states.sp={name:"SP",state:"BR.29"};ep_ctrl_states.ir={name:"IR",state:"REG_IR",default_eltos:{co:{begin:0,end:5,length:6},cop:{begin:28,end:31,length:4}}};ep_ctrl_states.mpc={name:"mPC",state:"REG_MICROADDR"};ep_internal_states.MC={};ep_internal_states.MC_dashboard={};ep_internal_states.ROM={};ep_internal_states.FIRMWARE={};ep_internal_states.io_hash={};ep_internal_states.fire_stack=[];ep_internal_states.tri_state_names=["T1","T2","T3","T4","T5","T6","T7","T8","T9","T10","T11"];ep_internal_states.fire_visible={databus:false,internalbus:false};ep_internal_states.filter_states=["REG_IR_DECO,col-11","REG_IR,col-auto","REG_PC,col-auto","REG_MAR,col-auto","REG_MBR,col-auto","REG_RT1,col-auto","REG_RT2,col-auto","REG_RT3,col-auto","REG_SR,col-auto","REG_MICROADDR,col-auto"];ep_internal_states.filter_signals=["A0,0","B,0","C,0","SELA,5","SELB,5","SELC,2","SELCOP,0","MR,0","MC,0","C0,0","C1,0","C2,0","C3,0","C4,0","C5,0","C6,0","C7,0","T1,0","T2,0","T3,0","T4,0","T5,0","T6,0","T7,0","T8,0","T9,0","T10,0","T11,0","M1,0","M2,0","M7,0","MA,0","MB,0","SELP,0","LC,0","SE,0","SIZE,0","OFFSET,0","BW,0","R,0","W,0","TA,0","TD,0","IOR,0","IOW,0","TEST_I,0","TEST_U,0"];ep_internal_states.alu_flags={flag_n:0,flag_z:0,flag_v:0,flag_c:0};ep_states.BR=[];ep_states.BR[0]={name:"R0",verbal:"Register 0",visible:true,nbits:"32",value:0,default_value:0,draw_data:[]};ep_states.BR[1]={name:"R1",verbal:"Register 1",visible:true,nbits:"32",value:0,default_value:0,draw_data:[]};ep_states.BR[2]={name:"R2",verbal:"Register 2",visible:true,nbits:"32",value:0,default_value:0,draw_data:[]};ep_states.BR[3]={name:"R3",verbal:"Register 3",visible:true,nbits:"32",value:0,default_value:0,draw_data:[]};ep_states.BR[4]={name:"R4",verbal:"Register 4",visible:true,nbits:"32",value:0,default_value:0,draw_data:[]};ep_states.BR[5]={name:"R5",verbal:"Register 5",visible:true,nbits:"32",value:0,default_value:0,draw_data:[]};ep_states.BR[6]={name:"R6",verbal:"Register 6",visible:true,nbits:"32",value:0,default_value:0,draw_data:[]};ep_states.BR[7]={name:"R7",verbal:"Register 7",visible:true,nbits:"32",value:0,default_value:0,draw_data:[]};ep_states.BR[8]={name:"R8",verbal:"Register 8",visible:true,nbits:"32",value:0,default_value:0,draw_data:[]};ep_states.BR[9]={name:"R9",verbal:"Register 9",visible:true,nbits:"32",value:0,default_value:0,draw_data:[]};ep_states.BR[10]={name:"R10",verbal:"Register 10",visible:true,nbits:"32",value:0,default_value:0,draw_data:[]};ep_states.BR[11]={name:"R11",verbal:"Register 11",visible:true,nbits:"32",value:0,default_value:0,draw_data:[]};ep_states.BR[12]={name:"R12",verbal:"Register 12",visible:true,nbits:"32",value:0,default_value:0,draw_data:[]};ep_states.BR[13]={name:"R13",verbal:"Register 13",visible:true,nbits:"32",value:0,default_value:0,draw_data:[]};ep_states.BR[14]={name:"R14",verbal:"Register 14",visible:true,nbits:"32",value:0,default_value:0,draw_data:[]};ep_states.BR[15]={name:"R15",verbal:"Register 15",visible:true,nbits:"32",value:0,default_value:0,draw_data:[]};ep_states.BR[16]={name:"R16",verbal:"Register 16",visible:true,nbits:"32",value:0,default_value:0,draw_data:[]};ep_states.BR[17]={name:"R17",verbal:"Register 17",visible:true,nbits:"32",value:0,default_value:0,draw_data:[]};ep_states.BR[18]={name:"R18",verbal:"Register 18",visible:true,nbits:"32",value:0,default_value:0,draw_data:[]};ep_states.BR[19]={name:"R19",verbal:"Register 19",visible:true,nbits:"32",value:0,default_value:0,draw_data:[]};ep_states.BR[20]={name:"R20",verbal:"Register 20",visible:true,nbits:"32",value:0,default_value:0,draw_data:[]};ep_states.BR[21]={name:"R21",verbal:"Register 21",visible:true,nbits:"32",value:0,default_value:0,draw_data:[]};ep_states.BR[22]={name:"R22",verbal:"Register 22",visible:true,nbits:"32",value:0,default_value:0,draw_data:[]};ep_states.BR[23]={name:"R23",verbal:"Register 23",visible:true,nbits:"32",value:0,default_value:0,draw_data:[]};ep_states.BR[24]={name:"R24",verbal:"Register 24",visible:true,nbits:"32",value:0,default_value:0,draw_data:[]};ep_states.BR[25]={name:"R25",verbal:"Register 25",visible:true,nbits:"32",value:0,default_value:0,draw_data:[]};ep_states.BR[26]={name:"R26",verbal:"Register 26",visible:true,nbits:"32",value:0,default_value:0,draw_data:[]};ep_states.BR[27]={name:"R27",verbal:"Register 27",visible:true,nbits:"32",value:0,default_value:0,draw_data:[]};ep_states.BR[28]={name:"R28",verbal:"Register 28",visible:true,nbits:"32",value:0,default_value:0,draw_data:[]};ep_states.BR[29]={name:"R29",verbal:"Register 29",visible:true,nbits:"32",value:0,default_value:0,draw_data:[]};ep_states.BR[30]={name:"R30",verbal:"Register 30",visible:true,nbits:"32",value:0,default_value:0,draw_data:[]};ep_states.BR[31]={name:"R31",verbal:"Register 31",visible:true,nbits:"32",value:0,default_value:0,draw_data:[]};ep_states.REG_PC={name:"PC",verbal:"Program Counter Register",visible:true,nbits:"32",value:0,default_value:0,draw_data:[]};ep_states.REG_MAR={name:"MAR",verbal:"Memory Address Register",visible:true,nbits:"32",value:0,default_value:0,draw_data:[]};ep_states.REG_MBR={name:"MBR",verbal:"Memory Data Register",visible:true,nbits:"32",value:0,default_value:0,draw_data:[]};ep_states.REG_IR={name:"IR",verbal:"Instruction Register",visible:true,nbits:"32",value:0,default_value:0,draw_data:[]};ep_states.REG_RT1={name:"RT1",verbal:"Temporal 1 Register",visible:true,nbits:"32",value:0,default_value:0,draw_data:[]};ep_states.REG_RT2={name:"RT2",verbal:"Temporal 2 Register",visible:true,nbits:"32",value:0,default_value:0,draw_data:[]};ep_states.REG_RT3={name:"RT3",verbal:"Temporal 3 Register",visible:true,nbits:"32",value:0,default_value:0,draw_data:[]};ep_states.REG_SR={name:"SR",verbal:"State Register",visible:true,nbits:"32",value:0,default_value:0,draw_data:[]};ep_states.BUS_IB={name:"I_BUS",verbal:"Internal Bus",visible:false,nbits:"32",value:0,default_value:0,draw_data:[]};ep_states.BUS_AB={name:"A_BUS",verbal:"Address Bus",visible:false,nbits:"32",value:0,default_value:0,draw_data:[]};ep_states.BUS_CB={name:"C_BUS",verbal:"Control Bus",visible:false,nbits:"32",value:0,default_value:0,draw_data:[]};ep_states.BUS_DB={name:"D_BUS",verbal:"Data Bus",visible:false,nbits:"32",value:0,default_value:0,draw_data:[]};ep_states.C2_T2={name:"C2_T2",verbal:"Output of PC",visible:false,nbits:"32",value:0,default_value:0,draw_data:[]};ep_states.RA_T9={name:"RA_T9",verbal:"Input of T9 Tristate",visible:false,nbits:"32",value:0,default_value:0,draw_data:[]};ep_states.RB_T10={name:"RB_T10",verbal:"Input of T10 Tristate",visible:false,nbits:"32",value:0,default_value:0,draw_data:[]};ep_states.SELEC_T3={name:"SELEC_T3",verbal:"Input of T3 Tristate",visible:false,nbits:"32",value:0,default_value:0,draw_data:[]};ep_states.SELP_M7={name:"SELP_M7",verbal:"Output of MUX SelP",visible:false,nbits:"32",value:0,default_value:0,draw_data:[]};ep_states.ALU_C6={name:"ALU_C6",verbal:"Input of Temporal 3 Register",visible:false,nbits:"32",value:0,default_value:0,draw_data:[]};ep_states.MA_ALU={name:"MA_ALU",verbal:"Input ALU via MA",visible:false,nbits:"32",value:0,default_value:0,draw_data:[]};ep_states.MB_ALU={name:"MB_ALU",verbal:"Input ALU via MB",visible:false,nbits:"32",value:0,default_value:0,draw_data:[]};ep_states.FLAG_C={name:"FLAG_C",verbal:"Carry Flag",visible:true,nbits:"1",value:0,default_value:0,draw_data:[]};ep_states.FLAG_V={name:"FLAG_V",verbal:"Overflow Flag",visible:true,nbits:"1",value:0,default_value:0,draw_data:[]};ep_states.FLAG_N={name:"FLAG_N",verbal:"Negative Flag",visible:true,nbits:"1",value:0,default_value:0,draw_data:[]};ep_states.FLAG_Z={name:"FLAG_Z",verbal:"Zero Flag",visible:true,nbits:"1",value:0,default_value:0,draw_data:[]};ep_states.FLAG_I={name:"FLAG_I",verbal:"Interruption Flag",visible:true,nbits:"1",value:0,default_value:0,draw_data:[]};ep_states.FLAG_U={name:"FLAG_U",verbal:"User Flag",visible:true,nbits:"1",value:0,default_value:0,draw_data:[]};ep_states.REG_MICROADDR={name:"µADDR",verbal:"Microaddress Register",visible:true,nbits:"12",value:0,default_value:0,draw_data:["svg_cu:text4667"]};ep_states.REG_MICROINS={name:"µINS",verbal:"Microinstruction Register",visible:true,nbits:"77",value:{},default_value:{},draw_data:[]};ep_states.FETCH={name:"FETCH",verbal:"Input Fetch",visible:false,nbits:"12",value:0,default_value:0,draw_data:[]};ep_states.ROM_MUXA={name:"ROM_MUXA",verbal:"Input ROM",visible:false,nbits:"12",value:0,default_value:0,draw_data:[]};ep_states.SUM_ONE={name:"SUM_ONE",verbal:"Input next microinstruction",visible:false,nbits:"12",value:1,default_value:1,draw_data:[]};ep_states.MUXA_MICROADDR={name:"MUXA_MICROADDR",verbal:"Input microaddress",visible:false,nbits:"12",value:0,default_value:0,draw_data:[]};ep_states.MUXC_MUXB={name:"MUXC_MUXB",verbal:"Output of MUX C",visible:false,nbits:"1",value:0,default_value:0,draw_data:[]};ep_states.INEX={name:"INEX",verbal:"Illegal Instruction Exception",visible:false,nbits:"1",value:0,default_value:0,draw_data:[]};ep_states.BS_M1={name:"BS_M1",verbal:"from Memory",visible:false,nbits:"32",value:0,default_value:0,draw_data:[]};ep_states.BS_TD={name:"BS_TD",verbal:"Memory",visible:false,nbits:"32",value:0,default_value:0,draw_data:[]};ep_states.INTV={name:"INTV",verbal:"Interruption Vector",visible:false,nbits:"8",value:0,default_value:0,draw_data:[]};ep_states.M2_C2={name:"M2_C2",verbal:"Input of Program Counter",visible:false,nbits:"32",value:0,default_value:0,draw_data:[]};ep_states.M1_C1={name:"M1_C1",verbal:"Input of Memory Data Register",visible:false,nbits:"32",value:0,default_value:0,draw_data:[]};ep_states.M7_C7={name:"M7_C7",verbal:"Input of State Register",visible:false,nbits:"32",value:0,default_value:0,draw_data:[]};ep_states.VAL_ZERO={name:"VAL_ZERO",verbal:"Wired Zero",visible:false,nbits:"1",value:0,default_value:0,draw_data:[]};ep_states.VAL_ONE={name:"VAL_ONE",verbal:"Wired One",visible:false,nbits:"32",value:1,default_value:1,draw_data:[]};ep_states.VAL_FOUR={name:"VAL_FOUR",verbal:"Wired Four",visible:false,nbits:"32",value:4,default_value:4,draw_data:[]};ep_states.REG_IR_DECO={name:"IR_DECO",verbal:"Instruction Decoded",visible:true,nbits:"0",value:0,default_value:0,draw_data:[]};ep_states.DECO_INS={name:"DECO_INS",verbal:"Instruction decoded in binary",visible:true,nbits:"32",value:0,default_value:0,draw_data:[]};ep_states.CLK={name:"CLK",verbal:"Clock",visible:false,nbits:"32",value:0,default_value:0,draw_data:[]};ep_signals.C={name:"C",visible:true,type:"L",value:0,default_value:0,nbits:"4",behavior:["MV MUXC_MUXB VAL_ZERO; FIRE B","MBIT MUXC_MUXB INT 0 1; FIRE B","MBIT MUXC_MUXB IORDY 0 1; FIRE B","MBIT MUXC_MUXB MRDY 0 1; FIRE B","MBIT MUXC_MUXB REG_SR 0 1; FIRE B","MBIT MUXC_MUXB REG_SR 1 1; FIRE B","MBIT MUXC_MUXB REG_SR 28 1; FIRE B","MBIT MUXC_MUXB REG_SR 29 1; FIRE B","MBIT MUXC_MUXB REG_SR 30 1; FIRE B","MBIT MUXC_MUXB REG_SR 31 1; FIRE B","MV MUXC_MUXB INEX; FIRE B"],fire_name:["svg_cu:text3410"],draw_data:[["svg_cu:path3108"],["svg_cu:path3062"],["svg_cu:path3060"],["svg_cu:path3136"],["svg_cu:path3482"],["svg_cu:path3480"],["svg_cu:path3488"],["svg_cu:path3486"],["svg_cu:path3484"],["svg_cu:path3484-9"],["svg_cu:path3108-3","svg_cu:path3260-3-8-6","svg_cu:path3260-3-8","svg_cu:path3260-3"]],draw_name:[["svg_cu:path3496","svg_cu:path3414","svg_cu:path3194-08"]]};ep_signals.B={name:"B",visible:true,type:"L",value:0,default_value:0,nbits:"1",behavior:["MV A1 MUXC_MUXB; FIRE A1","NOT_ES A1 MUXC_MUXB; FIRE A1"],depends_on:["CLK"],fire_name:["svg_cu:text3408"],draw_data:[["svg_cu:path3094-7"],["svg_cu:path3392","svg_cu:path3372","svg_cu:path3390","svg_cu:path3384","svg_cu:path3108-1","svg_cu:path3100-8-7"]],draw_name:[[],["svg_cu:path3194-0","svg_cu:path3138-8","svg_cu:path3498-6"]]};ep_signals.A0={name:"A0",visible:false,type:"L",value:0,default_value:0,nbits:"1",behavior:["SBIT_SIGNAL A0A1 0 1; FIRE A0A1","SBIT_SIGNAL A0A1 1 1; FIRE A0A1"],depends_on:["CLK"],fire_name:["svg_cu:text3406"],draw_data:[["svg_cu:path3096"],["svg_cu:path3096"]],draw_name:[[],["svg_cu:path3138-8-1","svg_cu:path3098-2","svg_cu:path3124-2-5"]]};ep_signals.A1={name:"A1",visible:false,type:"L",value:0,default_value:0,nbits:"1",behavior:["SBIT_SIGNAL A0A1 0 0; FIRE A0A1","SBIT_SIGNAL A0A1 1 0; FIRE A0A1"],depends_on:["CLK"],fire_name:[],draw_data:[["svg_cu:path3094"],["svg_cu:path3094"]],draw_name:[[]]};ep_signals.A0A1={name:"A0A1",visible:true,type:"L",value:0,default_value:0,nbits:"2",behavior:["PLUS1 MUXA_MICROADDR REG_MICROADDR","CP_FIELD MUXA_MICROADDR REG_MICROINS/MADDR","MV MUXA_MICROADDR ROM_MUXA","MV MUXA_MICROADDR FETCH"],depends_on:["CLK"],fire_name:[],draw_data:[["svg_cu:path3102","svg_cu:path3100","svg_cu:path3098","svg_cu:path3100-9","svg_cu:path3088"],["svg_cu:path3104","svg_cu:path3134","svg_cu:path3500","svg_cu:path3416"],["svg_cu:path3504","svg_cu:path3100-8","svg_cu:path3234-9"],["svg_cu:path3124"]],draw_name:[[]]};ep_signals.C0={name:"C0",visible:true,type:"E",value:0,default_value:0,nbits:"1",behavior:["NOP","LOAD REG_MAR BUS_IB"],fire_name:["svg_p:text3077"],draw_data:[["svg_p:path3081"]],draw_name:[["svg_p:path3075"]]};ep_signals.C1={name:"C1",visible:true,type:"E",value:0,default_value:0,nbits:"1",behavior:["NOP","LOAD REG_MBR M1_C1"],fire_name:["svg_p:text3079"],draw_data:[["svg_p:path3055"]],draw_name:[["svg_p:path3073"]]};ep_signals.C2={name:"C2",visible:true,type:"E",value:0,default_value:0,nbits:"1",behavior:["NOP","LOAD REG_PC M2_C2; UPDATEDPC"],fire_name:["svg_p:text3179"],draw_data:[["svg_p:path3485"]],draw_name:[["svg_p:path3177"]]};ep_signals.C3={name:"C3",visible:true,type:"E",value:0,default_value:0,nbits:"1",behavior:["NOP","LOAD REG_IR BUS_IB; DECO; FIRE_IFSET C 10"],fire_name:["svg_p:text3439"],draw_data:[["svg_p:path3339"]],draw_name:[["svg_p:path3337"]]};ep_signals.C4={name:"C4",visible:true,type:"E",value:0,default_value:0,nbits:"1",behavior:["NOP","LOAD REG_RT1 BUS_IB"],fire_name:["svg_p:text3441"],draw_data:[["svg_p:path3263"]],draw_name:[["svg_p:path3255"]]};ep_signals.C5={name:"C5",visible:true,type:"E",value:0,default_value:0,nbits:"1",behavior:["NOP","LOAD REG_RT2 BUS_IB"],fire_name:["svg_p:text3443"],draw_data:[["svg_p:path3277"]],draw_name:[["svg_p:path3269"]]};ep_signals.C6={name:"C6",visible:true,type:"E",value:0,default_value:0,nbits:"1",behavior:["NOP","LOAD REG_RT3 ALU_C6"],fire_name:["svg_p:text3445"],draw_data:[["svg_p:path3325","svg_p:path3323"]],draw_name:[["svg_p:path3245"]]};ep_signals.C7={name:"C7",visible:true,type:"E",value:0,default_value:0,nbits:"1",behavior:["NOP","LOAD REG_SR M7_C7; FIRE C"],fire_name:["svg_p:text3655"],draw_data:[["svg_p:path3651-9"]],draw_name:[["svg_p:path3681"]]};ep_signals.TA={name:"TA",visible:true,type:"L",value:0,default_value:0,nbits:"1",behavior:["NOP","MV BUS_AB REG_MAR; MOVE_BITSE A1A0 0 2 BUS_AB 0; FIRE_IFCHANGED A1A0 A1A0"],fire_name:["svg_p:text3091"],draw_data:[["svg_p:path3089","svg_p:path3597","svg_p:path3513","svg_p:path3601","svg_p:path3601-2","svg_p:path3187","svg_p:path3087","svg_p:path2995","svg_p:path3535"]],draw_name:[["svg_p:path3085"]]};ep_signals.TD={name:"TD",visible:true,type:"L",value:0,default_value:0,nbits:"1",behavior:["NOP","MV BUS_DB BS_TD; MOVE_BITSE A1A0 0 2 BUS_AB 0; FIRE_IFCHANGED A1A0 A1A0"],fire_name:["svg_p:text3103"],draw_data:[["svg_p:path3101","svg_p:path3587","svg_p:path3515","svg_p:path3071","svg_p:path3419","svg_p:path3099","svg_p:path3097","svg_p:path3559-5","svg_p:path3419-1-0","svg_p:path3583","svg_p:path3419-1","svg_p:path3491","svg_p:path3641","svg_p:path3541"]],draw_name:[["svg_p:path3095"]]};ep_signals.T1={name:"T1",visible:true,type:"L",value:0,default_value:0,nbits:"1",behavior:["NOP","MV BUS_IB REG_MBR; FIRE M7; FIRE M2; FIRE M1"],fire_name:["svg_p:text3105"],draw_data:[["svg_p:path3071","svg_p:path3069","svg_p:path3049","svg_p:path3063-9","svg_p:path3071","svg_p:path3071"]],draw_name:[["svg_p:path3067"]]};ep_signals.T2={name:"T2",visible:true,type:"L",value:0,default_value:0,nbits:"1",behavior:["NOP","MV BUS_IB REG_PC; FIRE M7; FIRE M2; FIRE M1"],fire_name:["svg_p:text3449"],draw_data:[["svg_p:path3199","svg_p:path3201","svg_p:path3049"]],draw_name:[["svg_p:path3329"]]};ep_signals.T3={name:"T3",visible:true,type:"L",value:0,default_value:0,nbits:"1",behavior:["NOP","MV BUS_IB SELEC_T3; FIRE M7; FIRE M2; FIRE M1"],fire_name:["svg_p:text3451"],draw_data:[["svg_p:path3349","svg_p:path3931","svg_p:path3345","svg_p:path3049"]],draw_name:[["svg_p:path3351"]]};ep_signals.T4={name:"T4",visible:true,type:"L",value:0,default_value:0,nbits:"1",behavior:["NOP","MV BUS_IB REG_RT1; FIRE M7; FIRE M2; FIRE M1"],fire_name:["svg_p:text3453"],draw_data:[["svg_p:path3261","svg_p:path3259","svg_p:path3049"]],draw_name:[["svg_p:path3305"]]};ep_signals.T5={name:"T5",visible:true,type:"L",value:0,default_value:0,nbits:"1",behavior:["NOP","MV BUS_IB REG_RT2; FIRE M7; FIRE M2; FIRE M1"],fire_name:["svg_p:text3455"],draw_data:[["svg_p:path3275","svg_p:path3273","svg_p:path3049"]],draw_name:[["svg_p:path3307"]]};ep_signals.T6={name:"T6",visible:true,type:"L",value:0,default_value:0,nbits:"1",behavior:["NOP","MV BUS_IB ALU_C6; FIRE M7; FIRE M2; FIRE M1"],fire_name:["svg_p:text3457"],draw_data:[["svg_p:path3589","svg_p:path3317","svg_p:path3163-2","svg_p:path3049"]],draw_name:[["svg_p:path3319"]]};ep_signals.T7={name:"T7",visible:true,type:"L",value:0,default_value:0,nbits:"1",behavior:["NOP","MV BUS_IB REG_RT3; FIRE M7; FIRE M2; FIRE M1"],fire_name:["svg_p:text3459"],draw_data:[["svg_p:path3327","svg_p:path3311","svg_p:path3049"]],draw_name:[["svg_p:path3313"]]};ep_signals.T8={name:"T8",visible:true,type:"L",value:0,default_value:0,nbits:"1",behavior:["NOP","MV BUS_IB REG_SR; FIRE M7; FIRE M2; FIRE M1"],fire_name:["svg_p:text3657"],draw_data:[["svg_p:path3651","svg_p:path3647","svg_p:path3049"]],draw_name:[["svg_p:path3649"]]};ep_signals.T9={name:"T9",visible:true,type:"L",value:0,default_value:0,nbits:"1",behavior:["NOP","MV BUS_IB RA_T9; FIRE M7; FIRE M2; FIRE M1"],fire_name:["svg_p:text3147"],draw_data:[["svg_p:path3143","svg_p:path3139","svg_p:path3049","svg_p:path3143-9"]],draw_name:[["svg_p:path3133"]]};ep_signals.T10={name:"T10",visible:true,type:"L",value:0,default_value:0,nbits:"1",behavior:["NOP","MV BUS_IB RB_T10; FIRE M7; FIRE M2; FIRE M1"],fire_name:["svg_p:text3149"],draw_data:[["svg_p:path3145","svg_p:path3141","svg_p:path3049","svg_p:path3145-5"]],draw_name:[["svg_p:path3137"]]};ep_signals.T11={name:"T11",visible:true,type:"L",value:0,default_value:0,nbits:"1",behavior:["NOP","CP_FIELD BUS_IB REG_MICROINS/EXCODE; FIRE M7; FIRE M2; FIRE M1"],fire_name:["svg_p:text3147-5","svg_cu:tspan4426"],draw_data:[["svg_p:path3145","svg_p:path3081-3","svg_p:path3139-7","svg_p:path3049","svg_cu:path3081-3","svg_cu:path3139-7","svg_cu:path3502"]],draw_name:[["svg_p:path3133-6","svg_cu:path3133-6"]]};ep_signals.M1={name:"M1",visible:true,type:"L",value:0,default_value:0,nbits:"1",behavior:["MV M1_C1 BUS_IB","MV M1_C1 BS_M1"],depends_on:["C1"],fire_name:["svg_p:text3469"],draw_data:[["svg_p:path3063","svg_p:path3061","svg_p:path3059"],["svg_p:path3057","svg_p:path3641","svg_p:path3419","svg_p:path3583"]],draw_name:[[],["svg_p:path3447"]]};ep_signals.M2={name:"M2",visible:true,type:"L",value:0,default_value:0,nbits:"1",behavior:["MV M2_C2 BUS_IB","PLUS4 M2_C2 REG_PC"],depends_on:["C2"],fire_name:["svg_p:text3471"],draw_data:[["svg_p:path3217","svg_p:path3215","svg_p:path3213","svg_p:path3213-9"],["svg_p:path3211","svg_p:path3209","svg_p:path3193","svg_p:path3207","svg_p:path3197","svg_p:path3201"]],draw_name:[[],["svg_p:path3467","svg_p:path3467"]]};ep_signals.M7={name:"M7",visible:true,type:"L",value:0,default_value:0,nbits:"1",behavior:["MV M7_C7 BUS_IB","MV M7_C7 SELP_M7"],depends_on:["C7"],fire_name:["svg_p:text3673"],draw_data:[["svg_p:path3691","svg_p:path3693","svg_p:path3659"],["svg_p:path3695"]],draw_name:[[],["svg_p:path3667"]]};ep_signals.MA={name:"MA",visible:true,type:"L",value:0,default_value:0,nbits:"1",behavior:["MV MA_ALU RA_T9; FIRE COP","MV MA_ALU REG_RT1; FIRE COP"],depends_on:["SELA","SELB"],fire_name:["svg_p:text3463"],draw_data:[["svg_p:path3249","svg_p:path3161","svg_p:path3165"],["svg_p:path3279"]],draw_name:[[],["svg_p:path3423"]]};ep_signals.MB={name:"MB",visible:true,type:"L",value:0,default_value:0,nbits:"2",behavior:["MV MB_ALU RB_T10; FIRE COP","MV MB_ALU REG_RT2; FIRE COP","MV MB_ALU VAL_FOUR; FIRE COP","MV MB_ALU VAL_ONE; FIRE COP"],depends_on:["SELA","SELB"],fire_name:["svg_p:text3465"],draw_data:[["svg_p:path3281","svg_p:path3171","svg_p:path3169"],["svg_p:path3283"],["svg_p:path3295","svg_p:path3293"],["svg_p:path3297","svg_p:path3299"]],draw_name:[[],["svg_p:path3425","svg_p:path3427"]]};ep_signals.COP={name:"COP",visible:true,type:"L",value:0,default_value:0,nbits:"4",forbidden:true,behavior:["NOP_ALU; UPDATE_NZVC","AND ALU_C6 MA_ALU MB_ALU; UPDATE_NZVC; FIRE_IFSET T6 1; FIRE_IFSET SELP 3","OR ALU_C6 MA_ALU MB_ALU; UPDATE_NZVC; FIRE_IFSET T6 1; FIRE_IFSET SELP 3","NOT ALU_C6 MA_ALU; UPDATE_NZVC; FIRE_IFSET T6 1; FIRE_IFSET SELP 3","XOR ALU_C6 MA_ALU MB_ALU; UPDATE_NZVC; FIRE_IFSET T6 1; FIRE_IFSET SELP 3","SRL ALU_C6 MA_ALU; UPDATE_NZVC; FIRE_IFSET T6 1; FIRE_IFSET SELP 3","SRA ALU_C6 MA_ALU; UPDATE_NZVC; FIRE_IFSET T6 1; FIRE_IFSET SELP 3","SL ALU_C6 MA_ALU; UPDATE_NZVC; FIRE_IFSET T6 1; FIRE_IFSET SELP 3","RR ALU_C6 MA_ALU; UPDATE_NZVC; FIRE_IFSET T6 1; FIRE_IFSET SELP 3","RL ALU_C6 MA_ALU; UPDATE_NZVC; FIRE_IFSET T6 1; FIRE_IFSET SELP 3","ADD ALU_C6 MA_ALU MB_ALU; UPDATE_NZVC; FIRE_IFSET T6 1; FIRE_IFSET SELP 3","SUB ALU_C6 MA_ALU MB_ALU; UPDATE_NZVC; FIRE_IFSET T6 1; FIRE_IFSET SELP 3","MUL ALU_C6 MA_ALU MB_ALU; UPDATE_NZVC; FIRE_IFSET T6 1; FIRE_IFSET SELP 3","DIV ALU_C6 MA_ALU MB_ALU; UPDATE_NZVC; FIRE_IFSET T6 1; FIRE_IFSET SELP 3","MOD ALU_C6 MA_ALU MB_ALU; UPDATE_NZVC; FIRE_IFSET T6 1; FIRE_IFSET SELP 3","LUI ALU_C6 MA_ALU; UPDATE_NZVC; FIRE_IFSET T6 1; FIRE_IFSET SELP 3"],depends_on:["SELCOP"],fire_name:["svg_p:text3303"],draw_data:[["svg_p:path3237","svg_p:path3239","svg_p:path3261-8","svg_p:path3321","svg_p:path3901-6","svg_p:path3317-9"]],draw_name:[["svg_p:path3009","svg_p:path3301"]]};ep_signals.SELP={name:"SELP",visible:true,type:"L",value:0,default_value:0,nbits:"2",behavior:["NOP","MV SELP_M7 REG_SR; UPDATE_FLAG SELP_M7 FLAG_U 0; FIRE M7","MV SELP_M7 REG_SR; UPDATE_FLAG SELP_M7 FLAG_I 1; FIRE M7","MV SELP_M7 REG_SR; UPDATE_FLAG SELP_M7 FLAG_C 31; UPDATE_FLAG SELP_M7 FLAG_V 30; UPDATE_FLAG SELP_M7 FLAG_N 29; UPDATE_FLAG SELP_M7 FLAG_Z 28; FIRE M7"],fire_name:["svg_p:text3703"],draw_data:[[],["svg_p:path3643"],["svg_p:path3705"],["svg_p:path3675","svg_p:path3331"]],draw_name:[[],["svg_p:path3697"]]};ep_signals.SELA={name:"SELA",visible:true,type:"L",value:0,default_value:0,nbits:"5",behavior:["FIRE MR_RA"],depends_on:["RA"],fire_name:["svg_cu:text3164"],draw_data:[[]],draw_name:[[]]};ep_signals.SELB={name:"SELB",visible:true,type:"L",value:0,default_value:0,nbits:"5",behavior:["FIRE MR_RB"],depends_on:["RB"],fire_name:["svg_cu:text3168"],draw_data:[[]],draw_name:[[]]};ep_signals.SELC={name:"SELC",visible:true,type:"L",value:0,default_value:0,nbits:"5",behavior:["FIRE MR_RC"],depends_on:["RC"],fire_name:["svg_cu:text3172"],draw_data:[[]],draw_name:[[]]};ep_signals.SELCOP={name:"SELCOP",visible:true,type:"L",value:0,default_value:0,nbits:"4",behavior:["FIRE MC"],depends_on:["COP"],fire_name:["svg_cu:text3312"],draw_data:[[]],draw_name:[[]]};ep_signals.EXCODE={name:"EXCODE",visible:true,type:"L",value:0,default_value:0,nbits:"4",behavior:["FIRE T11"],fire_name:["svg_cu:text3312-6"],draw_data:[[]],draw_name:[[]]};ep_signals.RA={name:"RA",visible:true,type:"L",value:0,default_value:0,nbits:"5",forbidden:true,behavior:["GET RA_T9 BR RA; FIRE_IFSET T9 1; FIRE_IFSET MA 0"],depends_on:["SELA"],fire_name:["svg_p:text3107"],draw_data:[[]],draw_name:[["svg_p:path3109"]]};ep_signals.RB={name:"RB",visible:true,type:"L",value:0,default_value:0,nbits:"5",forbidden:true,behavior:["GET RB_T10 BR RB; FIRE_IFSET T10 1; FIRE_IFSET MB 0"],depends_on:["SELB"],fire_name:["svg_p:text3123"],draw_data:[[]],draw_name:[["svg_p:path3113"]]};ep_signals.RC={name:"RC",visible:true,type:"L",value:0,default_value:0,nbits:"5",forbidden:true,behavior:["FIRE LC"],depends_on:["SELC"],fire_name:["svg_p:text3125"],draw_data:[[]],draw_name:[["svg_p:path3117"]]};ep_signals.LC={name:"LC",visible:true,type:"E",value:0,default_value:0,nbits:"1",behavior:["NOP","SET BR RC BUS_IB"],fire_name:["svg_p:text3127"],draw_data:[["svg_p:path3153","svg_p:path3151","svg_p:path3129"]],draw_name:[["svg_p:path3121"]]};ep_signals.SE={name:"SE",visible:true,type:"L",value:0,default_value:0,nbits:"1",behavior:["MBITS SELEC_T3 0 REG_IR OFFSET SIZE 0 SE; FIRE T3; MOVE_BITS SBWA 4 1 SE; FIRE_IFCHANGED SBWA SE","MBITS SELEC_T3 0 REG_IR OFFSET SIZE 0 SE; FIRE T3; MOVE_BITS SBWA 4 1 SE; FIRE_IFCHANGED SBWA SE"],depends_on:["T3"],fire_name:["svg_p:text3593","svg_p:text3431"],draw_data:[[]],draw_name:[["svg_p:path3591","svg_p:path3447-7-7"]]};ep_signals.SIZE={name:"SIZE",visible:true,type:"L",value:0,default_value:0,nbits:"5",behavior:["MBITS SELEC_T3 0 REG_IR OFFSET SIZE 0 SE; FIRE T3"],depends_on:["T3"],fire_name:["svg_p:text3363"],draw_data:[[]],draw_name:[["svg_p:path3355"]]};ep_signals.OFFSET={name:"OFFSET",visible:true,type:"L",value:0,default_value:0,nbits:"5",behavior:["MBITS SELEC_T3 0 REG_IR OFFSET SIZE 0 SE; FIRE T3"],depends_on:["T3"],fire_name:["svg_p:text3707"],draw_data:[[]],draw_name:[["svg_p:path3359"]]};ep_signals.MC={name:"MC",visible:true,type:"L",value:0,default_value:0,nbits:"1",behavior:["MBIT COP REG_IR 0 4; FIRE COP;","CP_FIELD COP REG_MICROINS/SELCOP; FIRE COP;"],depends_on:["SELCOP"],fire_name:["svg_cu:text3322","svg_cu:text3172-1-5"],draw_data:[["svg_cu:path3320","svg_cu:path3142"],["svg_cu:path3318","svg_cu:path3502-6","svg_cu:path3232-6"]],draw_name:[[],["svg_cu:path3306"]]};ep_signals.MR={name:"MR",verbal:["Copy from IR[SelA], from IR[SelB], and from IR[SelB] into RA, RB, and RC. ","Copy SelA, SelB, and SelB into RA, RB, and RC. "],visible:true,type:"L",value:0,default_value:0,nbits:"1",behavior:["MV MR_RA MR; FIRE MR_RA; MV MR_RB MR; FIRE MR_RB; MV MR_RC MR; FIRE MR_RC;","MV MR_RA MR; FIRE MR_RA; MV MR_RB MR; FIRE MR_RB; MV MR_RC MR; FIRE MR_RC;"],depends_on:["SELA","SELB","SELC"],fire_name:["svg_cu:text3222","svg_cu:text3242","svg_cu:text3254","svg_cu:text3172-1"],draw_data:[["svg_cu:path3494","svg_cu:path3492","svg_cu:path3490","svg_cu:path3142b","svg_cu:path3188","svg_cu:path3190","svg_cu:path3192","svg_cu:path3194","svg_cu:path3276","svg_cu:path3290","svg_cu:path3260","svg_cu:path3196","svg_cu:path3278","svg_cu:path3232","svg_cu:path3292"],["svg_cu:path3270","svg_cu:path3282","svg_cu:path3300","svg_cu:path3258","svg_cu:path3260","svg_cu:path3258-4","svg_cu:path3278","svg_cu:path3196","svg_cu:path3294","svg_cu:path3292","svg_cu:path3288","svg_cu:path3232","svg_cu:path3280"]],draw_name:[[],["svg_cu:path3220","svg_cu:path3240","svg_cu:path3252"]]};ep_signals.MR_RA={name:"MR_RA",visible:true,type:"L",value:0,default_value:0,nbits:"1",behavior:["MBIT_SN RA REG_IR REG_MICROINS/SELA 5; FIRE RA;","CP_FIELD RA REG_MICROINS/SELA; FIRE RA;"],fire_name:[],draw_data:[[]],draw_name:[[]]};ep_signals.MR_RB={name:"MR_RB",visible:true,type:"L",value:0,default_value:0,nbits:"1",behavior:["MBIT_SN RB REG_IR REG_MICROINS/SELB 5; FIRE RB;","CP_FIELD RB REG_MICROINS/SELB; FIRE RB;"],fire_name:[],draw_data:[[]],draw_name:[[]]};ep_signals.MR_RC={name:"MR_RC",visible:true,type:"L",value:0,default_value:0,nbits:"1",behavior:["MBIT_SN RC REG_IR REG_MICROINS/SELC 5; FIRE RC;","CP_FIELD RC REG_MICROINS/SELC; FIRE RC;"],fire_name:[],draw_data:[[]],draw_name:[[]]};ep_signals.BW={name:"BW",verbal:["Select one byte (based on A1A0) from Word. ","Select two bytes (one Half Word based on A1A0) from Word. ","","Select the full Word. "],visible:true,type:"L",value:0,default_value:0,nbits:"2",behavior:["MOVE_BITS BWA 2 2 BW; MOVE_BITS SBWA 2 2 BW; FIRE_IFCHANGED BWA BW; FIRE SBWA; RESET_CHANGED BW","MOVE_BITS BWA 2 2 BW; MOVE_BITS SBWA 2 2 BW; FIRE_IFCHANGED BWA BW; FIRE SBWA; RESET_CHANGED BW","MOVE_BITS BWA 2 2 BW; MOVE_BITS SBWA 2 2 BW; FIRE_IFCHANGED BWA BW; FIRE SBWA; RESET_CHANGED BW","MOVE_BITS BWA 2 2 BW; MOVE_BITS SBWA 2 2 BW; FIRE_IFCHANGED BWA BW; FIRE SBWA; RESET_CHANGED BW"],fire_name:["svg_p:text3433"],draw_data:[["svg_p:path3061-2-6","svg_p:path3101-8","svg_p:path3535-8"]],draw_name:[[],[]]};ep_signals.A1A0={name:"A1A0",visible:true,type:"L",value:0,default_value:0,nbits:"2",behavior:["MOVE_BITS BWA 0 2 A1A0; MOVE_BITS SBWA 0 2 A1A0; FIRE BWA; FIRE SBWA","MOVE_BITS BWA 0 2 A1A0; MOVE_BITS SBWA 0 2 A1A0; FIRE BWA; FIRE SBWA","MOVE_BITS BWA 0 2 A1A0; MOVE_BITS SBWA 0 2 A1A0; FIRE BWA; FIRE SBWA","MOVE_BITS BWA 0 2 A1A0; MOVE_BITS SBWA 0 2 A1A0; FIRE BWA; FIRE SBWA"],fire_name:["svg_p:text3603"],draw_data:[[],[]],draw_name:[[],[]]};ep_signals.BWA={name:"BWA",visible:false,type:"L",value:0,default_value:0,nbits:"4",behavior:["BSEL BS_TD 0 8 REG_MBR 0; FIRE TD; FIRE R; FIRE W","BSEL BS_TD 8 8 REG_MBR 0; FIRE TD; FIRE R; FIRE W","BSEL BS_TD 16 8 REG_MBR 0; FIRE TD; FIRE R; FIRE W","BSEL BS_TD 24 8 REG_MBR 0; FIRE TD; FIRE R; FIRE W","BSEL BS_TD 0 16 REG_MBR 0; FIRE TD; FIRE R; FIRE W","BSEL BS_TD 0 16 REG_MBR 0; FIRE TD; FIRE R; FIRE W","BSEL BS_TD 0 16 REG_MBR 0; FIRE TD; FIRE R; FIRE W","BSEL BS_TD 0 16 REG_MBR 0; FIRE TD; FIRE R; FIRE W","BSEL BS_TD 16 16 REG_MBR 0; FIRE TD; FIRE R; FIRE W","BSEL BS_TD 16 16 REG_MBR 0; FIRE TD; FIRE R; FIRE W","BSEL BS_TD 16 16 REG_MBR 0; FIRE TD; FIRE R; FIRE W","BSEL BS_TD 16 16 REG_MBR 0; FIRE TD; FIRE R; FIRE W","MV BS_TD REG_MBR; FIRE TD; FIRE R; FIRE W","MV BS_TD REG_MBR; FIRE TD; FIRE R; FIRE W","MV BS_TD REG_MBR; FIRE TD; FIRE R; FIRE W","MV BS_TD REG_MBR; FIRE TD; FIRE R; FIRE W"],fire_name:["svg_p:text3533-5"],draw_data:[[],[]],draw_name:[[],[]]};ep_signals.SBWA={name:"SBWA",visible:false,type:"L",value:0,default_value:0,nbits:"5",behavior:["BSEL BS_M1 0 8 BUS_DB 0; FIRE M1","BSEL BS_M1 0 8 BUS_DB 8; FIRE M1","BSEL BS_M1 0 8 BUS_DB 16; FIRE M1","BSEL BS_M1 0 8 BUS_DB 24; FIRE M1","BSEL BS_M1 0 16 BUS_DB 0; FIRE M1","BSEL BS_M1 0 16 BUS_DB 0; FIRE M1","BSEL BS_M1 0 16 BUS_DB 0; FIRE M1","BSEL BS_M1 0 16 BUS_DB 0; FIRE M1","BSEL BS_M1 0 16 BUS_DB 16; FIRE M1","BSEL BS_M1 0 16 BUS_DB 16; FIRE M1","BSEL BS_M1 0 16 BUS_DB 16; FIRE M1","BSEL BS_M1 0 16 BUS_DB 16; FIRE M1","MV BS_M1 BUS_DB; FIRE M1","MV BS_M1 BUS_DB; FIRE M1","MV BS_M1 BUS_DB; FIRE M1","MV BS_M1 BUS_DB; FIRE M1","BSEL BS_M1 0 8 BUS_DB 0; EXT_SIG BS_M1 7; FIRE M1","BSEL BS_M1 0 8 BUS_DB 8; EXT_SIG BS_M1 7; FIRE M1","BSEL BS_M1 0 8 BUS_DB 16; EXT_SIG BS_M1 7; FIRE M1","BSEL BS_M1 0 8 BUS_DB 24; EXT_SIG BS_M1 7; FIRE M1","BSEL BS_M1 0 16 BUS_DB 0; EXT_SIG BS_M1 15; FIRE M1","BSEL BS_M1 0 16 BUS_DB 0; EXT_SIG BS_M1 15; FIRE M1","BSEL BS_M1 0 16 BUS_DB 0; EXT_SIG BS_M1 15; FIRE M1","BSEL BS_M1 0 16 BUS_DB 0; EXT_SIG BS_M1 15; FIRE M1","BSEL BS_M1 0 16 BUS_DB 16; EXT_SIG BS_M1 15; FIRE M1","BSEL BS_M1 0 16 BUS_DB 16; EXT_SIG BS_M1 15; FIRE M1","BSEL BS_M1 0 16 BUS_DB 16; EXT_SIG BS_M1 15; FIRE M1","BSEL BS_M1 0 16 BUS_DB 16; EXT_SIG BS_M1 15; FIRE M1","MV BS_M1 BUS_DB; FIRE M1","MV BS_M1 BUS_DB; FIRE M1","MV BS_M1 BUS_DB; FIRE M1","MV BS_M1 BUS_DB; FIRE M1"],fire_name:[],draw_data:[[],[]],draw_name:[[],[]]};ep_signals.IOR={name:"IOR",visible:true,type:"L",value:0,default_value:0,nbits:"1",behavior:["NOP","MOVE_BITS KBD_IOR 0 1 IOR; MOVE_BITS SCR_IOR 0 1 IOR; FIRE KBD_IOR; FIRE SCR_IOR"],fire_name:["svg_p:text3715"],draw_data:[[],["svg_p:path3733","svg_p:path3491","svg_p:text3715"]],draw_name:[[],[]]};ep_signals.IOW={name:"IOW",visible:true,type:"L",value:0,default_value:0,nbits:"1",behavior:["NOP","MOVE_BITS SCR_IOW 0 1 IOW; FIRE SCR_IOW; MOVE_BITS IO_IOW 0 1 IOW; FIRE IO_IOW"],fire_name:["svg_p:text3717"],draw_data:[[],["svg_p:path3735","svg_p:path3491","svg_p:text3717"]],draw_name:[[],[]]};ep_signals.I={name:"I",visible:true,type:"L",value:0,default_value:0,nbits:"1",behavior:["MV FLAG_I VAL_ZERO; FIRE_IFSET SELP 2","MV FLAG_I VAL_ONE; FIRE_IFSET SELP 2"],fire_name:[],draw_data:[[],[]],draw_name:[[],[]]};ep_signals.U={name:"U",visible:true,type:"L",value:0,default_value:0,nbits:"1",behavior:["MV FLAG_U VAL_ZERO; FIRE_IFSET SELP 2","MV FLAG_U VAL_ONE; FIRE_IFSET SELP 2"],fire_name:[],draw_data:[[],[]],draw_name:[[],[]]};ep_signals.TEST_C={name:"TEST_C",visible:true,type:"L",value:0,default_value:0,nbits:"1",forbidden:true,behavior:["MV FLAG_C VAL_ZERO; FIRE_IFSET SELP 2","MV FLAG_C VAL_ONE; FIRE_IFSET SELP 3"],depends_on:["SELCOP","COP"],fire_name:["svg_p:text3701-3"],draw_data:[["svg_p:text3701-3"]],draw_name:[[]]};ep_signals.TEST_V={name:"TEST_V",visible:true,type:"L",value:0,default_value:0,nbits:"1",forbidden:true,behavior:["MV FLAG_V VAL_ZERO; FIRE_IFSET SELP 2","MV FLAG_V VAL_ONE; FIRE_IFSET SELP 3"],depends_on:["SELCOP","COP"],fire_name:["svg_p:text3701-3-1"],draw_data:[["svg_p:text3701-3-1"]],draw_name:[[]]};ep_signals.TEST_N={name:"TEST_N",visible:true,type:"L",value:0,default_value:0,nbits:"1",forbidden:true,behavior:["MV FLAG_N VAL_ZERO; FIRE_IFSET SELP 2","MV FLAG_N VAL_ONE; FIRE_IFSET SELP 3"],depends_on:["SELCOP","COP"],fire_name:["svg_p:text3701-3-2"],draw_data:[["svg_p:text3701-3-2"]],draw_name:[[]]};ep_signals.TEST_Z={name:"TEST_Z",visible:true,type:"L",value:0,default_value:0,nbits:"1",forbidden:true,behavior:["MV FLAG_Z VAL_ZERO; FIRE_IFSET SELP 2","MV FLAG_Z VAL_ONE; FIRE_IFSET SELP 3"],depends_on:["SELCOP","COP"],fire_name:["svg_p:text3701-3-5"],draw_data:[["svg_p:text3701-3-5"]],draw_name:[[]]};ep_signals.TEST_I={name:"TEST_I",visible:true,type:"L",value:0,default_value:0,nbits:"1",behavior:["MV FLAG_I VAL_ZERO; FIRE_IFSET SELP 2","MV FLAG_I VAL_ONE; FIRE_IFSET SELP 2"],depends_on:["CLK"],fire_name:["svg_p:text3669"],draw_data:[["svg_p:text3669"]],draw_name:[[]]};ep_signals.TEST_U={name:"TEST_U",visible:true,type:"L",value:0,default_value:0,nbits:"1",behavior:["MV FLAG_U VAL_ZERO; FIRE_IFSET SELP 1","MV FLAG_U VAL_ONE; FIRE_IFSET SELP 1"],depends_on:["CLK"],fire_name:["svg_p:text3669-1"],draw_data:[["svg_p:text3669-1"]],draw_name:[[]]};ep_signals.TEST_INTV={name:"TEST_INTV",visible:true,type:"L",value:0,default_value:0,nbits:"8",forbidden:true,behavior:["MBIT INTV TEST_INTV 0 32"],depends_on:["INT"],fire_name:["svg_p:tspan4225"],draw_data:[["svg_p:path3749"]],draw_name:[[]]};ep_behaviors.NOP={nparameters:1,operation:function(a){},verbal:function(a){return""}};ep_behaviors.NOP_ALU={nparameters:1,operation:function(a){ep_internal_states.alu_flags.flag_n=0;ep_internal_states.alu_flags.flag_z=0;ep_internal_states.alu_flags.flag_c=0;ep_internal_states.alu_flags.flag_v=0},verbal:function(a){return""}};ep_behaviors.MV={nparameters:3,types:["X","X"],operation:function(a){sim_elto_org=get_reference(a[2]);sim_elto_dst=get_reference(a[1]);newval=get_value(sim_elto_org);set_value(sim_elto_dst,newval)},verbal:function(c){var d=get_reference(c[2]);var e=get_value(d);var a=get_cfg("verbal_verbose");if(a!=="math"){return"Copy from "+show_verbal(c[2])+" to "+show_verbal(c[1])+" value "+show_value(e)+". "}return show_verbal(c[1])+" = "+show_verbal(c[2])+" ("+show_value(e)+"). "}};ep_behaviors.LOAD={nparameters:3,types:["X","X"],operation:function(a){sim_elto_org=get_reference(a[2]);sim_elto_dst=get_reference(a[1]);newval=get_value(sim_elto_org);set_value(sim_elto_dst,newval)},verbal:function(c){var d=get_reference(c[2]);var e=get_value(d);var a=get_cfg("verbal_verbose");if(a!=="math"){return"Load from "+show_verbal(c[2])+" to "+show_verbal(c[1])+" value "+show_value(e)+". "}return show_verbal(c[1])+" = "+show_verbal(c[2])+" ("+show_value(e)+"). "}};ep_behaviors.CP_FIELD={nparameters:3,types:["X","X"],operation:function(a){r=a[2].split("/");sim_elto_org=get_reference(r[0]);newval=get_value(sim_elto_org);newval=newval[r[1]];if(typeof newval!="undefined"){sim_elto_dst=get_reference(a[1]);set_value(sim_elto_dst,newval)}},verbal:function(c){var e=c[2].split("/");var d=get_reference(e[0]);var f=get_value(d);f=f[e[1]];if(typeof f=="undefined"){f="&lt;undefined&gt;"}else{f=show_value(f)}var a=get_cfg("verbal_verbose");if(a!=="math"){return"Copy from Field "+e[1]+" of "+show_verbal(e[0])+" to "+show_verbal(c[1])+" value "+f+". "}return show_verbal(c[1])+" = "+show_verbal(e[0])+"."+e[1]+" ("+f+"). "}};ep_behaviors.NOT_ES={nparameters:3,types:["S","E"],operation:function(a){set_value(ep_signals[a[1]],Math.abs(get_value(ep_states[a[2]])-1))},verbal:function(c){var d=Math.abs(get_value(ep_states[c[2]])-1);var a=get_cfg("verbal_verbose");if(a!=="math"){return"Set "+show_verbal(c[1])+" with value "+show_value(d)+" (Logical NOT of "+c[2]+"). "}return show_verbal(c[1])+" = "+show_value(d)+" (Logical NOT "+c[2]+"). "}};ep_behaviors.GET={nparameters:4,types:["E","E","S"],operation:function(a){set_value(ep_states[a[1]],get_value(ep_states[a[2]][ep_signals[a[3]].value]))},verbal:function(c){var d=get_value(ep_states[c[2]][ep_signals[c[3]].value]);var a=get_cfg("verbal_verbose");if(a!=="math"){return"Set "+show_verbal(c[1])+" with value "+show_value(d)+" (Register File "+c[3]+"). "}return show_verbal(c[1])+" = "+show_value(d)+" (Register File "+c[3]+"). "}};ep_behaviors.SET={nparameters:4,types:["E","S","E"],operation:function(a){set_value(ep_states[a[1]][ep_signals[a[2]].value],get_value(ep_states[a[3]]))},verbal:function(e){var f=get_value(ep_states[e[3]]);var d=ep_states[e[1]][ep_signals[e[2]].value];var c=d.name;if(typeof d.verbal!="undefined"){c=d.verbal}var a=get_cfg("verbal_verbose");if(a!=="math"){return"Copy to "+c+" the value "+show_value(f)+". "}return c+" = "+show_value(f)+". "}};ep_behaviors.AND={nparameters:4,types:["E","E","E"],operation:function(c){var a=get_value(ep_states[c[2]])&get_value(ep_states[c[3]]);set_value(ep_states[c[1]],a);ep_internal_states.alu_flags.flag_n=(a<0)?1:0;ep_internal_states.alu_flags.flag_z=(a==0)?1:0;ep_internal_states.alu_flags.flag_v=0;ep_internal_states.alu_flags.flag_c=0},verbal:function(d){var a=get_value(ep_states[d[2]])&get_value(ep_states[d[3]]);var c=get_cfg("verbal_verbose");if(c!=="math"){return"ALU AND with result "+show_value(a)+". "}return"ALU output = "+show_value(a)+" (AND). "}};ep_behaviors.OR={nparameters:4,types:["E","E","E"],operation:function(c){var a=get_value(ep_states[c[2]])|get_value(ep_states[c[3]]);set_value(ep_states[c[1]],a);ep_internal_states.alu_flags.flag_n=(a<0)?1:0;ep_internal_states.alu_flags.flag_z=(a==0)?1:0;ep_internal_states.alu_flags.flag_v=0;ep_internal_states.alu_flags.flag_c=0},verbal:function(d){var a=get_value(ep_states[d[2]])|get_value(ep_states[d[3]]);var c=get_cfg("verbal_verbose");if(c!=="math"){return"ALU OR with result "+show_value(a)+". "}return"ALU output = "+show_value(a)+" (OR). "}};ep_behaviors.NOT={nparameters:3,types:["E","E"],operation:function(c){var a=~(get_value(ep_states[c[2]]));set_value(ep_states[c[1]],a);ep_internal_states.alu_flags.flag_n=(a<0)?1:0;ep_internal_states.alu_flags.flag_z=(a==0)?1:0;ep_internal_states.alu_flags.flag_v=0;ep_internal_states.alu_flags.flag_c=0},verbal:function(d){var a=~(get_value(ep_states[d[2]]));var c=get_cfg("verbal_verbose");if(c!=="math"){return"ALU NOT with result "+show_value(a)+". "}return"ALU output = "+show_value(a)+" (NOT). "}};ep_behaviors.XOR={nparameters:4,types:["E","E","E"],operation:function(c){var a=get_value(ep_states[c[2]])^get_value(ep_states[c[3]]);set_value(ep_states[c[1]],a);ep_internal_states.alu_flags.flag_n=(a<0)?1:0;ep_internal_states.alu_flags.flag_z=(a==0)?1:0;ep_internal_states.alu_flags.flag_v=0;ep_internal_states.alu_flags.flag_c=0},verbal:function(d){var a=get_value(ep_states[d[2]])^get_value(ep_states[d[3]]);var c=get_cfg("verbal_verbose");if(c!=="math"){return"ALU XOR with result "+show_value(a)+". "}return"ALU output = "+show_value(a)+" (XOR). "}};ep_behaviors.SRL={nparameters:3,types:["E","E"],operation:function(c){var a=(get_value(ep_states[c[2]]))>>>1;set_value(ep_states[c[1]],a);ep_internal_states.alu_flags.flag_n=(a<0)?1:0;ep_internal_states.alu_flags.flag_z=(a==0)?1:0;ep_internal_states.alu_flags.flag_v=0;ep_internal_states.alu_flags.flag_c=0},verbal:function(d){var a=(get_value(ep_states[d[2]]))>>>1;var c=get_cfg("verbal_verbose");if(c!=="math"){return"ALU Shift Right Logical with result "+show_value(a)+". "}return"ALU output = "+show_value(a)+" (SRL). "}};ep_behaviors.SRA={nparameters:3,types:["E","E"],operation:function(c){var a=(get_value(ep_states[c[2]]))>>1;set_value(ep_states[c[1]],a);ep_internal_states.alu_flags.flag_n=(a<0)?1:0;ep_internal_states.alu_flags.flag_z=(a==0)?1:0;ep_internal_states.alu_flags.flag_v=0;ep_internal_states.alu_flags.flag_c=0},verbal:function(d){var a=(get_value(ep_states[d[2]]))>>1;var c=get_cfg("verbal_verbose");if(c!=="math"){return"ALU Shift Right Arithmetic with result "+show_value(a)+". "}return"ALU output = "+show_value(a)+" (SRA). "}};ep_behaviors.SL={nparameters:3,types:["E","E"],operation:function(c){var a=(get_value(ep_states[c[2]]))<<1;set_value(ep_states[c[1]],a);ep_internal_states.alu_flags.flag_n=(a<0)?1:0;ep_internal_states.alu_flags.flag_z=(a==0)?1:0;ep_internal_states.alu_flags.flag_v=0;ep_internal_states.alu_flags.flag_c=((a)>>>31)},verbal:function(d){var a=(get_value(ep_states[d[2]]))<<1;var c=get_cfg("verbal_verbose");if(c!=="math"){return"ALU Shift Left with result "+show_value(a)+". "}return"ALU output = "+show_value(a)+" (SL). "}};ep_behaviors.RR={nparameters:3,types:["E","E"],operation:function(c){var a=((get_value(ep_states[c[2]]))>>>1)|(((get_value(ep_states[c[2]]))&1)<<31);set_value(ep_states[c[1]],a);ep_internal_states.alu_flags.flag_n=(a<0)?1:0;ep_internal_states.alu_flags.flag_z=(a==0)?1:0;ep_internal_states.alu_flags.flag_v=0;ep_internal_states.alu_flags.flag_c=0},verbal:function(d){var a=((get_value(ep_states[d[2]]))>>>1)|(((get_value(ep_states[d[2]]))&1)<<31);var c=get_cfg("verbal_verbose");if(c!=="math"){return"ALU Right Rotation with result "+show_value(a)+". "}return"ALU output = "+show_value(a)+" (RR). "}};ep_behaviors.RL={nparameters:3,types:["E","E"],operation:function(c){var a=((get_value(ep_states[c[2]]))<<1)|(((get_value(ep_states[c[2]]))&2147483648)>>>31);set_value(ep_states[c[1]],a);ep_internal_states.alu_flags.flag_n=(a<0)?1:0;ep_internal_states.alu_flags.flag_z=(a==0)?1:0;ep_internal_states.alu_flags.flag_v=0;ep_internal_states.alu_flags.flag_c=0},verbal:function(d){var a=((get_value(ep_states[d[2]]))<<1)|(((get_value(ep_states[d[2]]))&2147483648)>>>31);var c=get_cfg("verbal_verbose");if(c!=="math"){return"ALU Left Rotation with result "+show_value(a)+". "}return"ALU output = "+show_value(a)+" (LR). "}};ep_behaviors.ADD={nparameters:4,types:["E","E","E"],operation:function(f){var e=get_value(ep_states[f[2]])<<0;var d=get_value(ep_states[f[3]])<<0;var c=e+d;set_value(ep_states[f[1]],c>>>0);ep_internal_states.alu_flags.flag_n=(c<0)?1:0;ep_internal_states.alu_flags.flag_z=(c==0)?1:0;ep_internal_states.alu_flags.flag_c=(e>>>31)&&(d>>>31);ep_internal_states.alu_flags.flag_v=0;if((c<0)&&(e>=0)&&(d>=0)){ep_internal_states.alu_flags.flag_v=1}if((c>=0)&&(e<0)&&(d<0)){ep_internal_states.alu_flags.flag_v=1}},verbal:function(g){var f=get_value(ep_states[g[2]])<<0;var d=get_value(ep_states[g[3]])<<0;var c=f+d;var e=get_cfg("verbal_verbose");if(e!=="math"){return"ALU ADD with result "+show_value(c)+". "}return"ALU output = "+show_value(c)+" (ADD). "}};ep_behaviors.SUB={nparameters:4,types:["E","E","E"],operation:function(f){var e=get_value(ep_states[f[2]])<<0;var d=get_value(ep_states[f[3]])<<0;var c=e-d;set_value(ep_states[f[1]],c>>>0);ep_internal_states.alu_flags.flag_n=(c<0)?1:0;ep_internal_states.alu_flags.flag_z=(c==0)?1:0;ep_internal_states.alu_flags.flag_c=(e>>>31)&&(d>>>31);ep_internal_states.alu_flags.flag_v=0;if((c<0)&&(e>=0)&&(d>=0)){ep_internal_states.alu_flags.flag_v=1}if((c>=0)&&(e<0)&&(d<0)){ep_internal_states.alu_flags.flag_v=1}},verbal:function(g){var f=get_value(ep_states[g[2]])<<0;var d=get_value(ep_states[g[3]])<<0;var c=f-d;var e=get_cfg("verbal_verbose");if(e!=="math"){return"ALU SUB with result "+show_value(c)+". "}return"ALU output = "+show_value(c)+" (SUB). "}};ep_behaviors.MUL={nparameters:4,types:["E","E","E"],operation:function(f){var e=get_value(ep_states[f[2]])<<0;var d=get_value(ep_states[f[3]])<<0;var c=e*d;set_value(ep_states[f[1]],c>>>0);ep_internal_states.alu_flags.flag_n=(c<0)?1:0;ep_internal_states.alu_flags.flag_z=(c==0)?1:0;ep_internal_states.alu_flags.flag_c=0;ep_internal_states.alu_flags.flag_v=0;if((c<0)&&(e>=0)&&(d>=0)){ep_internal_states.alu_flags.flag_v=1}if((c>=0)&&(e<0)&&(d<0)){ep_internal_states.alu_flags.flag_v=1}},verbal:function(g){var f=get_value(ep_states[g[2]])<<0;var d=get_value(ep_states[g[3]])<<0;var c=f*d;var e=get_cfg("verbal_verbose");if(e!=="math"){return"ALU MUL with result "+show_value(c)+". "}return"ALU output = "+show_value(c)+" (MUL). "}};ep_behaviors.DIV={nparameters:4,types:["E","E","E"],operation:function(f){var e=(get_value(ep_states[f[2]])<<0);var d=(get_value(ep_states[f[3]])<<0);if(0==d){set_value(ep_states[f[1]],0);ep_internal_states.alu_flags.flag_n=0;ep_internal_states.alu_flags.flag_z=1;ep_internal_states.alu_flags.flag_v=1;ep_internal_states.alu_flags.flag_c=0;return}var c=Math.floor(e/d);set_value(ep_states[f[1]],c);ep_internal_states.alu_flags.flag_n=(c<0)?1:0;ep_internal_states.alu_flags.flag_z=(c==0)?1:0;ep_internal_states.alu_flags.flag_v=0;ep_internal_states.alu_flags.flag_c=0},verbal:function(g){var f=get_value(ep_states[g[2]])<<0;var d=get_value(ep_states[g[3]])<<0;if(0==d){return"ALU DIV zero by zero (oops!). "}var c=Math.floor(f/d);var e=get_cfg("verbal_verbose");if(e!=="math"){return"ALU DIV with result "+show_value(c)+". "}return"ALU output = "+show_value(c)+" (DIV). "}};ep_behaviors.MOD={nparameters:4,types:["E","E","E"],operation:function(c){var a=(get_value(ep_states[c[2]])<<0)%(get_value(ep_states[c[3]])<<0);set_value(ep_states[c[1]],a);ep_internal_states.alu_flags.flag_n=(a<0)?1:0;ep_internal_states.alu_flags.flag_z=(a==0)?1:0;ep_internal_states.alu_flags.flag_v=0;ep_internal_states.alu_flags.flag_c=0},verbal:function(g){var f=get_value(ep_states[g[2]])<<0;var d=get_value(ep_states[g[3]])<<0;if(0==d){return"ALU MOD zero by zero (oops!). "}var c=f%d;var e=get_cfg("verbal_verbose");if(e!=="math"){return"ALU MOD with result "+show_value(c)+". "}return"ALU output = "+show_value(c)+" (MOD). "}};ep_behaviors.LUI={nparameters:3,types:["E","E"],operation:function(c){var a=(get_value(ep_states[c[2]]))<<16;set_value(ep_states[c[1]],a);ep_internal_states.alu_flags.flag_n=(a<0)?1:0;ep_internal_states.alu_flags.flag_z=(a==0)?1:0;ep_internal_states.alu_flags.flag_v=0;ep_internal_states.alu_flags.flag_c=0},verbal:function(d){var a=(get_value(ep_states[d[2]]))<<16;var c=get_cfg("verbal_verbose");if(c!=="math"){return"ALU Load Upper Immediate with result "+show_value(a)+". "}return"ALU output = "+show_value(a)+" (LUI). "}};ep_behaviors.PLUS1={nparameters:3,types:["E","E"],operation:function(e){var d=get_value(ep_states[e[2]])<<0;var c=d+1;set_value(ep_states[e[1]],c>>>0)},verbal:function(f){var e=get_value(ep_states[f[2]])<<0;var c=e+1;var d=get_cfg("verbal_verbose");if(d!=="math"){return"Copy to "+show_verbal(f[1])+" "+show_verbal(f[2])+" plus one with result "+show_value(c)+". "}return show_verbal(f[1])+" = "+show_verbal(f[2])+" + 1 ("+show_value(c)+"). "}};ep_behaviors.PLUS4={nparameters:3,types:["E","E"],operation:function(e){var d=get_value(ep_states[e[2]])<<0;var c=d+4;set_value(ep_states[e[1]],c>>>0)},verbal:function(f){var e=get_value(ep_states[f[2]])<<0;var c=e+4;var d=get_cfg("verbal_verbose");if(d!=="math"){return"Copy to "+show_verbal(f[1])+" "+show_verbal(f[2])+" plus four with result "+show_value(c)+". "}return show_verbal(f[1])+" = "+show_verbal(f[2])+" + 4 ("+show_value(c)+"). "}};ep_behaviors.MBIT={nparameters:5,types:["X","X","I","I"],operation:function(a){var g=get_reference(a[1]);var f=get_reference(a[2]);var h=parseInt(a[3]);var d=parseInt(a[4]);var e=get_value(f).toString(2);var c="00000000000000000000000000000000".substring(0,32-e.length)+e;c=c.substr(31-(h+d-1),d);set_value(g,parseInt(c,2))},verbal:function(h){var e=get_reference(h[1]);var k=get_reference(h[2]);var c=parseInt(h[3]);var l=parseInt(h[4]);var g=get_value(k).toString(2);var f="00000000000000000000000000000000".substring(0,32-g.length)+g;f=f.substr(31-(c+l-1),l);var d=parseInt(f,2);var a=get_cfg("verbal_verbose");if(a!=="math"){return"Copy from "+show_verbal(h[2])+" to "+show_verbal(h[1])+" value "+show_value(d)+" (copied "+l+" bits from bit "+c+"). "}return show_verbal(h[1])+" = "+show_verbal(h[2])+" ("+show_value(d)+", "+l+" bits from bit "+c+"). "}};ep_behaviors.MBIT_SN={nparameters:5,types:["S","E","E","I"],operation:function(c){var g=0;var f=c[3].split("/");if(1==f.length){g=get_value(ep_states[c[3]])}else{if(typeof ep_states[f[0]].value[f[1]]!="undefined"){g=ep_states[f[0]].value[f[1]]}else{if(typeof ep_signals[f[1]].default_value!="undefined"){g=ep_signals[f[1]].default_value}else{if(typeof ep_states[f[1]].default_value!="undefined"){g=ep_states[f[1]].default_value}else{alert("WARN: undefined state/field pair -> "+f[0]+"/"+f[1])}}}}var h=parseInt(c[4]);var e=get_value(ep_states[c[2]]).toString(2);var d="00000000000000000000000000000000".substring(0,32-e.length)+e;var a=d.substr(31-(g+h-1),h);set_value(ep_signals[c[1]],parseInt(a,2))},verbal:function(l){var c=0;var a=l[3].split("/");if(1==a.length){c=get_value(ep_states[l[3]])}else{if(typeof ep_states[a[0]].value[a[1]]!="undefined"){c=ep_states[a[0]].value[a[1]]}else{if(typeof ep_signals[a[1]].default_value!="undefined"){c=ep_signals[a[1]].default_value}else{if(typeof ep_states[a[1]].default_value!="undefined"){c=ep_states[a[1]].default_value}else{alert("WARN: undefined state/field pair -> "+a[0]+"/"+a[1])}}}}var f=parseInt(l[4]);var k=get_value(ep_states[l[2]]).toString(2);var h="00000000000000000000000000000000".substring(0,32-k.length)+k;var g=h.substr(31-(c+f-1),f);var d="";if(1==a.length){d=show_verbal(l[3])}else{d=show_verbal(l[2])+"["+a[1]+"] "}var e=get_cfg("verbal_verbose");if(e!=="math"){return"Copy from "+d+"into "+show_verbal(l[1])+" value "+parseInt(g,2)+". "}return show_verbal(l[1])+" = "+d+" ("+parseInt(g,2)+"). "}};ep_behaviors.SBIT_SIGNAL={nparameters:4,types:["X","I","I"],operation:function(c){sim_elto_dst=get_reference(c[1]);var d=sim_elto_dst.value;var a=(1<<c[3]);if(c[2]=="1"){d=d|a}else{d=d&~a}set_value(sim_elto_dst,(d>>>0))},verbal:function(c){sim_elto_dst=get_reference(c[1]);var d=sim_elto_dst.value;var a=(1<<c[3]);if(c[2]=="1"){d=d|a}else{d=d&~a}return compute_signal_verbals(c[1],(d>>>0))}};ep_behaviors.UPDATE_FLAG={nparameters:4,types:["X","X","I"],operation:function(a){sim_elto_org=get_reference(a[2]);sim_elto_dst=get_reference(a[1]);var c=(sim_elto_dst.value&~(1<<a[3]))|(sim_elto_org.value<<a[3]);set_value(sim_elto_dst,(c>>>0))},verbal:function(c){sim_elto_org=get_reference(c[2]);sim_elto_dst=get_reference(c[1]);var a=get_cfg("verbal_verbose");if(a!=="math"){return"Update "+show_verbal(c[2])+" to value "+sim_elto_org.value+". "}return show_verbal(c[1])+"."+show_verbal(c[3])+" = "+sim_elto_org.value+". "}};ep_behaviors.MBITS={nparameters:8,types:["E","I","E","S","S","I","S"],operation:function(c){var g=parseInt(ep_signals[c[4]].value);var e=parseInt(ep_signals[c[5]].value);var f=get_value(ep_states[c[3]]).toString(2);var d=("00000000000000000000000000000000".substring(0,32-f.length)+f);d=d.substr(31-(g+e-1),e);var a="00000000000000000000000000000000".substring(0,32-d.length)+d;if(("1"==ep_signals[c[7]].value)&&("1"==d.substr(0,1))){a="11111111111111111111111111111111".substring(0,32-d.length)+d}set_value(ep_states[c[1]],parseInt(a,2))},verbal:function(d){var h=parseInt(ep_signals[d[4]].value);var f=parseInt(ep_signals[d[5]].value);var g=get_value(ep_states[d[3]]).toString(2);var e=("00000000000000000000000000000000".substring(0,32-g.length)+g);e=e.substr(31-(h+f-1),f);var c="00000000000000000000000000000000".substring(0,32-e.length)+e;if(("1"==ep_signals[d[7]].value)&&("1"==e.substr(0,1))){c="11111111111111111111111111111111".substring(0,32-e.length)+e}g=parseInt(c,2);var a=get_cfg("verbal_verbose");if(a!=="math"){return" Copy from "+show_verbal(d[3])+" to "+show_verbal(d[1])+" value "+show_value(g)+" (copied "+f+" bits from bit "+h+"). "}return show_verbal(d[1])+" = "+show_verbal(d[3])+" ("+show_value(g)+", "+f+" bits from bit "+h+"). "}};ep_behaviors.BSEL={nparameters:6,types:["E","I","I","E","I"],operation:function(e){var k=parseInt(e[2]);var h=parseInt(e[5]);var a=parseInt(e[3]);var g=get_value(ep_states[e[4]]).toString(2);var f="00000000000000000000000000000000".substring(0,32-g.length)+g;f=f.substr(31-(h+a)+1,a);var d="00000000000000000000000000000000".substring(0,32-f.length)+f;var c="00000000000000000000000000000000".substr(0,k);d=d+c;set_value(ep_states[e[1]],parseInt(d,2))},verbal:function(m){var g=parseInt(m[2]);var k=parseInt(m[3]);var a=parseInt(m[5]);var l=get_value(ep_states[m[4]]).toString(2);var h="00000000000000000000000000000000".substring(0,32-l.length)+l;h=h.substr(31-(a+k)+1,k);var f="00000000000000000000000000000000".substring(0,32-h.length)+h;var e="00000000000000000000000000000000".substr(0,g);f=f+e;var d=parseInt(f,2);var c=get_cfg("verbal_verbose");if(c!=="math"){return"Copy from "+show_verbal(m[4])+" to "+show_verbal(m[1])+" value "+show_value(d)+" (copied "+k+" bits, from bit "+a+" of "+m[4]+" to bit "+g+" of "+m[1]+"). "}return show_verbal(m[1])+" = "+show_verbal(m[4])+" ("+show_value(d)+", "+k+" bits, from bit "+a+" of "+m[4]+" to bit "+g+" of "+m[1]+"). "}};ep_behaviors.EXT_SIG={nparameters:3,types:["E","I"],operation:function(d){var f=get_value(ep_states[d[1]]).toString(2);var e=("00000000000000000000000000000000".substring(0,32-f.length)+f);var c=e.substr(31-d[2],31);var a=c;if("1"==e[31-d[2]]){a="11111111111111111111111111111111".substring(0,32-c.length)+a}set_value(ep_states[d[1]],parseInt(a,2))},verbal:function(e){var g=get_value(ep_states[e[1]]).toString(2);var f=("00000000000000000000000000000000".substring(0,32-g.length)+g);var d=f.substr(31-e[2],31);var c=d;if("1"==f[31-e[2]]){c="11111111111111111111111111111111".substring(0,32-d.length)+c}var a=parseInt(c,2);return"Sign Extension with value "+show_value(a)+". "}};ep_behaviors.MOVE_BITS={nparameters:5,types:["S","I","I","S"],operation:function(h){var d=parseInt(h[2]);var a=0;var f=parseInt(h[3]);var g=ep_signals[h[4]].value.toString(2);g=("00000000000000000000000000000000".substring(0,32-g.length)+g);g=g.substr(31-a-f+1,f);var e=ep_signals[h[1]].value.toString(2);e=("00000000000000000000000000000000".substring(0,32-e.length)+e);var l=e.substr(0,32-(d+f));var k=e.substr(31-d+1,d);var c=l+g+k;set_value(ep_signals[h[1]],parseInt(c,2))},verbal:function(a){return""}};ep_behaviors.MOVE_BITSE={nparameters:6,types:["S","I","I","E","I"],operation:function(h){var d=parseInt(h[2]);var a=parseInt(h[5]);var f=parseInt(h[3]);var g=get_value(ep_states[h[4]]).toString(2);g=("00000000000000000000000000000000".substring(0,32-g.length)+g);g=g.substr(31-a-f+1,f);var e=ep_signals[h[1]].value.toString(2);e=("00000000000000000000000000000000".substring(0,32-e.length)+e);var l=e.substr(0,32-(d+f));var k=e.substr(31-d+1,d);var c=l+g+k;set_value(ep_signals[h[1]],parseInt(c,2))},verbal:function(a){return""}};ep_behaviors.DECO={nparameters:1,operation:function(c){ep_states.INEX.value=0;var f=decode_instruction(ep_internal_states.FIRMWARE,ep_ctrl_states.ir,get_value(ep_states.REG_IR));if(null==f.oinstruction){alert("ERROR: undefined instruction code in firmware (co:"+f.op_code.toString(2)+", cop:"+f.cop_code.toString(2)+")");ep_states.ROM_MUXA.value=0;ep_states.INEX.value=1;return -1}var e=f.op_code<<6;if(typeof f.oinstruction.cop!="undefined"){e=e+f.cop_code}if(typeof ep_internal_states.ROM[e]=="undefined"){alert("ERROR: undefined rom address "+e+" in firmware");ep_states.ROM_MUXA.value=0;return -1}ep_states.ROM_MUXA.value=ep_internal_states.ROM[e];var g=get_value(ep_states.DECO_INS);set_value(ep_states.DECO_INS,g+1);var a=get_value(ep_states.REG_PC)-4;var d=get_deco_from_pc(a);set_value(ep_states.REG_IR_DECO,d);show_dbg_ir(get_value(ep_states.REG_IR_DECO))},verbal:function(a){return"Decode instruction. "}};ep_behaviors.FIRE={nparameters:2,types:["S"],operation:function(a){if(ep_internal_states.fire_stack.indexOf(a[1])!=-1){return}ep_internal_states.fire_stack.push(a[1]);update_draw(ep_signals[a[1]],ep_signals[a[1]].value);if("L"==ep_signals[a[1]].type){update_state(a[1])}ep_internal_states.fire_stack.pop(a[1]);check_buses(a[1])},verbal:function(a){return""}};ep_behaviors.FIRE_IFSET={nparameters:3,types:["S","I"],operation:function(a){if(get_value(ep_signals[a[1]])!=parseInt(a[2])){return}ep_behaviors.FIRE.operation(a)},verbal:function(a){return""}};ep_behaviors.FIRE_IFCHANGED={nparameters:3,types:["S","X"],operation:function(a){sim_elto=get_reference(a[2]);if(sim_elto.changed==false){return}ep_behaviors.FIRE.operation(a)},verbal:function(a){return""}};ep_behaviors.RESET_CHANGED={nparameters:2,types:["X"],operation:function(a){sim_elto=get_reference(a[1]);sim_elto.changed=false},verbal:function(a){return""}};ep_behaviors.CLOCK={nparameters:1,operation:function(s_expr){var val=get_value(ep_states.CLK);set_value(ep_states.CLK,val+1);for(var i=0;i<jit_fire_order.length;i++){fn_updateE_now(jit_fire_order[i])}var new_maddr=get_value(ep_states.MUXA_MICROADDR);set_value(ep_states.REG_MICROADDR,new_maddr);if(typeof ep_internal_states.MC[new_maddr]!="undefined"){var new_mins=Object.create(ep_internal_states.MC[new_maddr])}else{var new_mins=Object.create(ep_states.REG_MICROINS.default_value)}ep_states.REG_MICROINS.value=new_mins;for(var key in ep_signals){if(typeof new_mins[key]!="undefined"){set_value(ep_signals[key],new_mins[key])}else{set_value(ep_signals[key],ep_signals[key].default_value)}}for(var i=0;i<jit_fire_order.length;i++){fn_updateL_now(jit_fire_order[i])}if(typeof new_mins.NATIVE_JIT!="undefined"){new_mins.NATIVE_JIT()}else{if(typeof new_mins.NATIVE!="undefined"){eval(new_mins.NATIVE)}}},verbal:function(a){return""}};ep_behaviors.CPU_RESET={nparameters:1,operation:function(a){for(var c in ep_states){reset_value(ep_states[c])}for(var c in ep_signals){reset_value(ep_signals[c])}},verbal:function(a){return"Reset CPU. "}};ep_behaviors.UPDATEDPC={nparameters:1,operation:function(a){show_asmdbg_pc()},verbal:function(a){return""}};ep_behaviors.UPDATE_NZVC={nparameters:1,operation:function(a){set_value(simhw_sim_state("FLAG_N"),ep_internal_states.alu_flags.flag_n);set_value(simhw_sim_state("FLAG_Z"),ep_internal_states.alu_flags.flag_z);set_value(simhw_sim_state("FLAG_V"),ep_internal_states.alu_flags.flag_v);set_value(simhw_sim_state("FLAG_C"),ep_internal_states.alu_flags.flag_c);set_value(simhw_sim_signal("TEST_N"),ep_internal_states.alu_flags.flag_n);set_value(simhw_sim_signal("TEST_Z"),ep_internal_states.alu_flags.flag_z);set_value(simhw_sim_signal("TEST_V"),ep_internal_states.alu_flags.flag_v);set_value(simhw_sim_signal("TEST_C"),ep_internal_states.alu_flags.flag_c);update_draw(ep_signals.TEST_N,ep_signals.TEST_N.value);update_draw(ep_signals.TEST_Z,ep_signals.TEST_Z.value);update_draw(ep_signals.TEST_V,ep_signals.TEST_V.value);update_draw(ep_signals.TEST_C,ep_signals.TEST_C.value)},verbal:function(a){return"Update flags N-Z-V-C."}};ep_components.MEMORY={name:"MEMORY",version:"1",abilities:["MEMORY"],details_name:["MEMORY","MEMORY_CONFIG"],details_fire:[["svg_p:text3001"],[]],write_state:function(d){if(typeof d.MEMORY=="undefined"){d.MEMORY={}}var c=0;var e=0;for(var a in ep_internal_states.MP){e=parseInt(ep_internal_states.MP[a]);if(e!=0){c=parseInt(a).toString(16);d.MEMORY["0x"+c]={type:"memory",default_value:0,id:"0x"+c,op:"=",value:"0x"+e.toString(16)}}}return d},read_state:function(d,a){if(typeof d.MEMORY=="undefined"){d.MEMORY={}}var c=parseInt(a.id).toString(16);var e=parseInt(a.value).toString(16);if("MEMORY"==a.type.toUpperCase().trim()){d.MEMORY["0x"+c]={type:"memory",default_value:0,id:"0x"+c,op:a.condition,value:"0x"+e};return true}return false},get_state:function(c){var a=parseInt(c);if(typeof ep_internal_states.MP[a]!="undefined"){return"0x"+parseInt(ep_internal_states.MP[a]).toString(16)}return null},get_value:function(a){return(simhw_internalState_get("MP",a)>>>0)},set_value:function(a,c){simhw_internalState_set("MP",a,c);return c}};ep_internal_states.segments={};ep_internal_states.MP={};ep_internal_states.MP_wc=0;ep_signals.MRDY={name:"MRDY",visible:true,type:"L",value:0,default_value:0,nbits:"1",depends_on:["CLK"],behavior:["FIRE_IFCHANGED MRDY C","FIRE_IFCHANGED MRDY C"],fire_name:["svg_p:tspan3916","svg_p:text3909"],draw_data:[[],["svg_p:path3895","svg_p:path3541"]],draw_name:[[],[]]};ep_signals.R={name:"R",visible:true,type:"L",value:0,default_value:0,nbits:"1",behavior:["NOP","MEM_READ BUS_AB BUS_DB BWA MRDY CLK; FIRE MRDY"],fire_name:["svg_p:text3533-5-2","svg_p:text3713"],draw_data:[[],["svg_p:path3557","svg_p:path3571"]],draw_name:[[],[]]};ep_signals.W={name:"W",visible:true,type:"L",value:0,default_value:0,nbits:"1",behavior:["NOP","MEM_WRITE BUS_AB BUS_DB BWA MRDY CLK; FIRE MRDY"],fire_name:["svg_p:text3533-5-08","svg_p:text3527","svg_p:text3431-7"],draw_data:[[],["svg_p:path3559","svg_p:path3575","svg_p:path3447-7"]],draw_name:[[],[]]};ep_behaviors.MEM_READ={nparameters:6,types:["E","E","S","S","E"],operation:function(c){var a=ep_states[c[1]].value;var d=ep_states[c[2]].value;var h=ep_signals[c[3]].value;var f=get_value(ep_states[c[5]].value);ep_signals[c[4]].value=0;var g=get_var(ep_internal_states.MP_wc);if((typeof ep_events.mem[f-1]!="undefined")&&(ep_events.mem[f-1]>0)){g=ep_events.mem[f-1]-1}ep_events.mem[f]=g;if(g>0){return}var e=0;a=a&4294967292;if(typeof ep_internal_states.MP[a]!="undefined"){e=ep_internal_states.MP[a]}if(0==(h&12)){if(0==(h&3)){d=(d&4294967040)|(e&255)}if(1==(h&3)){d=(d&4294902015)|(e&65280)}if(2==(h&3)){d=(d&4278255615)|(e&16711680)}if(3==(h&3)){d=(d&16777215)|(e&4278190080)}}else{if(1==(h&12)){if(0==(h&2)){d=(d&4294901760)|(e&65535)}if(1==(h&2)){d=(d&65535)|(e&4294901760)}}else{d=e}}ep_states[c[2]].value=(d>>>0);ep_signals[c[4]].value=1;show_main_memory(ep_internal_states.MP,a,false,false)},verbal:function(k){var f="";var l=ep_states[k[1]].value;var a=ep_states[k[2]].value;var g=ep_signals[k[3]].value;var d=get_value(ep_states[k[5]].value);var c="word";if(0==(g&12)){c="byte"}else{if(1==(g&12)){c="half"}}var h=0;if(typeof ep_internal_states.MP[l]!="undefined"){h=ep_internal_states.MP[l]}var e=get_cfg("verbal_verbose");if(e!=="math"){f="Try to read a "+c+" from memory at address 0x"+l.toString(16)+" with value 0x"+h.toString(16)+". "}f="Memory output = 0x"+h.toString(16)+" (Read a "+c+" from 0x"+l.toString(16)+"). ";return f}};ep_behaviors.MEM_WRITE={nparameters:6,types:["E","E","S","S","E"],operation:function(c){var a=ep_states[c[1]].value;var d=ep_states[c[2]].value;var h=ep_signals[c[3]].value;var f=get_value(ep_states[c[5]].value);ep_signals[c[4]].value=0;var g=get_var(ep_internal_states.MP_wc);if((typeof ep_events.mem[f-1]!="undefined")&&(ep_events.mem[f-1]>0)){g=ep_events.mem[f-1]-1}ep_events.mem[f]=g;if(g>0){return}var e=0;a=a&4294967292;if(typeof ep_internal_states.MP[a]!="undefined"){e=ep_internal_states.MP[a]}if(0==(h&12)){if(0==(h&3)){e=(e&4294967040)|(d&255)}if(1==(h&3)){e=(e&4294902015)|(d&65280)}if(2==(h&3)){e=(e&4278255615)|(d&16711680)}if(3==(h&3)){e=(e&16777215)|(d&4278190080)}}else{if(1==(h&12)){if(0==(h&2)){e=(e&4294901760)|(d&65535)}if(1==(h&2)){e=(e&65535)|(d&4294901760)}}else{e=d}}ep_internal_states.MP[a]=(e>>>0);ep_signals[c[4]].value=1;show_main_memory(ep_internal_states.MP,a,true,true)},verbal:function(k){var f="";var l=ep_states[k[1]].value;var a=ep_states[k[2]].value;var g=ep_signals[k[3]].value;var d=get_value(ep_states[k[5]].value);var c="word";if(0==(g&12)){c="byte"}else{if(1==(g&12)){c="half"}}var h=0;if(typeof ep_internal_states.MP[l]!="undefined"){h=ep_internal_states.MP[l]}var e=get_cfg("verbal_verbose");if(e!=="math"){f="Try to write a "+c+" to memory at address 0x"+l.toString(16)+" with value "+h.toString(16)+". "}f="Memory[0x"+l.toString(16)+"] = 0x"+h.toString(16)+" (Write a "+c+" to 0x"+l.toString(16)+"). ";return f}};ep_behaviors.MEMORY_RESET={nparameters:1,operation:function(a){ep_events.mem={}},verbal:function(a){return"Reset main memory (all values will be zeroes). "}};ep_components.IO={name:"IO",version:"1",abilities:["IO_TIMER"],details_name:["IO_STATS","IO_CONFIG"],details_fire:[["svg_p:text3775"],[]],write_state:function(a){return a},read_state:function(c,a){return false},get_state:function(a){return null},get_value:function(a){var c=simhw_internalState_get("io_hash",a);var d=(get_value(simhw_sim_state(c))>>>0);set_value(simhw_sim_state("BUS_AB"),a);set_value(simhw_sim_signal("IOR"),1);compute_behavior("FIRE IOR");d=get_value(simhw_sim_state("BUS_DB"));return d},set_value:function(a,d){var c=simhw_internalState_get("io_hash",a);set_value(simhw_sim_state(c),d);set_value(simhw_sim_state("BUS_AB"),a);set_value(simhw_sim_state("BUS_DB"),d);set_value(simhw_sim_signal("IOW"),1);compute_behavior("FIRE IOW");return d}};ep_internal_states.io_int_factory=[];ep_internal_states.io_int_factory[0]={period:0,probability:0.5,accumulated:0,active:false};ep_internal_states.io_int_factory[1]={period:0,probability:0.5,accumulated:0,active:false};ep_internal_states.io_int_factory[2]={period:0,probability:0.5,accumulated:0,active:false};ep_internal_states.io_int_factory[3]={period:0,probability:0.5,accumulated:0,active:false};ep_internal_states.io_int_factory[4]={period:0,probability:0.5,accumulated:0,active:false};ep_internal_states.io_int_factory[5]={period:0,probability:0.5,accumulated:0,active:false};ep_internal_states.io_int_factory[6]={period:0,probability:0.5,accumulated:0,active:false};ep_internal_states.io_int_factory[7]={period:0,probability:0.5,accumulated:0,active:false};var IOSR_ID=4352;var IOCR_ID=4356;var IODR_ID=4360;ep_internal_states.io_hash[IOSR_ID]="IOSR";ep_internal_states.io_hash[IOCR_ID]="IOCR";ep_internal_states.io_hash[IODR_ID]="IODR";ep_states.IOSR={name:"IOSR",verbal:"IO State Register",visible:false,nbits:"32",value:0,default_value:0,draw_data:[]};ep_states.IOCR={name:"IOCR",verbal:"IO Control Register",visible:false,nbits:"32",value:0,default_value:0,draw_data:[]};ep_states.IODR={name:"IODR",verbal:"IO Data Register",visible:false,nbits:"32",value:0,default_value:0,draw_data:[]};ep_signals.INT={name:"INT",visible:true,type:"L",value:0,default_value:0,nbits:"1",depends_on:["CLK"],behavior:["FIRE C","FIRE C"],fire_name:["svg_p:tspan4199"],draw_data:[[],["svg_p:path3809"]],draw_name:[[],[]]};ep_signals.IORDY={name:"IORDY",visible:true,type:"L",value:0,default_value:0,nbits:"1",depends_on:["CLK"],behavior:["FIRE_IFCHANGED IORDY C","FIRE_IFCHANGED IORDY C"],fire_name:["svg_p:tspan4089","svg_p:path3793","svg_p:text3911"],draw_data:[[],["svg_p:path3897"]],draw_name:[[],[]]};ep_signals.IO_IOR={name:"IO_IOR",visible:true,type:"L",value:0,default_value:0,nbits:"1",behavior:["NOP","IO_IOR BUS_AB BUS_DB IOSR IOCR IODR CLK; FIRE SBWA"],fire_name:["svg_p:tspan4173"],draw_data:[[],["svg_p:path3795","svg_p:path3733"]],draw_name:[[],[]]};ep_signals.IO_IOW={name:"IO_IOW",visible:true,type:"L",value:0,default_value:0,nbits:"1",behavior:["NOP","IO_IOW BUS_AB BUS_DB IOSR IOCR IODR CLK; FIRE SBWA"],fire_name:["svg_p:text3785-0-6-0-5-5"],draw_data:[[],["svg_p:path3805","svg_p:path3733"]],draw_name:[[],[]]};ep_signals.IO_IE={name:"IO_IE",visible:true,type:"L",value:1,default_value:1,nbits:"1",behavior:["NOP","IO_CHK_I CLK INT INTV; FIRE C"],fire_name:[],draw_data:[[],[]],draw_name:[[],[]]};ep_signals.INTA={name:"INTA",visible:true,type:"L",value:1,default_value:0,nbits:"1",behavior:["NOP","INTA CLK INT INTA BUS_DB INTV; FIRE BW; FIRE C"],fire_name:["svg_p:text3785-0-6-0-5-5-1-1"],draw_data:[[],["svg_p:path3807","svg_p:path3737"]],draw_name:[[],[]]};ep_behaviors.IO_IOR={nparameters:7,types:["E","E","E","E","E","E"],operation:function(a){var f=get_value(ep_states[a[1]]);var c=get_value(ep_states[a[3]]);var d=get_value(ep_states[a[4]]);var e=get_value(ep_states[a[5]]);if(f==IOSR_ID){set_value(ep_states[a[2]],c)}if(f==IOCR_ID){set_value(ep_states[a[2]],d)}if(f==IODR_ID){set_value(ep_states[a[2]],e)}},verbal:function(a){var e="";var g=get_value(ep_states[a[1]]);var c=get_value(ep_states[a[3]]);var d=get_value(ep_states[a[4]]);var f=get_value(ep_states[a[5]]);if(g==IOSR_ID){e="I/O device read at IOSR of value "+c+". "}if(g==IOCR_ID){e="I/O device read at IOCR of value "+d+". "}if(g==IODR_ID){e="I/O device read at IODR of value "+f+". "}return e}};ep_behaviors.IO_IOW={nparameters:7,types:["E","E","E","E","E","E"],operation:function(c){var f=get_value(ep_states[c[1]]);var d=get_value(ep_states[c[2]]);if((f!=IOSR_ID)&&(f!=IOCR_ID)&&(f!=IODR_ID)){return}if(f==IOSR_ID){set_value(ep_states[c[3]],d)}if(f==IOCR_ID){set_value(ep_states[c[4]],d)}if(f==IODR_ID){set_value(ep_states[c[5]],d)}var a=get_value(ep_states[c[4]]);var e=get_value(ep_states[c[5]]);if((a<0)||(a>7)){return}set_var(ep_internal_states.io_int_factory[a].period,e);set_var(ep_internal_states.io_int_factory[a].probability,1);if(0==e){set_var(ep_internal_states.io_int_factory[a].probability,0)}},verbal:function(a){var d="";var e=get_value(ep_states[a[1]]);var c=get_value(ep_states[a[2]]);if(e==IOSR_ID){d="I/O device write at IOSR with value "+c+". "}if(e==IOCR_ID){d="I/O device write at IOCR with value "+c+". "}if(e==IODR_ID){d="I/O device write at IODR with value "+c+". "}return d}};ep_behaviors.IO_CHK_I={nparameters:4,types:["E","S","E"],operation:function(a){var d=get_value(ep_states[a[1]]);for(var c=ep_internal_states.io_int_factory.length-1;c>=0;c--){if(get_var(ep_internal_states.io_int_factory[c].period)==0){continue}if(get_var(ep_internal_states.io_int_factory[c].active)==true){set_value(ep_signals[a[2]],1);set_value(ep_states[a[3]],c)}if((d%get_var(ep_internal_states.io_int_factory[c].period))==0){if(Math.random()>get_var(ep_internal_states.io_int_factory[c].probability)){continue}set_var(ep_internal_states.io_int_factory[c].accumulated,get_var(ep_internal_states.io_int_factory[c].accumulated)+1);set_var(ep_internal_states.io_int_factory[c].active,true);if(typeof ep_events.io[d]=="undefined"){ep_events.io[d]=[]}ep_events.io[d].push(c);set_value(ep_signals[a[2]],1);set_value(ep_states[a[3]],c)}}},verbal:function(a){return"Check I/O Interruption. "}};ep_behaviors.INTA={nparameters:6,types:["E","S","S","E","E"],operation:function(a){var d=get_value(ep_states[a[1]]);if(typeof ep_events.io[d]!="undefined"){set_value(ep_states[a[4]],ep_events.io[d][0]);return}set_value(ep_signals[a[2]],0);set_value(ep_states[a[5]],0);for(var c=0;c<ep_internal_states.io_int_factory.length;c++){if(get_var(ep_internal_states.io_int_factory[c].active)){set_value(ep_signals[a[2]],0);set_value(ep_states[a[5]],c);set_value(ep_states[a[4]],c);if(typeof ep_events.io[d]=="undefined"){ep_events.io[d]=[]}ep_events.io[d].push(c);set_var(ep_internal_states.io_int_factory[c].active,false);break}}},verbal:function(a){return"Signal an interruption ACK. "}};ep_behaviors.IO_RESET={nparameters:1,operation:function(a){ep_events.io={};for(var c=0;c<ep_internal_states.io_int_factory.length;c++){set_var(ep_internal_states.io_int_factory[c].accumulated,0);set_var(ep_internal_states.io_int_factory[c].active,false)}},verbal:function(a){return"Reset the I/O device. "}};ep_components.KBD={name:"KBD",version:"1",abilities:["KEYBOARD"],details_name:["KEYBOARD"],details_fire:[["svg_p:text3829"]],write_state:function(a){return a},read_state:function(c,a){return false},get_state:function(a){return null},get_value:function(a){return ep_internal_states.keyboard_content},set_value:function(a,c){ep_internal_states.keyboard_content=c;return c}};var KBDR_ID=256;var KBSR_ID=260;ep_internal_states.io_hash[KBDR_ID]="KBDR";ep_internal_states.io_hash[KBSR_ID]="KBSR";ep_internal_states.keyboard_content="";ep_states.KBDR={name:"KBDR",verbal:"Keyboard Data Register",visible:false,nbits:"32",value:0,default_value:0,draw_data:[]};ep_states.KBSR={name:"KBSR",verbal:"Keyboard Status Register",visible:false,nbits:"32",value:0,default_value:0,draw_data:[]};ep_signals.KBD_IOR={name:"IOR",visible:true,type:"L",value:0,default_value:0,nbits:"1",behavior:["NOP","KBD_IOR BUS_AB BUS_DB KBDR KBSR CLK; FIRE SBWA"],fire_name:["svg_p:tspan4057"],draw_data:[[],["svg_p:path3863","svg_p:path3847"]],draw_name:[[],[]]};ep_behaviors.KBD_IOR={nparameters:6,types:["E","E","E","E","E"],operation:function(d){var f=get_value(ep_states[d[1]]);var e=get_value(ep_states[d[5]]);if((f!=KBDR_ID)&&(f!=KBSR_ID)){return}if(typeof ep_events.keybd[e]!="undefined"){if(f==KBDR_ID){set_value(ep_states[d[2]],ep_events.keybd[e])}if(f==KBSR_ID){set_value(ep_states[d[2]],1)}return}if(get_value(ep_states[d[4]])==0){var c=get_keyboard_content();if(c.length!==0){var a=c.substr(1,c.length-1);set_keyboard_content(a);set_value(ep_states[d[4]],1);set_value(ep_states[d[3]],c[0].charCodeAt(0))}}if(get_value(ep_states[d[4]])==1){ep_events.keybd[e]=get_value(ep_states[d[3]])}if(f==KBSR_ID){set_value(ep_states[d[2]],get_value(ep_states[d[4]]))}if(f==KBDR_ID){if(get_value(ep_states[d[4]])==1){set_value(ep_states[d[2]],get_value(ep_states[d[3]]))}set_value(ep_states[d[4]],0)}},verbal:function(a){var c="";var e=get_value(ep_states[a[1]]);var d=get_value(ep_states[a[5]]);if(e==KBDR_ID){c="Read the screen data: "+ep_states[a[2]]+". "}if(e==KBSR_ID){c="Read the screen state: "+ep_states[a[2]]+". "}return c}};ep_behaviors.KBD_RESET={nparameters:1,operation:function(a){ep_events.keybd={}},verbal:function(a){return"Reset the keyboard content. "}};ep_components.SCREEN={name:"SCREEN",version:"1",abilities:["SCREEN"],details_name:["SCREEN"],details_fire:[["svg_p:text3845"]],write_state:function(c){if(typeof c.SCREEN=="undefined"){c.SCREEN={}}var e=ep_internal_states.screen_content;var d=e.trim().split("\n");for(var a=0;a<d.length;a++){value=d[a];if(value!=""){c.SCREEN[a]={type:"screen",default_value:"",id:a,op:"==",value:value}}}return c},read_state:function(c,a){if(typeof c.SCREEN=="undefined"){c.SCREEN={}}if("SCREEN"==a.type.toUpperCase().trim()){c.SCREEN[a.id]={type:"screen",default_value:"",id:a.id,op:a.condition,value:a.value};return true}return false},get_state:function(a){var e=ep_internal_states.screen_content;var d=e.trim().split("\n");var c=parseInt(a);if(typeof d[c]!="undefined"){return d[c]}return null},get_value:function(a){return ep_internal_states.screen_content},set_value:function(a,c){ep_internal_states.screen_content=c;return c}};var DDR_ID=4096;var DSR_ID=4100;ep_internal_states.io_hash[DDR_ID]="DDR";ep_internal_states.io_hash[DSR_ID]="DSR";ep_internal_states.screen_content="";ep_states.DDR={name:"DDR",verbal:"Display Data Register",visible:false,nbits:"32",value:0,default_value:0,draw_data:[]};ep_states.DSR={name:"DSR",verbal:"Display State Register",visible:false,nbits:"32",value:0,default_value:0,draw_data:[]};ep_signals.SCR_IOR={name:"IOR",visible:true,type:"L",value:0,default_value:0,nbits:"1",behavior:["NOP","SCR_IOR BUS_AB BUS_DB DDR DSR CLK"],fire_name:["svg_p:tspan4004"],draw_data:[[],["svg_p:path3871","svg_p:path3857"]],draw_name:[[],[]]};ep_signals.SCR_IOW={name:"IOW",visible:true,type:"L",value:0,default_value:0,nbits:"1",behavior:["NOP","SCR_IOW BUS_AB BUS_DB DDR DSR CLK"],fire_name:["svg_p:tspan4006"],draw_data:[[],["svg_p:path3873","svg_p:path3857"]],draw_name:[[],[]]};ep_behaviors.SCR_IOR={nparameters:6,types:["E","E","E","E","E"],operation:function(c){var e=get_value(ep_states[c[1]]);var d=get_value(ep_states[c[3]]);var a=get_value(ep_states[c[4]]);if(e==DDR_ID){set_value(ep_states[c[2]],d)}if(e==DSR_ID){set_value(ep_states[c[2]],a)}},verbal:function(c){var e="";var f=get_value(ep_states[c[1]]);var d=get_value(ep_states[c[3]]);var a=get_value(ep_states[c[4]]);if(f==DDR_ID){e="Try to read from the screen the DDR value "+d+". "}if(f==DDR_ID){e="Try to read into the screen the DSR value "+a+". "}return e}};ep_behaviors.SCR_IOW={nparameters:6,types:["E","E","E","E","E"],operation:function(d){var k=get_value(ep_states[d[1]]);var f=get_value(ep_states[d[2]]);var h=get_value(ep_states[d[5]]);var g=String.fromCharCode(f);if(k!=DDR_ID){return}if(g==String.fromCharCode(7)){timbre.reset();var e=T("sin",{freq:440,mul:0.5});var c=T("sin",{freq:660,mul:0.5});T("perc",{r:500},e,c).on("ended",function(){this.pause()}).bang().play()}else{var a=get_screen_content();if(typeof ep_events.screen[h]!="undefined"){a=a.substr(0,a.length-1)}set_screen_content(a+String.fromCharCode(f))}set_value(ep_states[d[3]],f);set_value(ep_states[d[4]],1);ep_events.screen[h]=f},verbal:function(a){var e="";var g=get_value(ep_states[a[1]]);var c=get_value(ep_states[a[2]]);var f=get_value(ep_states[a[5]]);var d=String.fromCharCode(c);if(g==DDR_ID){e="Try to write into the screen the code "+d+" at clock cycle "+f+". "}return e}};ep_behaviors.SCREEN_RESET={nparameters:1,operation:function(a){ep_events.screen={}},verbal:function(a){return"Reset the screen content. "}};var poc_components={};var poc_states={};var poc_events={};var poc_signals={};var poc_behaviors={};var poc_internal_states={};var poc_ctrl_states={};var poc_def={sim_name:"Proof-Of-Concept Processor",sim_short_name:"poc",sim_img_processor:"examples/hardware/poc/images/processor.svg",sim_img_controlunit:"examples/hardware/poc/images/controlunit.svg",sim_img_cpu:"examples/hardware/poc/images/cpu.svg",components:poc_components,states:poc_states,signals:poc_signals,behaviors:poc_behaviors,events:poc_events,internal_states:poc_internal_states,ctrl_states:poc_ctrl_states};simhw_add(poc_def);poc_behaviors.PRINT_S={nparameters:2,types:["S"],operation:function(a){console.log(a[1]+": 0x"+poc_signals[a[1]].value.toString(16))},verbal:function(a){return"Print value of signal "+a[1]+": 0x"+poc_signals[a[1]].value.toString(16)+". "}};poc_behaviors.PRINT_E={nparameters:2,types:["E"],operation:function(a){console.log(a[1]+": 0x"+poc_states[a[1]].value.toString(16))},verbal:function(a){return"Print value of state "+a[1]+": 0x"+poc_states[a[1]].value.toString(16)+". "}};poc_components.CPU={name:"CPU",version:"1",abilities:["CPU"],details_name:["REGISTER_FILE","CONTROL_MEMORY","CLOCK","CPU_STATS"],details_fire:[["svg_p:text3495","svg_p:text3029","svg_p:text3031"],["svg_cu:text3010"],["svg_p:text3459-7","svg_cu:text4138","svg_cu:text4138-7","svg_cu:tspan4140-2"],["svg_p:text3495"]],write_state:function(d){if(typeof d.CPU=="undefined"){d.CPU={}}var a=["PC","SR"];var e=0;for(var c=0;c<poc_states.BR.length;c++){e=parseInt(poc_states.BR[c].value);if(e!=0){d.CPU["R"+c]={type:"register",default_value:0,id:"R"+c,op:"=",value:"0x"+e.toString(16)}}}for(var c=0;c<a.length;c++){e=parseInt(poc_states["REG_"+a[c]].value);if(e!=0){d.CPU[a[c]]={type:"register",default_value:0,id:a[c],op:"=",value:"0x"+e.toString(16)}}}return d},read_state:function(d,a){if(typeof d.CPU=="undefined"){d.CPU={}}var c=a.id.toUpperCase().trim();var e=parseInt(a.value).toString(16);if("REGISTER"==a.type.toUpperCase().trim()){d.CPU[c]={type:"register",default_value:0,id:c,op:a.condition,value:"0x"+e};return true}return false},get_state:function(c){var d=c.toUpperCase().trim();if(typeof poc_states["REG_"+d]!="undefined"){return"0x"+get_value(poc_states["REG_"+d]).toString(16)}d=d.replace("R","");var a=parseInt(d);if(typeof poc_states.BR[a]!="undefined"){return"0x"+get_value(poc_states.BR[a]).toString(16)}return null},get_value:function(a){if(Number.isInteger(a)){index=a}else{index=parseInt(a)}if(isNaN(index)){return(get_value(simhw_sim_state(a))>>>0)}return(get_value(simhw_sim_states().BR[index])>>>0)},set_value:function(c,d){var a=simhw_sim_ctrlStates_get().pc.state;if(Number.isInteger(c)){index=c}else{index=parseInt(c)}if(isNaN(index)){set_value(simhw_sim_state(c),d);if(a===c){show_asmdbg_pc()}return d}return set_value(simhw_sim_states().BR[index],d)}};poc_ctrl_states.pc={name:"PC",state:"REG_PC"};poc_ctrl_states.sp={name:"SP",state:"BR.29"};poc_ctrl_states.ir={name:"IR",state:"REG_IR",default_eltos:{co:{begin:0,end:5,length:6},cop:{begin:27,end:31,length:5}}};poc_ctrl_states.mpc={name:"mPC",state:"REG_MICROADDR"};poc_internal_states.MC={};poc_internal_states.MC_dashboard={};poc_internal_states.ROM={};poc_internal_states.FIRMWARE={};poc_internal_states.io_hash={};poc_internal_states.fire_stack=[];poc_internal_states.tri_state_names=["T1","T2","T3","T6","T8","T9","T10","T11"];poc_internal_states.fire_visible={databus:false,internalbus:false};poc_internal_states.filter_states=["REG_IR_DECO,col-11","REG_IR,col-auto","REG_PC,col-auto","REG_SR,col-auto","REG_RT1,col-auto","REG_MAR,col-auto","REG_MBR,col-auto","REG_MICROADDR,col-auto"];poc_internal_states.filter_signals=["A0,0","B,0","C,0","SELA,5","SELB,5","SELC,2","SELCOP,0","MR,0","MC,0","C0,0","C1,0","C2,0","C3,0","C4,0","C7,0","T1,0","T2,0","T3,0","T6,0","T8,0","T9,0","T10,0","T11,0","M1,0","M7,0","MA,0","MB,0","LC,0","SE,0","SIZE,0","OFFSET,0","BW,0","R,0","W,0","TA,0","TD,0","IOR,0","IOW,0","TEST_I,0","TEST_U,0"];poc_internal_states.alu_flags={flag_n:0,flag_z:0,flag_v:0,flag_c:0};poc_states.BR=[];poc_states.BR[0]={name:"R0",verbal:"Register  0",visible:true,nbits:"32",value:0,default_value:0,draw_data:[]};poc_states.BR[1]={name:"R1",verbal:"Register  1",visible:true,nbits:"32",value:0,default_value:0,draw_data:[]};poc_states.BR[2]={name:"R2",verbal:"Register  2",visible:true,nbits:"32",value:0,default_value:0,draw_data:[]};poc_states.BR[3]={name:"R3",verbal:"Register  3",visible:true,nbits:"32",value:0,default_value:0,draw_data:[]};poc_states.BR[4]={name:"R4",verbal:"Register  4",visible:true,nbits:"32",value:0,default_value:0,draw_data:[]};poc_states.BR[5]={name:"R5",verbal:"Register  5",visible:true,nbits:"32",value:0,default_value:0,draw_data:[]};poc_states.BR[6]={name:"R6",verbal:"Register  6",visible:true,nbits:"32",value:0,default_value:0,draw_data:[]};poc_states.BR[7]={name:"R7",verbal:"Register  7",visible:true,nbits:"32",value:0,default_value:0,draw_data:[]};poc_states.BR[8]={name:"R8",verbal:"Register  8",visible:true,nbits:"32",value:0,default_value:0,draw_data:[]};poc_states.BR[9]={name:"R9",verbal:"Register  9",visible:true,nbits:"32",value:0,default_value:0,draw_data:[]};poc_states.BR[10]={name:"R10",verbal:"Register 10",visible:true,nbits:"32",value:0,default_value:0,draw_data:[]};poc_states.BR[11]={name:"R11",verbal:"Register 11",visible:true,nbits:"32",value:0,default_value:0,draw_data:[]};poc_states.BR[12]={name:"R12",verbal:"Register 12",visible:true,nbits:"32",value:0,default_value:0,draw_data:[]};poc_states.BR[13]={name:"R13",verbal:"Register 13",visible:true,nbits:"32",value:0,default_value:0,draw_data:[]};poc_states.BR[14]={name:"R14",verbal:"Register 14",visible:true,nbits:"32",value:0,default_value:0,draw_data:[]};poc_states.BR[15]={name:"R15",verbal:"Register 15",visible:true,nbits:"32",value:0,default_value:0,draw_data:[]};poc_states.BR[16]={name:"R16",verbal:"Register 16",visible:true,nbits:"32",value:0,default_value:0,draw_data:[]};poc_states.BR[17]={name:"R17",verbal:"Register 17",visible:true,nbits:"32",value:0,default_value:0,draw_data:[]};poc_states.BR[18]={name:"R18",verbal:"Register 18",visible:true,nbits:"32",value:0,default_value:0,draw_data:[]};poc_states.BR[19]={name:"R19",verbal:"Register 19",visible:true,nbits:"32",value:0,default_value:0,draw_data:[]};poc_states.BR[20]={name:"R20",verbal:"Register 20",visible:true,nbits:"32",value:0,default_value:0,draw_data:[]};poc_states.BR[21]={name:"R21",verbal:"Register 21",visible:true,nbits:"32",value:0,default_value:0,draw_data:[]};poc_states.BR[22]={name:"R22",verbal:"Register 22",visible:true,nbits:"32",value:0,default_value:0,draw_data:[]};poc_states.BR[23]={name:"R23",verbal:"Register 23",visible:true,nbits:"32",value:0,default_value:0,draw_data:[]};poc_states.BR[24]={name:"R24",verbal:"Register 24",visible:true,nbits:"32",value:0,default_value:0,draw_data:[]};poc_states.BR[25]={name:"R25",verbal:"Register 25",visible:true,nbits:"32",value:0,default_value:0,draw_data:[]};poc_states.BR[26]={name:"R26",verbal:"Register 26",visible:true,nbits:"32",value:0,default_value:0,draw_data:[]};poc_states.BR[27]={name:"R27",verbal:"Register 27",visible:true,nbits:"32",value:0,default_value:0,draw_data:[]};poc_states.BR[28]={name:"R28",verbal:"Register 28",visible:true,nbits:"32",value:0,default_value:0,draw_data:[]};poc_states.BR[29]={name:"R29",verbal:"Register 29",visible:true,nbits:"32",value:0,default_value:0,draw_data:[]};poc_states.BR[30]={name:"R30",verbal:"Register 30",visible:true,nbits:"32",value:0,default_value:0,draw_data:[]};poc_states.BR[31]={name:"R31",verbal:"Register 31",visible:true,nbits:"32",value:0,default_value:0,draw_data:[]};poc_states.BR[32]={name:"R32",verbal:"Register 32",visible:true,nbits:"32",value:0,default_value:0,draw_data:[]};poc_states.BR[33]={name:"R33",verbal:"Register 33",visible:true,nbits:"32",value:0,default_value:0,draw_data:[]};poc_states.BR[34]={name:"R34",verbal:"Register 34",visible:true,nbits:"32",value:0,default_value:0,draw_data:[]};poc_states.BR[35]={name:"R35",verbal:"Register 35",visible:true,nbits:"32",value:0,default_value:0,draw_data:[]};poc_states.BR[36]={name:"R36",verbal:"Register 36",visible:true,nbits:"32",value:0,default_value:0,draw_data:[]};poc_states.BR[37]={name:"R37",verbal:"Register 37",visible:true,nbits:"32",value:0,default_value:0,draw_data:[]};poc_states.BR[38]={name:"R38",verbal:"Register 38",visible:true,nbits:"32",value:0,default_value:0,draw_data:[]};poc_states.BR[39]={name:"R39",verbal:"Register 39",visible:true,nbits:"32",value:0,default_value:0,draw_data:[]};poc_states.BR[40]={name:"R40",verbal:"Register 40",visible:true,nbits:"32",value:0,default_value:0,draw_data:[]};poc_states.BR[41]={name:"R41",verbal:"Register 41",visible:true,nbits:"32",value:0,default_value:0,draw_data:[]};poc_states.BR[42]={name:"R42",verbal:"Register 42",visible:true,nbits:"32",value:0,default_value:0,draw_data:[]};poc_states.BR[43]={name:"R43",verbal:"Register 43",visible:true,nbits:"32",value:0,default_value:0,draw_data:[]};poc_states.BR[44]={name:"R44",verbal:"Register 44",visible:true,nbits:"32",value:0,default_value:0,draw_data:[]};poc_states.BR[45]={name:"R45",verbal:"Register 45",visible:true,nbits:"32",value:0,default_value:0,draw_data:[]};poc_states.BR[46]={name:"R46",verbal:"Register 46",visible:true,nbits:"32",value:0,default_value:0,draw_data:[]};poc_states.BR[47]={name:"R47",verbal:"Register 47",visible:true,nbits:"32",value:0,default_value:0,draw_data:[]};poc_states.BR[48]={name:"R48",verbal:"Register 48",visible:true,nbits:"32",value:0,default_value:0,draw_data:[]};poc_states.BR[49]={name:"R49",verbal:"Register 49",visible:true,nbits:"32",value:0,default_value:0,draw_data:[]};poc_states.BR[50]={name:"R50",verbal:"Register 50",visible:true,nbits:"32",value:0,default_value:0,draw_data:[]};poc_states.BR[51]={name:"R51",verbal:"Register 51",visible:true,nbits:"32",value:0,default_value:0,draw_data:[]};poc_states.BR[52]={name:"R52",verbal:"Register 52",visible:true,nbits:"32",value:0,default_value:0,draw_data:[]};poc_states.BR[53]={name:"R53",verbal:"Register 53",visible:true,nbits:"32",value:0,default_value:0,draw_data:[]};poc_states.BR[54]={name:"R54",verbal:"Register 54",visible:true,nbits:"32",value:0,default_value:0,draw_data:[]};poc_states.BR[55]={name:"R55",verbal:"Register 55",visible:true,nbits:"32",value:0,default_value:0,draw_data:[]};poc_states.BR[56]={name:"R56",verbal:"Register 56",visible:true,nbits:"32",value:0,default_value:0,draw_data:[]};poc_states.BR[57]={name:"R57",verbal:"Register 57",visible:true,nbits:"32",value:0,default_value:0,draw_data:[]};poc_states.BR[58]={name:"R58",verbal:"Register 58",visible:true,nbits:"32",value:0,default_value:0,draw_data:[]};poc_states.BR[59]={name:"R59",verbal:"Register 59",visible:true,nbits:"32",value:0,default_value:0,draw_data:[]};poc_states.BR[60]={name:"R60",verbal:"Register 60",visible:true,nbits:"32",value:0,default_value:0,draw_data:[]};poc_states.BR[61]={name:"R61",verbal:"Register 61",visible:true,nbits:"32",value:0,default_value:0,draw_data:[]};poc_states.BR[62]={name:"R62",verbal:"Register 62",visible:true,nbits:"32",value:0,default_value:0,draw_data:[]};poc_states.BR[63]={name:"R63",verbal:"Register 63",visible:true,nbits:"32",value:0,default_value:0,draw_data:[]};poc_states.REG_PC={name:"PC",verbal:"Program Counter Register",visible:true,nbits:"32",value:0,default_value:0,draw_data:[]};poc_states.REG_MAR={name:"MAR",verbal:"Memory Address Register",visible:true,nbits:"32",value:0,default_value:0,draw_data:[]};poc_states.REG_MBR={name:"MBR",verbal:"Memory Data Register",visible:true,nbits:"32",value:0,default_value:0,draw_data:[]};poc_states.REG_IR={name:"IR",verbal:"Instruction Register",visible:true,nbits:"32",value:0,default_value:0,draw_data:[]};poc_states.REG_SR={name:"SR",verbal:"State Register",visible:true,nbits:"32",value:0,default_value:0,draw_data:[]};poc_states.REG_RT1={name:"RT1",verbal:"Temporal Register 1",visible:true,nbits:"32",value:0,default_value:0,draw_data:[]};poc_states.BUS_IB={name:"I_BUS",verbal:"Internal Bus",visible:false,nbits:"32",value:0,default_value:0,draw_data:[]};poc_states.BUS_AB={name:"A_BUS",verbal:"Address Bus",visible:false,nbits:"32",value:0,default_value:0,draw_data:[]};poc_states.BUS_CB={name:"C_BUS",verbal:"Control Bus",visible:false,nbits:"32",value:0,default_value:0,draw_data:[]};poc_states.BUS_DB={name:"D_BUS",verbal:"Data Bus",visible:false,nbits:"32",value:0,default_value:0,draw_data:[]};poc_states.RA_T9={name:"RA_T9",verbal:"Input of T9 Tristate",visible:false,nbits:"32",value:0,default_value:0,draw_data:[]};poc_states.RB_T10={name:"RB_T10",verbal:"Input of T10 Tristate",visible:false,nbits:"32",value:0,default_value:0,draw_data:[]};poc_states.SELEC_T3={name:"SELEC_T3",verbal:"Input of T3 Tristate",visible:false,nbits:"32",value:0,default_value:0,draw_data:[]};poc_states.ALU_T6={name:"ALU_T6",verbal:"Input of T6 Tristate",visible:false,nbits:"32",value:0,default_value:0,draw_data:[]};poc_states.MA_ALU={name:"MA_ALU",verbal:"Input ALU via MA",visible:false,nbits:"32",value:0,default_value:0,draw_data:[]};poc_states.MB_ALU={name:"MB_ALU",verbal:"Input ALU via MB",visible:false,nbits:"32",value:0,default_value:0,draw_data:[]};poc_states.FLAG_C={name:"FLAG_C",verbal:"Carry Flag",visible:true,nbits:"1",value:0,default_value:0,draw_data:[]};poc_states.FLAG_V={name:"FLAG_V",verbal:"Overflow Flag",visible:true,nbits:"1",value:0,default_value:0,draw_data:[]};poc_states.FLAG_N={name:"FLAG_N",verbal:"Negative Flag",visible:true,nbits:"1",value:0,default_value:0,draw_data:[]};poc_states.FLAG_Z={name:"FLAG_Z",verbal:"Zero Flag",visible:true,nbits:"1",value:0,default_value:0,draw_data:[]};poc_states.FLAG_I={name:"FLAG_I",verbal:"Interruption Flag",visible:true,nbits:"1",value:0,default_value:0,draw_data:[]};poc_states.FLAG_U={name:"FLAG_U",verbal:"User Flag",visible:true,nbits:"1",value:0,default_value:0,draw_data:[]};poc_states.REG_MICROADDR={name:"µADDR",verbal:"Microaddress Register",visible:true,nbits:"12",value:0,default_value:0,draw_data:["svg_cu:text4667"]};poc_states.REG_MICROINS={name:"µINS",verbal:"Microinstruction Register",visible:true,nbits:"77",value:{},default_value:{},draw_data:[]};poc_states.FETCH={name:"FETCH",verbal:"Input Fetch",visible:false,nbits:"12",value:0,default_value:0,draw_data:[]};poc_states.ROM_MUXA={name:"ROM_MUXA",verbal:"Input ROM",visible:false,nbits:"12",value:0,default_value:0,draw_data:[]};poc_states.SUM_ONE={name:"SUM_ONE",verbal:"Input next microinstruction",visible:false,nbits:"12",value:1,default_value:1,draw_data:[]};poc_states.MUXA_MICROADDR={name:"MUXA_MICROADDR",verbal:"Input microaddress",visible:false,nbits:"12",value:0,default_value:0,draw_data:[]};poc_states.MUXC_MUXB={name:"MUXC_MUXB",verbal:"Output of MUX C",visible:false,nbits:"1",value:0,default_value:0,draw_data:[]};poc_states.INEX={name:"INEX",verbal:"Illegal Instruction Exception",visible:false,nbits:"1",value:0,default_value:0,draw_data:[]};poc_states.BS_M1={name:"BS_M1",verbal:"from Memory",visible:false,nbits:"32",value:0,default_value:0,draw_data:[]};poc_states.BS_TD={name:"BS_TD",verbal:"Memory",visible:false,nbits:"32",value:0,default_value:0,draw_data:[]};poc_states.INTV={name:"INTV",verbal:"Interruption Vector",visible:false,nbits:"8",value:0,default_value:0,draw_data:[]};poc_states.M1_C1={name:"M1_C1",verbal:"Input of Memory Data Register",visible:false,nbits:"32",value:0,default_value:0,draw_data:[]};poc_states.M7_C7={name:"M7_C7",verbal:"Input of State Register",visible:false,nbits:"32",value:0,default_value:0,draw_data:[]};poc_states.VAL_ZERO={name:"VAL_ZERO",verbal:"Wired Zero",visible:false,nbits:"1",value:0,default_value:0,draw_data:[]};poc_states.VAL_ONE={name:"VAL_ONE",verbal:"Wired One",visible:false,nbits:"32",value:1,default_value:1,draw_data:[]};poc_states.VAL_FOUR={name:"VAL_FOUR",verbal:"Wired Four",visible:false,nbits:"32",value:4,default_value:4,draw_data:[]};poc_states.REG_IR_DECO={name:"IR_DECO",verbal:"Instruction Decoded",visible:true,nbits:"0",value:0,default_value:0,draw_data:[]};poc_states.DECO_INS={name:"DECO_INS",verbal:"Instruction decoded in binary",visible:true,nbits:"32",value:0,default_value:0,draw_data:[]};poc_states.CLK={name:"CLK",verbal:"Clock",visible:false,nbits:"32",value:0,default_value:0,draw_data:[]};poc_signals.C={name:"C",visible:true,type:"L",value:0,default_value:0,nbits:"4",behavior:["MV MUXC_MUXB VAL_ZERO; FIRE_IFCHANGED B MUXC_MUXB; RESET_CHANGED MUXC_MUXB","MBIT MUXC_MUXB INT 0 1; FIRE_IFCHANGED B MUXC_MUXB; RESET_CHANGED MUXC_MUXB","MBIT MUXC_MUXB IORDY 0 1; FIRE_IFCHANGED B MUXC_MUXB; RESET_CHANGED MUXC_MUXB","MBIT MUXC_MUXB MRDY 0 1; FIRE_IFCHANGED B MUXC_MUXB; RESET_CHANGED MUXC_MUXB","MBIT MUXC_MUXB REG_SR 0 1; FIRE_IFCHANGED B MUXC_MUXB; RESET_CHANGED MUXC_MUXB","MBIT MUXC_MUXB REG_SR 1 1; FIRE_IFCHANGED B MUXC_MUXB; RESET_CHANGED MUXC_MUXB","MBIT MUXC_MUXB REG_SR 28 1; FIRE_IFCHANGED B MUXC_MUXB; RESET_CHANGED MUXC_MUXB","MBIT MUXC_MUXB REG_SR 29 1; FIRE_IFCHANGED B MUXC_MUXB; RESET_CHANGED MUXC_MUXB","MBIT MUXC_MUXB REG_SR 30 1; FIRE_IFCHANGED B MUXC_MUXB; RESET_CHANGED MUXC_MUXB","MBIT MUXC_MUXB REG_SR 31 1; FIRE_IFCHANGED B MUXC_MUXB; RESET_CHANGED MUXC_MUXB","MV MUXC_MUXB INEX; FIRE_IFCHANGED B MUXC_MUXB; RESET_CHANGED MUXC_MUXB"],fire_name:["svg_cu:text3410"],draw_data:[["svg_cu:path3108"],["svg_cu:path3062"],["svg_cu:path3060"],["svg_cu:path3136"],["svg_cu:path3482"],["svg_cu:path3480"],["svg_cu:path3488"],["svg_cu:path3486"],["svg_cu:path3484"],["svg_cu:path3484-9"],["svg_cu:path3108-3","svg_cu:path3260-3-8-6","svg_cu:path3260-3-8","svg_cu:path3260-3"]],draw_name:[["svg_cu:path3496","svg_cu:path3414","svg_cu:path3194-08"]]};poc_signals.B={name:"B",visible:true,type:"L",value:0,default_value:0,nbits:"1",behavior:["MV A1 MUXC_MUXB; FIRE A1","NOT_ES A1 MUXC_MUXB; FIRE A1"],depends_on:["CLK"],fire_name:["svg_cu:text3408"],draw_data:[["svg_cu:path3094-7"],["svg_cu:path3392","svg_cu:path3372","svg_cu:path3390","svg_cu:path3384","svg_cu:path3108-1","svg_cu:path3100-8-7"]],draw_name:[[],["svg_cu:path3194-0","svg_cu:path3138-8","svg_cu:path3498-6"]]};poc_signals.A0={name:"A0",visible:false,type:"L",value:0,default_value:0,nbits:"1",behavior:["SBIT_SIGNAL A0A1 0 1; FIRE A0A1","SBIT_SIGNAL A0A1 1 1; FIRE A0A1"],depends_on:["CLK"],fire_name:["svg_cu:text3406"],draw_data:[["svg_cu:path3096"],["svg_cu:path3096"]],draw_name:[[],["svg_cu:path3138-8-1","svg_cu:path3098-2","svg_cu:path3124-2-5"]]};poc_signals.A1={name:"A1",visible:false,type:"L",value:0,default_value:0,nbits:"1",behavior:["SBIT_SIGNAL A0A1 0 0; FIRE A0A1","SBIT_SIGNAL A0A1 1 0; FIRE A0A1"],depends_on:["CLK"],fire_name:[],draw_data:[["svg_cu:path3094"],["svg_cu:path3094"]],draw_name:[[]]};poc_signals.A0A1={name:"A0A1",visible:true,type:"L",value:0,default_value:0,nbits:"2",behavior:["PLUS1 MUXA_MICROADDR REG_MICROADDR","CP_FIELD MUXA_MICROADDR REG_MICROINS/MADDR","MV MUXA_MICROADDR ROM_MUXA","MV MUXA_MICROADDR FETCH"],depends_on:["CLK"],fire_name:[],draw_data:[["svg_cu:path3102","svg_cu:path3100","svg_cu:path3098","svg_cu:path3100-9","svg_cu:path3088"],["svg_cu:path3104","svg_cu:path3134","svg_cu:path3500","svg_cu:path3416"],["svg_cu:path3504","svg_cu:path3100-8","svg_cu:path3234-9"],["svg_cu:path3124"]],draw_name:[[]]};poc_signals.C0={name:"C0",visible:true,type:"E",value:0,default_value:0,nbits:"1",behavior:["NOP","MV REG_MAR BUS_IB"],fire_name:["svg_p:text3077"],draw_data:[["svg_p:path3081"]],draw_name:[["svg_p:path3075"]]};poc_signals.C1={name:"C1",visible:true,type:"E",value:0,default_value:0,nbits:"1",behavior:["NOP","MV REG_MBR M1_C1"],fire_name:["svg_p:text3079"],draw_data:[["svg_p:path3055"]],draw_name:[["svg_p:path3073"]]};poc_signals.C2={name:"C2",visible:true,type:"E",value:0,default_value:0,nbits:"1",behavior:["NOP","MV REG_PC BUS_IB; UPDATEDPC"],fire_name:["svg_p:text3179"],draw_data:[["svg_p:path3217"]],draw_name:[["svg_p:path3177"]]};poc_signals.C3={name:"C3",visible:true,type:"E",value:0,default_value:0,nbits:"1",behavior:["NOP","MV REG_IR BUS_IB; DECO; FIRE_IFSET C 10"],fire_name:["svg_p:text3439"],draw_data:[["svg_p:path3339","svg_p:path3913-4"]],draw_name:[["svg_p:path3337"]]};poc_signals.C4={name:"C4",visible:true,type:"E",value:0,default_value:0,nbits:"1",behavior:["NOP","MV REG_RT1 BUS_IB"],fire_name:["svg_p:tspan482"],draw_data:[["svg_p:path3339-4"]],draw_name:[["svg_p:path3337-0"]]};poc_signals.C7={name:"C7",visible:true,type:"E",value:0,default_value:0,nbits:"1",behavior:["NOP","MV REG_SR M7_C7; FIRE C"],fire_name:["svg_p:text3655"],draw_data:[["svg_p:path3651-9"]],draw_name:[["svg_p:path3681"]]};poc_signals.TA={name:"TA",visible:true,type:"L",value:0,default_value:0,nbits:"1",behavior:["NOP","MV BUS_AB REG_MAR"],fire_name:["svg_p:text3091"],draw_data:[["svg_p:path3089","svg_p:path3597","svg_p:path3513","svg_p:path3601","svg_p:path3601-2","svg_p:path3187","svg_p:path3087","svg_p:path2995","svg_p:path3535"]],draw_name:[["svg_p:path3085"]]};poc_signals.TD={name:"TD",visible:true,type:"L",value:0,default_value:0,nbits:"1",behavior:["NOP","MV BUS_DB REG_MBR; FIRE R; FIRE W"],fire_name:["svg_p:text3103"],draw_data:[["svg_p:path3101","svg_p:path3587","svg_p:path3419-8","svg_p:path3071","svg_p:path3099","svg_p:path3097","svg_p:path3559-5","svg_p:path3419-1-0","svg_p:path3583","svg_p:path3419-1","svg_p:path3491","svg_p:path3641","svg_p:path3541"]],draw_name:[["svg_p:path3095"]]};poc_signals.T1={name:"T1",visible:true,type:"L",value:0,default_value:0,nbits:"1",behavior:["NOP","MV BUS_IB REG_MBR; FIRE M7; FIRE M1"],fire_name:["svg_p:text3105"],draw_data:[["svg_p:path3071","svg_p:path3069","svg_p:path3049","svg_p:path3063-9","svg_p:path3071"]],draw_name:[["svg_p:path3067"]]};poc_signals.T2={name:"T2",visible:true,type:"L",value:0,default_value:0,nbits:"1",behavior:["NOP","MV BUS_IB REG_PC; FIRE M7; FIRE M1"],fire_name:["svg_p:text3449"],draw_data:[["svg_p:path3199","svg_p:path3201","svg_p:path3049"]],draw_name:[["svg_p:path3329"]]};poc_signals.T3={name:"T3",visible:true,type:"L",value:0,default_value:0,nbits:"1",behavior:["NOP","MV BUS_IB SELEC_T3; FIRE M7; FIRE M1"],fire_name:["svg_p:text3451"],draw_data:[["svg_p:path3349","svg_p:path3931","svg_p:path3345","svg_p:path3049"]],draw_name:[["svg_p:path3351"]]};poc_signals.T6={name:"T6",visible:true,type:"L",value:0,default_value:0,nbits:"1",behavior:["NOP","MV BUS_IB ALU_T6; FIRE M7; FIRE M1"],fire_name:["svg_p:text3457"],draw_data:[["svg_p:path3589","svg_p:path3317","svg_p:path3163-2","svg_p:path3049","svg_p:path3317-9","svg_p:path3321","svg_p:path3261-8"]],draw_name:[["svg_p:path3319"]]};poc_signals.T8={name:"T8",visible:true,type:"L",value:0,default_value:0,nbits:"1",behavior:["NOP","MV BUS_IB REG_SR; FIRE M7; FIRE M1"],fire_name:["svg_p:text3657"],draw_data:[["svg_p:path3651","svg_p:path3647","svg_p:path3049"]],draw_name:[["svg_p:path3649"]]};poc_signals.T9={name:"T9",visible:true,type:"L",value:0,default_value:0,nbits:"1",behavior:["NOP","MV BUS_IB RA_T9; FIRE M7; FIRE M1"],fire_name:["svg_p:text3147"],draw_data:[["svg_p:path3143","svg_p:path3139","svg_p:path3049","svg_p:path3143-9"]],draw_name:[["svg_p:path3133"]]};poc_signals.T10={name:"T10",visible:true,type:"L",value:0,default_value:0,nbits:"1",behavior:["NOP","MV BUS_IB RB_T10; FIRE M7; FIRE M1"],fire_name:["svg_p:text3149"],draw_data:[["svg_p:path3145","svg_p:path3141","svg_p:path3049","svg_p:path3145-5"]],draw_name:[["svg_p:path3137"]]};poc_signals.T11={name:"T11",visible:true,type:"L",value:0,default_value:0,nbits:"1",behavior:["NOP","CP_FIELD BUS_IB REG_MICROINS/EXCODE; FIRE M7; FIRE M1"],fire_name:["svg_p:text3147-5","svg_cu:tspan4426"],draw_data:[["svg_p:path3081-3","svg_p:path3139-7","svg_p:path3049","svg_cu:path3081-3","svg_cu:path3139-7","svg_cu:path3502"]],draw_name:[["svg_p:path3133-6","svg_cu:path3133-6"]]};poc_signals.M1={name:"M1",visible:true,type:"L",value:0,default_value:0,nbits:"1",behavior:["MV M1_C1 BUS_IB","MV M1_C1 BUS_DB"],depends_on:["C1"],fire_name:["svg_p:text3469"],draw_data:[["svg_p:path3063","svg_p:path3061","svg_p:path3059"],["svg_p:path3057","svg_p:path3641","svg_p:path3419","svg_p:path3583"]],draw_name:[[],["svg_p:path3447"]]};poc_signals.M7={name:"M7",visible:true,type:"L",value:0,default_value:0,nbits:"1",behavior:["MV M7_C7 BUS_IB","MV M7_C7 REG_SR; UPDATE_FLAG M7_C7 FLAG_C 31; UPDATE_FLAG M7_C7 FLAG_V 30; UPDATE_FLAG M7_C7 FLAG_N 29; UPDATE_FLAG M7_C7 FLAG_Z 28"],depends_on:["C7"],fire_name:["svg_p:text3673"],draw_data:[["svg_p:path3691","svg_p:path3693","svg_p:path3659"],["svg_p:path3695"]],draw_name:[[],["svg_p:path3667"]]};poc_signals.MA={name:"MA",visible:true,type:"L",value:0,default_value:0,nbits:"1",behavior:["MV MA_ALU RA_T9; FIRE COP","MV MA_ALU BUS_IB; FIRE COP"],depends_on:["SELA","SELB"],fire_name:["svg_p:text3463"],draw_data:[["svg_p:path3249","svg_p:path3161","svg_p:path3165"],["svg_p:path3279"]],draw_name:[[],["svg_p:path3423"]]};poc_signals.MB={name:"MB",visible:true,type:"L",value:0,default_value:0,nbits:"1",behavior:["MV MB_ALU RB_T10; FIRE COP","MV MB_ALU REG_PC; FIRE COP"],depends_on:["SELA","SELB"],fire_name:["svg_p:text3465"],draw_data:[["svg_p:path3281","svg_p:path3171","svg_p:path3169"],["svg_p:path3283"]],draw_name:[[],["svg_p:path3425","svg_p:path3427"]]};poc_signals.COP={name:"COP",visible:true,type:"L",value:0,default_value:0,nbits:"5",forbidden:true,behavior:["NOP_ALU; UPDATE_NZVC","AND ALU_T6 MA_ALU MB_ALU; UPDATE_NZVC; FIRE_IFSET T6 1; FIRE_IFSET M7 1","OR ALU_T6 MA_ALU MB_ALU; UPDATE_NZVC; FIRE_IFSET T6 1; FIRE_IFSET M7 1","NOT ALU_T6 MA_ALU; UPDATE_NZVC; FIRE_IFSET T6 1; FIRE_IFSET M7 1","XOR ALU_T6 MA_ALU MB_ALU; UPDATE_NZVC; FIRE_IFSET T6 1; FIRE_IFSET M7 1","SRL ALU_T6 MA_ALU; UPDATE_NZVC; FIRE_IFSET T6 1; FIRE_IFSET M7 1","SRA ALU_T6 MA_ALU; UPDATE_NZVC; FIRE_IFSET T6 1; FIRE_IFSET M7 1","SL ALU_T6 MA_ALU; UPDATE_NZVC; FIRE_IFSET T6 1; FIRE_IFSET M7 1","RR ALU_T6 MA_ALU; UPDATE_NZVC; FIRE_IFSET T6 1; FIRE_IFSET M7 1","RL ALU_T6 MA_ALU; UPDATE_NZVC; FIRE_IFSET T6 1; FIRE_IFSET M7 1","ADD ALU_T6 MA_ALU MB_ALU; UPDATE_NZVC; FIRE_IFSET T6 1; FIRE_IFSET M7 1","SUB ALU_T6 MA_ALU MB_ALU; UPDATE_NZVC; FIRE_IFSET T6 1; FIRE_IFSET M7 1","MUL ALU_T6 MA_ALU MB_ALU; UPDATE_NZVC; FIRE_IFSET T6 1; FIRE_IFSET M7 1","DIV ALU_T6 MA_ALU MB_ALU; UPDATE_NZVC; FIRE_IFSET T6 1; FIRE_IFSET M7 1","MOD ALU_T6 MA_ALU MB_ALU; UPDATE_NZVC; FIRE_IFSET T6 1; FIRE_IFSET M7 1","LUI ALU_T6 MA_ALU; UPDATE_NZVC; FIRE_IFSET T6 1; FIRE_IFSET M7 1","ADDFOUR ALU_T6 MB_ALU; UPDATE_NZVC; FIRE_IFSET T6 1; FIRE_IFSET M7 1","ADDONE ALU_T6 MB_ALU; UPDATE_NZVC; FIRE_IFSET T6 1; FIRE_IFSET M7 1","SUBFOUR ALU_T6 MB_ALU; UPDATE_NZVC; FIRE_IFSET T6 1; FIRE_IFSET M7 1","SUBONE ALU_T6 MB_ALU; UPDATE_NZVC; FIRE_IFSET T6 1; FIRE_IFSET M7 1","FADD ALU_T6 MA_ALU MB_ALU; UPDATE_NZVC; FIRE_IFSET T6 1; FIRE_IFSET M7 1","FSUB ALU_T6 MA_ALU MB_ALU; UPDATE_NZVC; FIRE_IFSET T6 1; FIRE_IFSET M7 1","FMUL ALU_T6 MA_ALU MB_ALU; UPDATE_NZVC; FIRE_IFSET T6 1; FIRE_IFSET M7 1","FDIV ALU_T6 MA_ALU MB_ALU; UPDATE_NZVC; FIRE_IFSET T6 1; FIRE_IFSET M7 1","FMOD ALU_T6 MA_ALU MB_ALU; UPDATE_NZVC; FIRE_IFSET T6 1; FIRE_IFSET M7 1","NOP_ALU","NOP_ALU","NOP_ALU","NOP_ALU","NOP_ALU","NOP_ALU","NOP_ALU"],depends_on:["SELCOP"],fire_name:["svg_p:text3303"],draw_data:[["svg_p:path3237","svg_p:path3239","svg_p:path3261-8","svg_p:path3321","svg_p:path3901-6","svg_p:path3317-9"]],draw_name:[["svg_p:path3009","svg_p:path3301"]]};poc_signals.SELA={name:"SELA",visible:true,type:"L",value:0,default_value:0,nbits:"6",behavior:["FIRE_IFCHANGED MRA SELA; RESET_CHANGED SELA"],depends_on:["RA"],fire_name:["svg_cu:text3164"],draw_data:[[]],draw_name:[[]]};poc_signals.SELB={name:"SELB",visible:true,type:"L",value:0,default_value:0,nbits:"6",behavior:["FIRE_IFCHANGED MRB SELB; RESET_CHANGED SELB"],depends_on:["RB"],fire_name:["svg_cu:text3168"],draw_data:[[]],draw_name:[[]]};poc_signals.SELC={name:"SELC",visible:true,type:"L",value:0,default_value:0,nbits:"6",behavior:["FIRE_IFCHANGED MRC SELC; RESET_CHANGED SELC"],depends_on:["RC"],fire_name:["svg_cu:text3172"],draw_data:[[]],draw_name:[[]]};poc_signals.SELCOP={name:"SELCOP",visible:true,type:"L",value:0,default_value:0,nbits:"5",behavior:["FIRE_IFCHANGED MC SELCOP; RESET_CHANGED SELCOP"],depends_on:["COP"],fire_name:["svg_cu:text3312"],draw_data:[[]],draw_name:[[]]};poc_signals.EXCODE={name:"EXCODE",visible:true,type:"L",value:0,default_value:0,nbits:"4",behavior:["FIRE T11"],fire_name:["svg_cu:text3312-6"],draw_data:[[]],draw_name:[[]]};poc_signals.RA={name:"RA",visible:true,type:"L",value:0,default_value:0,nbits:"6",forbidden:true,behavior:["GET RA_T9 BR RA; FIRE_IFSET T9 1; FIRE_IFSET MA 0"],depends_on:["SELA"],fire_name:["svg_p:text3107"],draw_data:[[]],draw_name:[["svg_p:path3109"]]};poc_signals.RB={name:"RB",visible:true,type:"L",value:0,default_value:0,nbits:"6",forbidden:true,behavior:["GET RB_T10 BR RB; FIRE_IFSET T10 1; FIRE_IFSET MB 0"],depends_on:["SELB"],fire_name:["svg_p:text3123"],draw_data:[[]],draw_name:[["svg_p:path3113"]]};poc_signals.RC={name:"RC",visible:true,type:"L",value:0,default_value:0,nbits:"6",forbidden:true,behavior:["FIRE LC"],depends_on:["SELC"],fire_name:["svg_p:text3125"],draw_data:[[]],draw_name:[["svg_p:path3117"]]};poc_signals.LC={name:"LC",visible:true,type:"E",value:0,default_value:0,nbits:"1",behavior:["NOP","SET BR RC BUS_IB"],fire_name:["svg_p:text3127"],draw_data:[["svg_p:path3153","svg_p:path3151","svg_p:path3129"]],draw_name:[["svg_p:path3121"]]};poc_signals.SE={name:"SE",visible:true,type:"L",value:0,default_value:0,nbits:"1",behavior:["MBITS SELEC_T3 0 REG_RT1 OFFSET SIZE 0 SE; FIRE T3","MBITS SELEC_T3 0 REG_RT1 OFFSET SIZE 0 SE; FIRE T3"],depends_on:["T3"],fire_name:["svg_p:text3593"],draw_data:[[]],draw_name:[["svg_p:path3591","svg_p:path3447-7-7"]]};poc_signals.SIZE={name:"SIZE",visible:true,type:"L",value:0,default_value:0,nbits:"5",behavior:["MBITS SELEC_T3 0 REG_RT1 OFFSET SIZE 0 SE; FIRE T3"],depends_on:["T3"],fire_name:["svg_p:text3363"],draw_data:[[]],draw_name:[["svg_p:path3355"]]};poc_signals.OFFSET={name:"OFFSET",visible:true,type:"L",value:0,default_value:0,nbits:"5",behavior:["MBITS SELEC_T3 0 REG_RT1 OFFSET SIZE 0 SE; FIRE T3"],depends_on:["T3"],fire_name:["svg_p:text3707"],draw_data:[[]],draw_name:[["svg_p:path3359"]]};poc_signals.MC={name:"MC",visible:true,type:"L",value:0,default_value:0,nbits:"1",behavior:["MBIT COP REG_IR 0 5; FIRE_IFCHANGED COP MC","CP_FIELD COP REG_MICROINS/SELCOP; FIRE_IFCHANGED COP MC"],depends_on:["SELCOP"],fire_name:["svg_cu:text3322","svg_cu:text3172-1-5"],draw_data:[["svg_cu:path3320","svg_cu:path3142"],["svg_cu:path3318","svg_cu:path3502-6","svg_cu:path3232-6"]],draw_name:[[],["svg_cu:path3306"]]};poc_signals.MRA={name:"MRA",visible:true,type:"L",value:0,default_value:0,nbits:"1",behavior:["MBIT_SN RA REG_IR REG_MICROINS/SELA 5; FIRE RA;","CP_FIELD RA REG_MICROINS/SELA; FIRE RA;"],depends_on:["SELA"],fire_name:["svg_cu:text3222"],draw_data:[["svg_cu:path3494","svg_cu:path3492","svg_cu:path3490","svg_cu:path3142b","svg_cu:path3188","svg_cu:path3190","svg_cu:path3192","svg_cu:path3194","svg_cu:path3276","svg_cu:path3290","svg_cu:path3260"],["svg_cu:path3270","svg_cu:path3258","svg_cu:path3260","svg_cu:path3294","svg_cu:path3288","svg_cu:path3280"]],draw_name:[[],["svg_cu:path3220"]]};poc_signals.MRB={name:"MRB",visible:true,type:"L",value:0,default_value:0,nbits:"1",behavior:["MBIT_SN RB REG_IR REG_MICROINS/SELB 5; FIRE RB;","CP_FIELD RB REG_MICROINS/SELB; FIRE RB;"],depends_on:["SELB"],fire_name:["svg_cu:text3242"],draw_data:[["svg_cu:path3196","svg_cu:path3278","svg_cu:path3292"],["svg_cu:path3282","svg_cu:path3258-4","svg_cu:path3278","svg_cu:path3196"]],draw_name:[[],["svg_cu:path3240"]]};poc_signals.MRC={name:"MRC",visible:true,type:"L",value:0,default_value:0,nbits:"1",behavior:["MBIT_SN RC REG_IR REG_MICROINS/SELC 5; FIRE RC;","CP_FIELD RC REG_MICROINS/SELC; FIRE RC;"],depends_on:["SELC"],fire_name:["svg_cu:text3254"],draw_data:[["svg_cu:path3494","svg_cu:path3492","svg_cu:path3490","svg_cu:path3142b","svg_cu:path3188","svg_cu:path3190","svg_cu:path3192","svg_cu:path3194","svg_cu:path3276","svg_cu:path3290","svg_cu:path3232","svg_cu:path3292"],["svg_cu:path3300","svg_cu:path3294","svg_cu:path3292","svg_cu:path3288","svg_cu:path3232"]],draw_name:[[],["svg_cu:path3252"]]};poc_signals.IOR={name:"IOR",visible:true,type:"L",value:0,default_value:0,nbits:"1",behavior:["NOP","MOVE_BITS SCR_IOR 0 1 IOR; FIRE SCR_IOR; MOVE_BITS IO_IOR 0 1 IOR; FIRE IO_IOR; MOVE_BITS KBD_IOR 0 1 IOR; FIRE KBD_IOR"],fire_name:[],draw_data:[[],["svg_p:path3733","svg_p:path3491","svg_p:text3715"]],draw_name:[[],[]]};poc_signals.IOW={name:"IOW",visible:true,type:"L",value:0,default_value:0,nbits:"1",behavior:["NOP","MOVE_BITS SCR_IOW 0 1 IOW; FIRE SCR_IOW; MOVE_BITS IO_IOW 0 1 IOW; FIRE IO_IOW"],fire_name:[],draw_data:[[],["svg_p:path3735","svg_p:path3491","svg_p:text3717"]],draw_name:[[],[]]};poc_signals.TEST_C={name:"TEST_C",visible:true,type:"L",value:0,default_value:0,nbits:"1",forbidden:true,behavior:["MV FLAG_C VAL_ZERO; FIRE M7","MV FLAG_C VAL_ONE; FIRE M7"],depends_on:["SELCOP"],fire_name:["svg_p:text3701-3"],draw_data:[["svg_p:text3701-3"]],draw_name:[[]]};poc_signals.TEST_V={name:"TEST_V",visible:true,type:"L",value:0,default_value:0,nbits:"1",forbidden:true,behavior:["MV FLAG_V VAL_ZERO; FIRE M7","MV FLAG_V VAL_ONE; FIRE M7"],depends_on:["SELCOP"],fire_name:["svg_p:text3701-3-1"],draw_data:[["svg_p:text3701-3-1"]],draw_name:[[]]};poc_signals.TEST_N={name:"TEST_N",visible:true,type:"L",value:0,default_value:0,nbits:"1",forbidden:true,behavior:["MV FLAG_N VAL_ZERO; FIRE M7","MV FLAG_N VAL_ONE; FIRE M7"],depends_on:["SELCOP"],fire_name:["svg_p:text3701-3-2"],draw_data:[["svg_p:text3701-3-2"]],draw_name:[[]]};poc_signals.TEST_Z={name:"TEST_Z",visible:true,type:"L",value:0,default_value:0,nbits:"1",forbidden:true,behavior:["MV FLAG_Z VAL_ZERO; FIRE M7","MV FLAG_Z VAL_ONE; FIRE M7"],depends_on:["SELCOP"],fire_name:["svg_p:text3701-3-5"],draw_data:[["svg_p:text3701-3-5"]],draw_name:[[]]};poc_signals.TEST_I={name:"TEST_I",visible:true,type:"L",value:0,default_value:0,nbits:"1",behavior:["MV FLAG_I VAL_ZERO; FIRE M7","MV FLAG_I VAL_ONE; FIRE M7"],depends_on:["CLK"],fire_name:["svg_cu:text3440"],draw_data:[["svg_cu:text3440"]],draw_name:[[]]};poc_signals.TEST_U={name:"TEST_U",visible:true,type:"L",value:0,default_value:0,nbits:"1",behavior:["MV FLAG_U VAL_ZERO; FIRE M7","MV FLAG_U VAL_ONE; FIRE M7"],depends_on:["CLK"],fire_name:["svg_cu:text3442"],draw_data:[["svg_cu:text3442"]],draw_name:[[]]};poc_signals.TEST_INTV={name:"TEST_INTV",visible:true,type:"L",value:0,default_value:0,nbits:"8",forbidden:true,behavior:["MBIT INTV TEST_INTV 0 32"],depends_on:["INT"],fire_name:["svg_p:tspan4225"],draw_data:[["svg_p:path3749"]],draw_name:[[]]};poc_behaviors.NOP={nparameters:1,operation:function(a){},verbal:function(a){return""}};poc_behaviors.NOP_ALU={nparameters:1,operation:function(a){poc_internal_states.alu_flags.flag_n=0;poc_internal_states.alu_flags.flag_z=0;poc_internal_states.alu_flags.flag_v=0;poc_internal_states.alu_flags.flag_c=0},verbal:function(a){return"Reset ALU flags. "}};poc_behaviors.MV={nparameters:3,types:["X","X"],operation:function(a){sim_elto_org=get_reference(a[2]);sim_elto_dst=get_reference(a[1]);newval=get_value(sim_elto_org);set_value(sim_elto_dst,newval)},verbal:function(c){var d=get_reference(c[2]);var e=get_value(d);var a=get_cfg("verbal_verbose");if(a!=="short"){return"Copy from "+show_verbal(c[2])+" to "+show_verbal(c[1])+" value "+show_value(e)+". "}return show_verbal(c[1])+" = "+show_verbal(c[2])+" ("+show_value(e)+"). "}};poc_behaviors.LOAD={nparameters:3,types:["X","X"],operation:function(a){sim_elto_org=get_reference(a[2]);sim_elto_dst=get_reference(a[1]);newval=get_value(sim_elto_org);set_value(sim_elto_dst,newval)},verbal:function(c){var d=get_reference(c[2]);var e=get_value(d);var a=get_cfg("verbal_verbose");if(a!=="math"){return"Load from "+show_verbal(c[2])+" to "+show_verbal(c[1])+" value "+show_value(e)+". "}return show_verbal(c[1])+" = "+show_value(e)+" ( "+show_verbal(c[2])+"). "}};poc_behaviors.CP_FIELD={nparameters:3,types:["X","X"],operation:function(a){r=a[2].split("/");sim_elto_org=get_reference(r[0]);newval=get_value(sim_elto_org);newval=newval[r[1]];if(typeof newval!="undefined"){sim_elto_dst=get_reference(a[1]);set_value(sim_elto_dst,newval)}},verbal:function(c){var e=c[2].split("/");var d=get_reference(e[0]);var f=get_value(d);f=f[e[1]];if(typeof f=="undefined"){f="&lt;undefined&gt;"}else{f=show_value(f)}var a=get_cfg("verbal_verbose");if(a!=="math"){return'Copy from "'+show_verbal(e[0])+'"['+e[1]+"] to "+show_verbal(c[1])+" (value "+f+"). "}return show_verbal(c[1])+" = "+show_verbal(e[0])+"."+e[1]+" ("+f+"). "}};poc_behaviors.NOT_ES={nparameters:3,types:["S","E"],operation:function(a){set_value(poc_signals[a[1]],Math.abs(get_value(poc_states[a[2]])-1))},verbal:function(c){var d=Math.abs(get_value(poc_states[c[2]])-1);var a=get_cfg("verbal_verbose");if(a!=="math"){return"Set "+show_verbal(c[1])+" with value "+show_value(d)+" (Logical NOT of "+c[2]+"). "}return show_verbal(c[1])+" = "+show_value(d)+" (Logical NOT "+c[2]+"). "}};poc_behaviors.GET={nparameters:4,types:["E","E","S"],operation:function(a){set_value(poc_states[a[1]],get_value(poc_states[a[2]][poc_signals[a[3]].value]))},verbal:function(c){var d=get_value(poc_states[c[2]][poc_signals[c[3]].value]);var a=get_cfg("verbal_verbose");if(a!=="math"){return"Set "+show_verbal(c[1])+" with value "+show_value(d)+" (Register File "+c[3]+"). "}return show_verbal(c[1])+" = "+show_value(d)+" (Register File "+c[3]+"). "}};poc_behaviors.SET={nparameters:4,types:["E","S","E"],operation:function(a){set_value(poc_states[a[1]][poc_signals[a[2]].value],get_value(poc_states[a[3]]))},verbal:function(e){var f=get_value(poc_states[e[3]]);var d=poc_states[e[1]][poc_signals[e[2]].value];var c=d.name;if(typeof d.verbal!="undefined"){c=d.verbal}var a=get_cfg("verbal_verbose");if(a!=="math"){return"Copy to "+c+" the value "+show_value(f)+". "}return c+" = "+show_value(f)+". "}};poc_behaviors.AND={nparameters:4,types:["E","E","E"],operation:function(c){var a=get_value(poc_states[c[2]])&get_value(poc_states[c[3]]);set_value(poc_states[c[1]],a);poc_internal_states.alu_flags.flag_n=(a<0)?1:0;poc_internal_states.alu_flags.flag_z=(a==0)?1:0;poc_internal_states.alu_flags.flag_v=0;poc_internal_states.alu_flags.flag_c=0},verbal:function(d){var a=get_value(poc_states[d[2]])&get_value(poc_states[d[3]]);var c=get_cfg("verbal_verbose");if(c!=="math"){return"ALU AND with result "+show_value(a)+". "}return"ALU output = "+show_value(a)+" (AND). "}};poc_behaviors.OR={nparameters:4,types:["E","E","E"],operation:function(c){var a=get_value(poc_states[c[2]])|get_value(poc_states[c[3]]);set_value(poc_states[c[1]],a);poc_internal_states.alu_flags.flag_n=(a<0)?1:0;poc_internal_states.alu_flags.flag_z=(a==0)?1:0;poc_internal_states.alu_flags.flag_v=0;poc_internal_states.alu_flags.flag_c=0},verbal:function(d){var a=get_value(poc_states[d[2]])|get_value(poc_states[d[3]]);var c=get_cfg("verbal_verbose");if(c!=="math"){return"ALU OR with result "+show_value(a)+". "}return"ALU output = "+show_value(a)+" (OR). "}};poc_behaviors.NOT={nparameters:3,types:["E","E"],operation:function(c){var a=~(get_value(poc_states[c[2]]));set_value(poc_states[c[1]],a);poc_internal_states.alu_flags.flag_n=(a<0)?1:0;poc_internal_states.alu_flags.flag_z=(a==0)?1:0;poc_internal_states.alu_flags.flag_v=0;poc_internal_states.alu_flags.flag_c=0},verbal:function(d){var a=~(get_value(poc_states[d[2]]));var c=get_cfg("verbal_verbose");if(c!=="math"){return"ALU NOT with result "+show_value(a)+". "}return"ALU output = "+show_value(a)+" (NOT). "}};poc_behaviors.XOR={nparameters:4,types:["E","E","E"],operation:function(c){var a=get_value(poc_states[c[2]])^get_value(poc_states[c[3]]);set_value(poc_states[c[1]],a);poc_internal_states.alu_flags.flag_n=(a<0)?1:0;poc_internal_states.alu_flags.flag_z=(a==0)?1:0;poc_internal_states.alu_flags.flag_v=0;poc_internal_states.alu_flags.flag_c=0},verbal:function(d){var a=get_value(poc_states[d[2]])^get_value(poc_states[d[3]]);var c=get_cfg("verbal_verbose");if(c!=="math"){return"ALU XOR with result "+show_value(a)+". "}return"ALU output = "+show_value(a)+" (XOR). "}};poc_behaviors.SRL={nparameters:3,types:["E","E"],operation:function(c){var a=(get_value(poc_states[c[2]]))>>>1;set_value(poc_states[c[1]],a);poc_internal_states.alu_flags.flag_n=(a<0)?1:0;poc_internal_states.alu_flags.flag_z=(a==0)?1:0;poc_internal_states.alu_flags.flag_v=0;poc_internal_states.alu_flags.flag_c=0},verbal:function(d){var a=(get_value(poc_states[d[2]]))>>>1;var c=get_cfg("verbal_verbose");if(c!=="math"){return"ALU Shift Right Logical with result "+show_value(a)+". "}return"ALU output = "+show_value(a)+" (SRL). "}};poc_behaviors.SRA={nparameters:3,types:["E","E"],operation:function(c){var a=(get_value(poc_states[c[2]]))>>1;set_value(poc_states[c[1]],a);poc_internal_states.alu_flags.flag_n=(a<0)?1:0;poc_internal_states.alu_flags.flag_z=(a==0)?1:0;poc_internal_states.alu_flags.flag_v=0;poc_internal_states.alu_flags.flag_c=0},verbal:function(d){var a=(get_value(poc_states[d[2]]))>>1;var c=get_cfg("verbal_verbose");if(c!=="math"){return"ALU Shift Right Arithmetic with result "+show_value(a)+". "}return"ALU output = "+show_value(a)+" (SRA). "}};poc_behaviors.SL={nparameters:3,types:["E","E"],operation:function(c){var a=(get_value(poc_states[c[2]]))<<1;set_value(poc_states[c[1]],a);poc_internal_states.alu_flags.flag_n=(a<0)?1:0;poc_internal_states.alu_flags.flag_z=(a==0)?1:0;poc_internal_states.alu_flags.flag_v=0;poc_internal_states.alu_flags.flag_c=0},verbal:function(d){var a=(get_value(poc_states[d[2]]))<<1;var c=get_cfg("verbal_verbose");if(c!=="math"){return"ALU Shift Left with result "+show_value(a)+". "}return"ALU output = "+show_value(a)+" (SL). "}};poc_behaviors.RR={nparameters:3,types:["E","E"],operation:function(c){var a=((get_value(poc_states[c[2]]))>>>1)|(((get_value(poc_states[c[2]]))&1)<<31);set_value(poc_states[c[1]],a);poc_internal_states.alu_flags.flag_n=(a<0)?1:0;poc_internal_states.alu_flags.flag_z=(a==0)?1:0;poc_internal_states.alu_flags.flag_v=0;poc_internal_states.alu_flags.flag_c=0},verbal:function(d){var a=((get_value(poc_states[d[2]]))>>>1)|(((get_value(poc_states[d[2]]))&1)<<31);var c=get_cfg("verbal_verbose");if(c!=="math"){return"ALU Right Rotation with result "+show_value(a)+". "}return"ALU output = "+show_value(a)+" (RR). "}};poc_behaviors.RL={nparameters:3,types:["E","E"],operation:function(c){var a=((get_value(poc_states[c[2]]))<<1)|(((get_value(poc_states[c[2]]))&2147483648)>>>31);set_value(poc_states[c[1]],a);poc_internal_states.alu_flags.flag_n=(a<0)?1:0;poc_internal_states.alu_flags.flag_z=(a==0)?1:0;poc_internal_states.alu_flags.flag_v=0;poc_internal_states.alu_flags.flag_c=0},verbal:function(d){var a=((get_value(poc_states[d[2]]))<<1)|(((get_value(poc_states[d[2]]))&2147483648)>>>31);var c=get_cfg("verbal_verbose");if(c!=="math"){return"ALU Left Rotation with result "+show_value(a)+". "}return"ALU output = "+show_value(a)+" (LR). "}};poc_behaviors.ADD={nparameters:4,types:["E","E","E"],operation:function(f){var e=get_value(poc_states[f[2]])<<0;var d=get_value(poc_states[f[3]])<<0;var c=e+d;set_value(poc_states[f[1]],c>>>0);poc_internal_states.alu_flags.flag_n=(c<0)?1:0;poc_internal_states.alu_flags.flag_z=(c==0)?1:0;poc_internal_states.alu_flags.flag_c=(e>>>31)&&(d>>>31);poc_internal_states.alu_flags.flag_v=0;if((c<0)&&(e>=0)&&(d>=0)){poc_internal_states.alu_flags.flag_v=1}if((c>=0)&&(e<0)&&(d<0)){poc_internal_states.alu_flags.flag_v=1}},verbal:function(g){var f=get_value(poc_states[g[2]])<<0;var d=get_value(poc_states[g[3]])<<0;var c=f+d;var e=get_cfg("verbal_verbose");if(e!=="math"){return"ALU ADD with result "+show_value(c)+". "}return"ALU output = "+show_value(c)+" (ADD). "}};poc_behaviors.SUB={nparameters:4,types:["E","E","E"],operation:function(f){var e=get_value(poc_states[f[2]])<<0;var d=get_value(poc_states[f[3]])<<0;var c=e-d;set_value(poc_states[f[1]],c>>>0);poc_internal_states.alu_flags.flag_n=(c<0)?1:0;poc_internal_states.alu_flags.flag_z=(c==0)?1:0;poc_internal_states.alu_flags.flag_c=(e>>>31)&&(d>>>31);poc_internal_states.alu_flags.flag_v=0;if((c<0)&&(e>=0)&&(d>=0)){poc_internal_states.alu_flags.flag_v=1}if((c>=0)&&(e<0)&&(d<0)){poc_internal_states.alu_flags.flag_v=1}},verbal:function(g){var f=get_value(poc_states[g[2]])<<0;var d=get_value(poc_states[g[3]])<<0;var c=f-d;var e=get_cfg("verbal_verbose");if(e!=="math"){return"ALU SUB with result "+show_value(c)+". "}return"ALU output = "+show_value(c)+" (SUB). "}};poc_behaviors.MUL={nparameters:4,types:["E","E","E"],operation:function(f){var e=get_value(poc_states[f[2]])<<0;var d=get_value(poc_states[f[3]])<<0;var c=e*d;set_value(poc_states[f[1]],c>>>0);poc_internal_states.alu_flags.flag_n=(c<0)?1:0;poc_internal_states.alu_flags.flag_z=(c==0)?1:0;poc_internal_states.alu_flags.flag_c=0;poc_internal_states.alu_flags.flag_v=0;if((c<0)&&(e>=0)&&(d>=0)){poc_internal_states.alu_flags.flag_v=1}if((c>=0)&&(e<0)&&(d<0)){poc_internal_states.alu_flags.flag_v=1}},verbal:function(g){var f=get_value(poc_states[g[2]])<<0;var d=get_value(poc_states[g[3]])<<0;var c=f*d;var e=get_cfg("verbal_verbose");if(e!=="math"){return"ALU MUL with result "+show_value(c)+". "}return"ALU output = "+show_value(c)+" (MUL). "}};poc_behaviors.DIV={nparameters:4,types:["E","E","E"],operation:function(f){var e=(get_value(poc_states[f[2]])<<0);var d=(get_value(poc_states[f[3]])<<0);if(0==d){set_value(poc_states[f[1]],0);poc_internal_states.alu_flags.flag_n=0;poc_internal_states.alu_flags.flag_z=1;poc_internal_states.alu_flags.flag_v=1;poc_internal_states.alu_flags.flag_c=0;return}var c=Math.floor(e/d);set_value(poc_states[f[1]],c);poc_internal_states.alu_flags.flag_n=(c<0)?1:0;poc_internal_states.alu_flags.flag_z=(c==0)?1:0;poc_internal_states.alu_flags.flag_v=0;poc_internal_states.alu_flags.flag_c=0},verbal:function(g){var f=get_value(poc_states[g[2]])<<0;var d=get_value(poc_states[g[3]])<<0;if(0==d){return"ALU DIV zero by zero (oops!). "}var c=Math.floor(f/d);var e=get_cfg("verbal_verbose");if(e!=="math"){return"ALU DIV with result "+show_value(c)+". "}return"ALU output = "+show_value(c)+" (DIV). "}};poc_behaviors.MOD={nparameters:4,types:["E","E","E"],operation:function(c){var a=(get_value(poc_states[c[2]])<<0)%(get_value(poc_states[c[3]])<<0);set_value(poc_states[c[1]],a);poc_internal_states.alu_flags.flag_n=(a<0)?1:0;poc_internal_states.alu_flags.flag_z=(a==0)?1:0;poc_internal_states.alu_flags.flag_v=0;poc_internal_states.alu_flags.flag_c=0},verbal:function(g){var f=get_value(poc_states[g[2]])<<0;var d=get_value(poc_states[g[3]])<<0;if(0==d){return"ALU MOD zero by zero (oops!). "}var c=f%d;var e=get_cfg("verbal_verbose");if(e!=="math"){return"ALU MOD with result "+show_value(c)+". "}return"ALU output = "+show_value(c)+" (MOD). "}};poc_behaviors.LUI={nparameters:3,types:["E","E"],operation:function(c){var a=(get_value(poc_states[c[2]]))<<16;set_value(poc_states[c[1]],a);poc_internal_states.alu_flags.flag_n=(a<0)?1:0;poc_internal_states.alu_flags.flag_z=(a==0)?1:0;poc_internal_states.alu_flags.flag_v=0;poc_internal_states.alu_flags.flag_c=0},verbal:function(d){var a=(get_value(poc_states[d[2]]))<<16;var c=get_cfg("verbal_verbose");if(c!=="math"){return"ALU Load Upper Immediate with result "+show_value(a)+". "}return"ALU output = "+show_value(a)+" (LUI). "}};poc_behaviors.ADDFOUR={nparameters:3,types:["E","E"],operation:function(e){var d=get_value(poc_states[e[2]])<<0;var c=d+4;set_value(poc_states[e[1]],c>>>0);poc_internal_states.alu_flags.flag_n=(c<0)?1:0;poc_internal_states.alu_flags.flag_z=(c==0)?1:0;poc_internal_states.alu_flags.flag_c=(d>>>31)&&(b>>>31);poc_internal_states.alu_flags.flag_v=0;if((c<0)&&(d>=0)&&(b>=0)){poc_internal_states.alu_flags.flag_v=1}if((c>=0)&&(d<0)&&(b<0)){poc_internal_states.alu_flags.flag_v=1}},verbal:function(e){var d=get_value(poc_states[e[2]])<<0;var c=d+4;return"ALU ADD 4 with result "+show_value(c)+". "}};poc_behaviors.ADDONE={nparameters:3,types:["E","E"],operation:function(e){var d=get_value(poc_states[e[2]])<<0;var c=d+1;set_value(poc_states[e[1]],c>>>0);poc_internal_states.alu_flags.flag_n=(c<0)?1:0;poc_internal_states.alu_flags.flag_z=(c==0)?1:0;poc_internal_states.alu_flags.flag_c=(d>>>31)&&(b>>>31);poc_internal_states.alu_flags.flag_v=0;if((c<0)&&(d>=0)&&(b>=0)){poc_internal_states.alu_flags.flag_v=1}if((c>=0)&&(d<0)&&(b<0)){poc_internal_states.alu_flags.flag_v=1}},verbal:function(e){var d=get_value(poc_states[e[2]])<<0;var c=d+1;return"ALU ADD 1 with result "+show_value(c)+". "}};poc_behaviors.SUBFOUR={nparameters:3,types:["E","E"],operation:function(e){var d=get_value(poc_states[e[2]])<<0;var c=d-4;set_value(poc_states[e[1]],c>>>0);poc_internal_states.alu_flags.flag_n=(c<0)?1:0;poc_internal_states.alu_flags.flag_z=(c==0)?1:0;poc_internal_states.alu_flags.flag_c=(d>>>31)&&(b>>>31);poc_internal_states.alu_flags.flag_v=0;if((c<0)&&(d>=0)&&(b>=0)){poc_internal_states.alu_flags.flag_v=1}if((c>=0)&&(d<0)&&(b<0)){poc_internal_states.alu_flags.flag_v=1}},verbal:function(e){var d=get_value(poc_states[e[2]])<<0;var c=d-4;return"ALU SUB 4 with result "+show_value(c)+". "}};poc_behaviors.SUBONE={nparameters:3,types:["E","E"],operation:function(e){var d=get_value(poc_states[e[2]])<<0;var c=d-1;set_value(poc_states[e[1]],c>>>0);poc_internal_states.alu_flags.flag_n=(c<0)?1:0;poc_internal_states.alu_flags.flag_z=(c==0)?1:0;poc_internal_states.alu_flags.flag_c=(d>>>31)&&(b>>>31);poc_internal_states.alu_flags.flag_v=0;if((c<0)&&(d>=0)&&(b>=0)){poc_internal_states.alu_flags.flag_v=1}if((c>=0)&&(d<0)&&(b<0)){poc_internal_states.alu_flags.flag_v=1}},verbal:function(e){var d=get_value(poc_states[e[2]])<<0;var c=d-1;return"ALU SUB 1 with result "+show_value(c)+". "}};poc_behaviors.FADD={nparameters:4,types:["E","E","E"],operation:function(f){var e=get_value(poc_states[f[2]])<<0;var d=get_value(poc_states[f[3]])<<0;var c=e.toFixed(2)+d.toFixed(2);set_value(poc_states[f[1]],c>>>0);poc_internal_states.alu_flags.flag_n=(c<0)?1:0;poc_internal_states.alu_flags.flag_z=(c==0)?1:0;poc_internal_states.alu_flags.flag_c=0;poc_internal_states.alu_flags.flag_v=0;if((c<0)&&(e>=0)&&(d>=0)){poc_internal_states.alu_flags.flag_v=1}if((c>=0)&&(e<0)&&(d<0)){poc_internal_states.alu_flags.flag_v=1}},verbal:function(f){var e=get_value(poc_states[f[2]])<<0;var d=get_value(poc_states[f[3]])<<0;var c=e.toFixed(2)+d.toFixed(2);return"ALU Float ADD with result "+c+". "}};poc_behaviors.FSUB={nparameters:4,types:["E","E","E"],operation:function(f){var e=get_value(poc_states[f[2]])<<0;var d=get_value(poc_states[f[3]])<<0;var c=e.toFixed(2)-d.toFixed(2);set_value(poc_states[f[1]],c>>>0);poc_internal_states.alu_flags.flag_n=(c<0)?1:0;poc_internal_states.alu_flags.flag_z=(c==0)?1:0;poc_internal_states.alu_flags.flag_c=0;poc_internal_states.alu_flags.flag_v=0;if((c<0)&&(e>=0)&&(d>=0)){poc_internal_states.alu_flags.flag_v=1}if((c>=0)&&(e<0)&&(d<0)){poc_internal_states.alu_flags.flag_v=1}},verbal:function(f){var e=get_value(poc_states[f[2]])<<0;var d=get_value(poc_states[f[3]])<<0;var c=e.toFixed(2)-d.toFixed(2);return"ALU Float SUB with result "+c+". "}};poc_behaviors.FMUL={nparameters:4,types:["E","E","E"],operation:function(f){var e=get_value(poc_states[f[2]])<<0;var d=get_value(poc_states[f[3]])<<0;var c=e.toFixed(2)*d.toFixed(2);set_value(poc_states[f[1]],c>>>0);poc_internal_states.alu_flags.flag_n=(c<0)?1:0;poc_internal_states.alu_flags.flag_z=(c==0)?1:0;poc_internal_states.alu_flags.flag_c=0;poc_internal_states.alu_flags.flag_v=0;if((c<0)&&(e>=0)&&(d>=0)){poc_internal_states.alu_flags.flag_v=1}if((c>=0)&&(e<0)&&(d<0)){poc_internal_states.alu_flags.flag_v=1}},verbal:function(f){var e=get_value(poc_states[f[2]])<<0;var d=get_value(poc_states[f[3]])<<0;var c=e.toFixed(2)*d.toFixed(2);return"ALU Float MUL with result "+c+". "}};poc_behaviors.FDIV={nparameters:4,types:["E","E","E"],operation:function(f){var e=(get_value(poc_states[f[2]])<<0);var d=(get_value(poc_states[f[3]])<<0);if(0==d){set_value(poc_states[f[1]],0);poc_internal_states.alu_flags.flag_n=0;poc_internal_states.alu_flags.flag_z=1;poc_internal_states.alu_flags.flag_v=1;poc_internal_states.alu_flags.flag_c=0;return}var c=Math.floor(e/d);set_value(poc_states[f[1]],c);poc_internal_states.alu_flags.flag_n=(c<0)?1:0;poc_internal_states.alu_flags.flag_z=(c==0)?1:0;poc_internal_states.alu_flags.flag_v=0;poc_internal_states.alu_flags.flag_c=0},verbal:function(f){var e=get_value(poc_states[f[2]])<<0;var d=get_value(poc_states[f[3]])<<0;var c=e.toFixed(2)/d.toFixed(2);return"ALU Float DIV with result "+c+". "}};poc_behaviors.FMOD={nparameters:4,types:["E","E","E"],operation:function(c){var a=(get_value(poc_states[c[2]])<<0)%(get_value(poc_states[c[3]])<<0);set_value(poc_states[c[1]],a);poc_internal_states.alu_flags.flag_n=(a<0)?1:0;poc_internal_states.alu_flags.flag_z=(a==0)?1:0;poc_internal_states.alu_flags.flag_v=0;poc_internal_states.alu_flags.flag_c=0},verbal:function(f){var e=get_value(poc_states[f[2]])<<0;var d=get_value(poc_states[f[3]])<<0;var c=e.toFixed(2)%d.toFixed(2);return"ALU Float MOD with result "+c+". "}};poc_behaviors.LUI={nparameters:3,types:["E","E"],operation:function(c){var a=(get_value(poc_states[c[2]]))<<16;set_value(poc_states[c[1]],a);poc_internal_states.alu_flags.flag_n=(a<0)?1:0;poc_internal_states.alu_flags.flag_z=(a==0)?1:0;poc_internal_states.alu_flags.flag_v=0;poc_internal_states.alu_flags.flag_c=0},verbal:function(c){var a=(get_value(poc_states[c[2]]))<<16;return"ALU Load Upper Immediate with result "+show_value(a)+". "}};poc_behaviors.PLUS1={nparameters:3,types:["E","E"],operation:function(e){var d=get_value(poc_states[e[2]])<<0;var c=d+1;set_value(poc_states[e[1]],c>>>0)},verbal:function(f){var e=get_value(poc_states[f[2]])<<0;var c=e+1;var d=get_cfg("verbal_verbose");if(d!=="math"){return"Add one to "+show_verbal(f[2])+" and copy to "+show_verbal(f[1])+" with result "+show_value(c)+". "}return show_verbal(f[1])+" = "+show_verbal(f[2])+" + 1 ("+show_value(c)+"). "}};poc_behaviors.PLUS4={nparameters:3,types:["E","E"],operation:function(e){var d=get_value(poc_states[e[2]])<<0;var c=d+4;set_value(poc_states[e[1]],c>>>0)},verbal:function(f){var e=get_value(poc_states[f[2]])<<0;var c=e+4;var d=get_cfg("verbal_verbose");if(d!=="math"){return"Add four to "+show_verbal(f[2])+" and copy to "+show_verbal(f[1])+" with result "+show_value(c)+". "}return show_verbal(f[1])+" = "+show_verbal(f[2])+" + 4 ("+show_value(c)+"). "}};poc_behaviors.MBIT={nparameters:5,types:["X","X","I","I"],operation:function(a){var g=get_reference(a[1]);var f=get_reference(a[2]);var h=parseInt(a[3]);var d=parseInt(a[4]);var e=get_value(f).toString(2);var c="00000000000000000000000000000000".substring(0,32-e.length)+e;c=c.substr(31-(h+d-1),d);set_value(g,parseInt(c,2))},verbal:function(h){var e=get_reference(h[1]);var k=get_reference(h[2]);var c=parseInt(h[3]);var l=parseInt(h[4]);var g=get_value(k).toString(2);var f="00000000000000000000000000000000".substring(0,32-g.length)+g;f=f.substr(31-(c+l-1),l);var d=parseInt(f,2);var a=get_cfg("verbal_verbose");if(a!=="math"){return"Copy from "+show_verbal(h[2])+" to "+show_verbal(h[1])+" value "+show_value(d)+" (copied "+l+" bits from bit "+c+"). "}return show_verbal(h[1])+" = "+show_verbal(h[2])+" ("+show_value(d)+", "+l+" bits from bit "+c+"). "}};poc_behaviors.MBIT_SN={nparameters:5,types:["S","E","E","I"],operation:function(c){var g=0;var f=c[3].split("/");if(1==f.length){g=get_value(poc_states[c[3]])}else{if(typeof poc_states[f[0]].value[f[1]]!="undefined"){g=poc_states[f[0]].value[f[1]]}else{if(typeof poc_signals[f[1]].default_value!="undefined"){g=poc_signals[f[1]].default_value}else{if(typeof poc_states[f[1]].default_value!="undefined"){g=poc_states[f[1]].default_value}else{alert("WARN: undefined state/field pair -> "+f[0]+"/"+f[1])}}}}var h=parseInt(c[4]);var e=get_value(poc_states[c[2]]).toString(2);var d="00000000000000000000000000000000".substring(0,32-e.length)+e;var a=d.substr(31-(g+h-1),h);set_value(poc_signals[c[1]],parseInt(a,2))},verbal:function(l){var c=0;var a=l[3].split("/");if(1==a.length){c=get_value(ep_states[l[3]])}else{if(typeof ep_states[a[0]].value[a[1]]!="undefined"){c=ep_states[a[0]].value[a[1]]}else{if(typeof ep_signals[a[1]].default_value!="undefined"){c=ep_signals[a[1]].default_value}else{if(typeof ep_states[a[1]].default_value!="undefined"){c=ep_states[a[1]].default_value}else{alert("WARN: undefined state/field pair -> "+a[0]+"/"+a[1])}}}}var f=parseInt(l[4]);var k=get_value(ep_states[l[2]]).toString(2);var h="00000000000000000000000000000000".substring(0,32-k.length)+k;var g=h.substr(31-(c+f-1),f);var d="";if(1==a.length){d=show_verbal(l[3])}else{d='"'+show_verbal(l[2])+'"['+a[1]+"] "}var e=get_cfg("verbal_verbose");if(e!=="math"){return"Copy from "+d+"into "+show_verbal(l[1])+" value "+parseInt(g,2)+". "}return show_verbal(l[1])+" = "+d+" ("+parseInt(g,2)+"). "}};poc_behaviors.SBIT_SIGNAL={nparameters:4,types:["X","I","I"],operation:function(c){sim_elto_dst=get_reference(c[1]);var d=sim_elto_dst.value;var a=(1<<c[3]);if(c[2]=="1"){d=d|a}else{d=d&~a}set_value(sim_elto_dst,(d>>>0))},verbal:function(c){sim_elto_dst=get_reference(c[1]);var d=sim_elto_dst.value;var a=(1<<c[3]);if(c[2]=="1"){d=d|a}else{d=d&~a}return compute_signal_verbals(c[1],(d>>>0))}};poc_behaviors.UPDATE_FLAG={nparameters:4,types:["X","X","I"],operation:function(a){sim_elto_org=get_reference(a[2]);sim_elto_dst=get_reference(a[1]);var c=(sim_elto_dst.value&~(1<<a[3]))|(sim_elto_org.value<<a[3]);set_value(sim_elto_dst,(c>>>0))},verbal:function(c){sim_elto_org=get_reference(c[2]);sim_elto_dst=get_reference(c[1]);var a=get_cfg("verbal_verbose");if(a!=="math"){return"Update "+show_verbal(c[2])+" to value "+sim_elto_org.value+". "}return show_verbal(c[1])+"."+show_verbal(c[3])+" = "+sim_elto_org.value+". "}};poc_behaviors.MBITS={nparameters:8,types:["E","I","E","S","S","I","S"],operation:function(c){var g=parseInt(poc_signals[c[4]].value);var e=parseInt(poc_signals[c[5]].value);var f=get_value(poc_states[c[3]]).toString(2);var d=("00000000000000000000000000000000".substring(0,32-f.length)+f);d=d.substr(31-(g+e-1),e);var a="00000000000000000000000000000000".substring(0,32-d.length)+d;if(("1"==poc_signals[c[7]].value)&&("1"==d.substr(0,1))){a="11111111111111111111111111111111".substring(0,32-d.length)+d}set_value(poc_states[c[1]],parseInt(a,2))},verbal:function(d){var h=parseInt(poc_signals[d[4]].value);var f=parseInt(poc_signals[d[5]].value);var g=get_value(poc_states[d[3]]).toString(2);var e=("00000000000000000000000000000000".substring(0,32-g.length)+g);e=e.substr(31-(h+f-1),f);var c="00000000000000000000000000000000".substring(0,32-e.length)+e;if(("1"==poc_signals[d[7]].value)&&("1"==e.substr(0,1))){c="11111111111111111111111111111111".substring(0,32-e.length)+e}g=parseInt(c,2);var a=get_cfg("verbal_verbose");if(a!=="math"){return" Copy from "+show_verbal(d[3])+" to "+show_verbal(d[1])+" value "+show_value(g)+" (copied "+f+" bits from bit "+h+"). "}return show_verbal(d[1])+" = "+show_verbal(d[3])+" ("+show_value(g)+", "+f+" bits from bit "+h+"). "}};poc_behaviors.BSEL={nparameters:6,types:["E","I","I","E","I"],operation:function(e){var k=parseInt(e[2]);var h=parseInt(e[5]);var a=parseInt(e[3]);var g=get_value(poc_states[e[4]]).toString(2);var f="00000000000000000000000000000000".substring(0,32-g.length)+g;f=f.substr(31-(h+a)+1,a);var d="00000000000000000000000000000000".substring(0,32-f.length)+f;var c="00000000000000000000000000000000".substr(0,k);d=d+c;set_value(poc_states[e[1]],parseInt(d,2))},verbal:function(m){var g=parseInt(m[2]);var k=parseInt(m[3]);var a=parseInt(m[5]);var l=get_value(poc_states[m[4]]).toString(2);var h="00000000000000000000000000000000".substring(0,32-l.length)+l;h=h.substr(31-(a+k)+1,k);var f="00000000000000000000000000000000".substring(0,32-h.length)+h;var e="00000000000000000000000000000000".substr(0,g);f=f+e;var d=parseInt(f,2);var c=get_cfg("verbal_verbose");if(c!=="math"){return"Copy from "+show_verbal(m[4])+" to "+show_verbal(m[1])+" value "+show_value(d)+" (copied "+k+" bits, from bit "+a+" of "+m[4]+" to bit "+g+" of "+m[1]+"). "}return show_verbal(m[1])+" = "+show_verbal(m[4])+" ("+show_value(d)+", "+k+" bits, from bit "+a+" of "+m[4]+" to bit "+g+" of "+m[1]+"). "}};poc_behaviors.EXT_SIG={nparameters:3,types:["E","I"],operation:function(d){var f=get_value(poc_states[d[1]]).toString(2);var e=("00000000000000000000000000000000".substring(0,32-f.length)+f);var c=e.substr(31-d[2],31);var a=c;if("1"==e[31-d[2]]){a="11111111111111111111111111111111".substring(0,32-c.length)+a}set_value(poc_states[d[1]],parseInt(a,2))},verbal:function(e){var g=get_value(poc_states[e[1]]).toString(2);var f=("00000000000000000000000000000000".substring(0,32-g.length)+g);var d=f.substr(31-e[2],31);var c=d;if("1"==f[31-e[2]]){c="11111111111111111111111111111111".substring(0,32-d.length)+c}var a=parseInt(c,2);return"Sign Extension with value "+show_value(a)+". "}};poc_behaviors.MOVE_BITS={nparameters:5,types:["S","I","I","S"],operation:function(h){var d=parseInt(h[2]);var a=0;var f=parseInt(h[3]);var g=poc_signals[h[4]].value.toString(2);g=("00000000000000000000000000000000".substring(0,32-g.length)+g);g=g.substr(31-a-f+1,f);var e=poc_signals[h[1]].value.toString(2);e=("00000000000000000000000000000000".substring(0,32-e.length)+e);var l=e.substr(0,32-(d+f));var k=e.substr(31-d+1,d);var c=l+g+k;set_value(poc_signals[h[1]],parseInt(c,2))},verbal:function(a){return""}};poc_behaviors.MOVE_BITSE={nparameters:6,types:["S","I","I","E","I"],operation:function(h){var d=parseInt(h[2]);var a=parseInt(h[5]);var f=parseInt(h[3]);var g=get_value(poc_states[h[4]]).toString(2);g=("00000000000000000000000000000000".substring(0,32-g.length)+g);g=g.substr(31-a-f+1,f);var e=poc_signals[h[1]].value.toString(2);e=("00000000000000000000000000000000".substring(0,32-e.length)+e);var l=e.substr(0,32-(d+f));var k=e.substr(31-d+1,d);var c=l+g+k;set_value(poc_signals[h[1]],parseInt(c,2))},verbal:function(a){return""}};poc_behaviors.DECO={nparameters:1,operation:function(c){poc_states.INEX.value=0;var f=decode_instruction(poc_internal_states.FIRMWARE,poc_ctrl_states.ir,get_value(poc_states.REG_IR));if(null==f.oinstruction){alert("ERROR: undefined instruction code in firmware (co:"+f.op_code.toString(2)+", cop:"+f.cop_code.toString(2)+")");poc_states.ROM_MUXA.value=0;poc_states.INEX.value=1;return -1}var e=f.op_code<<6;if(typeof f.oinstruction.cop!="undefined"){e=e+f.cop_code}if(typeof poc_internal_states.ROM[e]=="undefined"){alert("ERROR: undefined rom address "+e+" in firmware");poc_states.ROM_MUXA.value=0;return -1}poc_states.ROM_MUXA.value=poc_internal_states.ROM[e];var g=get_value(poc_states.DECO_INS);set_value(poc_states.DECO_INS,g+1);var a=get_value(poc_states.REG_PC)-4;var d=get_deco_from_pc(a);set_value(poc_states.REG_IR_DECO,d);show_dbg_ir(get_value(poc_states.REG_IR_DECO))},verbal:function(a){return"Decode instruction. "}};poc_behaviors.FIRE={nparameters:2,types:["S"],operation:function(a){if(poc_internal_states.fire_stack.indexOf(a[1])!=-1){return}poc_internal_states.fire_stack.push(a[1]);update_draw(poc_signals[a[1]],poc_signals[a[1]].value);if("L"==poc_signals[a[1]].type){update_state(a[1])}poc_internal_states.fire_stack.pop(a[1]);check_buses(a[1])},verbal:function(a){return""}};poc_behaviors.FIRE_IFSET={nparameters:3,types:["S","I"],operation:function(a){if(get_value(poc_signals[a[1]])!=parseInt(a[2])){return}poc_behaviors.FIRE.operation(a)},verbal:function(a){return""}};poc_behaviors.FIRE_IFCHANGED={nparameters:3,types:["S","X"],operation:function(a){sim_elto=get_reference(a[2]);if(sim_elto.changed==false){return}poc_behaviors.FIRE.operation(a)},verbal:function(a){return""}};poc_behaviors.RESET_CHANGED={nparameters:2,types:["X"],operation:function(a){sim_elto=get_reference(a[1]);sim_elto.changed=false},verbal:function(a){return""}};poc_behaviors.CLOCK={nparameters:1,operation:function(s_expr){var val=get_value(poc_states.CLK);set_value(poc_states.CLK,val+1);for(var i=0;i<jit_fire_order.length;i++){fn_updateE_now(jit_fire_order[i])}var new_maddr=get_value(poc_states.MUXA_MICROADDR);set_value(poc_states.REG_MICROADDR,new_maddr);if(typeof poc_internal_states.MC[new_maddr]!="undefined"){var new_mins=Object.create(poc_internal_states.MC[new_maddr])}else{var new_mins=Object.create(poc_states.REG_MICROINS.default_value)}poc_states.REG_MICROINS.value=new_mins;for(var key in poc_signals){if(typeof new_mins[key]!="undefined"){set_value(poc_signals[key],new_mins[key])}else{set_value(poc_signals[key],poc_signals[key].default_value)}}for(var i=0;i<jit_fire_order.length;i++){fn_updateL_now(jit_fire_order[i])}if(typeof new_mins.NATIVE_JIT!="undefined"){new_mins.NATIVE_JIT()}else{if(typeof new_mins.NATIVE!="undefined"){eval(new_mins.NATIVE)}}},verbal:function(a){return""}};poc_behaviors.CPU_RESET={nparameters:1,operation:function(a){for(var c in poc_states){reset_value(poc_states[c])}for(var c in poc_signals){reset_value(poc_signals[c])}},verbal:function(a){return"Reset CPU. "}};poc_behaviors.UPDATEDPC={nparameters:1,operation:function(a){show_asmdbg_pc()},verbal:function(a){return""}};poc_behaviors.UPDATE_NZVC={nparameters:1,operation:function(a){set_value(simhw_sim_state("FLAG_N"),poc_internal_states.alu_flags.flag_n);set_value(simhw_sim_state("FLAG_Z"),poc_internal_states.alu_flags.flag_z);set_value(simhw_sim_state("FLAG_V"),poc_internal_states.alu_flags.flag_v);set_value(simhw_sim_state("FLAG_C"),poc_internal_states.alu_flags.flag_c);set_value(simhw_sim_signal("TEST_N"),poc_internal_states.alu_flags.flag_n);set_value(simhw_sim_signal("TEST_Z"),poc_internal_states.alu_flags.flag_z);set_value(simhw_sim_signal("TEST_V"),poc_internal_states.alu_flags.flag_v);set_value(simhw_sim_signal("TEST_C"),poc_internal_states.alu_flags.flag_c);update_draw(poc_signals.TEST_N,poc_signals.TEST_N.value);update_draw(poc_signals.TEST_Z,poc_signals.TEST_Z.value);update_draw(poc_signals.TEST_V,poc_signals.TEST_V.value);update_draw(poc_signals.TEST_C,poc_signals.TEST_C.value)},verbal:function(a){return"Update flags N-Z-V-C."}};poc_components.MEMORY={name:"MEMORY",version:"1",abilities:["MEMORY"],details_name:["MEMORY","MEMORY_CONFIG"],details_fire:[["svg_p:text3001"],[]],write_state:function(d){if(typeof d.MEMORY=="undefined"){d.MEMORY={}}var c=0;var e=0;for(var a in poc_internal_states.MP){e=parseInt(poc_internal_states.MP[a]);if(e!=0){c=parseInt(a).toString(16);d.MEMORY["0x"+c]={type:"memory",default_value:0,id:"0x"+c,op:"=",value:"0x"+e.toString(16)}}}return d},read_state:function(d,a){if(typeof d.MEMORY=="undefined"){d.MEMORY={}}var c=parseInt(a.id).toString(16);var e=parseInt(a.value).toString(16);if("MEMORY"==a.type.toUpperCase().trim()){d.MEMORY["0x"+c]={type:"memory",default_value:0,id:"0x"+c,op:a.condition,value:"0x"+e};return true}return false},get_state:function(c){var a=parseInt(c);if(typeof poc_internal_states.MP[a]!="undefined"){return"0x"+parseInt(poc_internal_states.MP[a]).toString(16)}return null},get_value:function(a){return(simhw_internalState_get("MP",a)>>>0)},set_value:function(a,c){simhw_internalState_set("MP",a,c);return c}};poc_internal_states.segments={};poc_internal_states.MP={};poc_internal_states.MP_wc=0;poc_signals.MRDY={name:"MRDY",visible:true,type:"L",value:0,default_value:0,nbits:"1",depends_on:["CLK"],behavior:["FIRE_IFCHANGED MRDY C","FIRE_IFCHANGED MRDY C"],fire_name:["svg_p:tspan3916"],draw_data:[[],["svg_p:path3895","svg_p:path3541"]],draw_name:[[],[]]};poc_signals.R={name:"R",visible:true,type:"L",value:0,default_value:0,nbits:"1",behavior:["NOP","MEM_READ BUS_AB BUS_DB BW MRDY CLK; FIRE M1; FIRE MRDY"],fire_name:["svg_p:text3533-5-2"],draw_data:[[],["svg_p:path3557","svg_p:path3571"]],draw_name:[[],[]]};poc_signals.W={name:"W",visible:true,type:"L",value:0,default_value:0,nbits:"1",behavior:["NOP","MEM_WRITE BUS_AB BUS_DB BW MRDY CLK; FIRE M1; FIRE MRDY"],fire_name:["svg_p:text3533-5-08"],draw_data:[[],["svg_p:path3559","svg_p:path3575","svg_p:path3447-7"]],draw_name:[[],[]]};poc_signals.BW={name:"BW",verbal:["Access to one byte from memory. ","Access to two bytes from memory. ","Access to three bytes from memory. ","Access to a word from memory. "],visible:true,type:"L",value:0,default_value:0,nbits:"2",behavior:["FIRE R; FIRE W","FIRE R; FIRE W","FIRE R; FIRE W","FIRE R; FIRE W"],fire_name:["svg_p:text3533-5-2-8"],draw_data:[["svg_p:path3557-0"]],draw_name:[[],[]]};poc_behaviors.MEM_READ={nparameters:6,types:["E","E","S","S","E"],operation:function(c){var a=poc_states[c[1]].value;var e=poc_states[c[2]].value;var k=poc_signals[c[3]].value;var g=get_value(poc_states[c[5]].value);poc_signals[c[4]].value=0;var h=get_var(poc_internal_states.MP_wc);if((typeof poc_events.mem[g-1]!="undefined")&&(poc_events.mem[g-1]>0)){h=poc_events.mem[g-1]-1}poc_events.mem[g]=h;if(h>0){return}var f=0;var d=a&4294967292;if(typeof poc_internal_states.MP[d]!="undefined"){f=poc_internal_states.MP[d]}switch(k){case 0:if(0==(a&3)){e=(f&255)}if(1==(a&3)){e=(f&65280)>>8}if(2==(a&3)){e=(f&16711680)>>16}if(3==(a&3)){e=(f&4278190080)>>24}break;case 1:if(0==(a&3)){e=(f&65535)}if(1==(a&3)){e=(f&65535)}if(2==(a&3)){e=(f&4294901760)>>16}if(3==(a&3)){e=(f&4294901760)>>16}break;case 2:if(0==(a&3)){e=(f&16777215)}if(1==(a&3)){e=(f&4294967040)}break;case 3:e=f;break}poc_states[c[2]].value=(e>>>0);poc_signals[c[4]].value=1;show_main_memory(poc_internal_states.MP,d,false,false)},verbal:function(c){var e="";var a=poc_states[c[1]].value;var d=poc_states[c[2]].value;var h=poc_signals[c[3]].value;var g=get_value(poc_states[c[5]].value);switch(h){case 0:bw_type="byte";break;case 1:bw_type="half";break;case 2:bw_type="three bytes";break;case 3:bw_type="word";break}var f=0;if(typeof poc_internal_states.MP[a]!="undefined"){f=poc_internal_states.MP[a]}e="Try to read a "+bw_type+" from memory at address 0x"+a.toString(16)+" with value "+f.toString(16)+". ";return e}};poc_behaviors.MEM_WRITE={nparameters:6,types:["E","E","S","S","E"],operation:function(c){var a=poc_states[c[1]].value;var e=poc_states[c[2]].value;var k=poc_signals[c[3]].value;var g=get_value(poc_states[c[5]].value);poc_signals[c[4]].value=0;var h=get_var(poc_internal_states.MP_wc);if((typeof poc_events.mem[g-1]!="undefined")&&(poc_events.mem[g-1]>0)){h=poc_events.mem[g-1]-1}poc_events.mem[g]=h;if(h>0){return}var f=0;var d=a&4294967292;if(typeof poc_internal_states.MP[d]!="undefined"){f=poc_internal_states.MP[d]}switch(k){case 0:if(0==(a&3)){f=(f&4294967040)|(e&255)}if(1==(a&3)){f=(f&4294902015)|((e&255)<<8)}if(2==(a&3)){f=(f&4278255615)|((e&255)<<16)}if(3==(a&3)){f=(f&16777215)|((e&255)<<24)}break;case 1:if(0==(a&3)){f=(f&4294901760)|(e&65535)}if(1==(a&3)){f=(f&4294901760)|(e&65535)}if(2==(a&3)){f=(f&65535)|((e&65535)<<16)}if(3==(a&3)){f=(f&65535)|((e&65535)<<16)}break;case 2:if(0==(a&3)){f=(f&4278190080)|(e&16777215)}if(1==(a&3)){f=(f&255)|(e&4294967040)}break;case 3:f=e;break}poc_internal_states.MP[d]=(f>>>0);poc_signals[c[4]].value=1;show_main_memory(poc_internal_states.MP,d,true,true)},verbal:function(c){var e="";var a=poc_states[c[1]].value;var d=poc_states[c[2]].value;var h=poc_signals[c[3]].value;var g=get_value(poc_states[c[5]].value);switch(h){case 0:bw_type="byte";break;case 1:bw_type="half";break;case 2:bw_type="three bytes";break;case 3:bw_type="word";break}var f=0;if(typeof poc_internal_states.MP[a]!="undefined"){f=poc_internal_states.MP[a]}e="Try to write a "+bw_type+" to memory at address 0x"+a.toString(16)+" with value "+f.toString(16)+". ";return e}};poc_behaviors.MEMORY_RESET={nparameters:1,operation:function(a){poc_events.mem={}},verbal:function(a){return"Reset the memory (all values will be zeroes). "}};poc_components.IO={name:"IO",version:"1",abilities:["IO_TIMER"],details_name:["IO_STATS","IO_CONFIG"],details_fire:[["svg_p:text3775"],[]],write_state:function(a){return a},read_state:function(c,a){return false},get_state:function(a){return null},get_value:function(a){var c=simhw_internalState_get("io_hash",a);var d=(get_value(simhw_sim_state(c))>>>0);set_value(simhw_sim_state("BUS_AB"),a);set_value(simhw_sim_signal("IOR"),1);compute_behavior("FIRE IOR");d=get_value(simhw_sim_state("BUS_DB"));return d},set_value:function(a,d){var c=simhw_internalState_get("io_hash",a);set_value(simhw_sim_state(c),d);set_value(simhw_sim_state("BUS_AB"),a);set_value(simhw_sim_state("BUS_DB"),d);set_value(simhw_sim_signal("IOW"),1);compute_behavior("FIRE IOW");return d}};poc_internal_states.io_int_factory=[];poc_internal_states.io_int_factory[0]={period:0,probability:0.5,accumulated:0,active:false};poc_internal_states.io_int_factory[1]={period:0,probability:0.5,accumulated:0,active:false};poc_internal_states.io_int_factory[2]={period:0,probability:0.5,accumulated:0,active:false};poc_internal_states.io_int_factory[3]={period:0,probability:0.5,accumulated:0,active:false};poc_internal_states.io_int_factory[4]={period:0,probability:0.5,accumulated:0,active:false};poc_internal_states.io_int_factory[5]={period:0,probability:0.5,accumulated:0,active:false};poc_internal_states.io_int_factory[6]={period:0,probability:0.5,accumulated:0,active:false};poc_internal_states.io_int_factory[7]={period:0,probability:0.5,accumulated:0,active:false};var IOSR_ID=4352;var IOCR_ID=4356;var IODR_ID=4360;poc_internal_states.io_hash[IOSR_ID]="IOSR";poc_internal_states.io_hash[IOCR_ID]="IOCR";poc_internal_states.io_hash[IODR_ID]="IODR";poc_states.IOSR={name:"IOSR",verbal:"IO State Register",visible:false,nbits:"32",value:0,default_value:0,draw_data:[]};poc_states.IOCR={name:"IOCR",verbal:"IO Control Register",visible:false,nbits:"32",value:0,default_value:0,draw_data:[]};poc_states.IODR={name:"IODR",verbal:"IO Data Register",visible:false,nbits:"32",value:0,default_value:0,draw_data:[]};poc_signals.INT={name:"INT",visible:true,type:"L",value:0,default_value:0,nbits:"1",depends_on:["CLK"],behavior:["FIRE C","FIRE C"],fire_name:["svg_p:tspan4199"],draw_data:[[],["svg_p:path3809"]],draw_name:[[],[]]};poc_signals.IORDY={name:"IORDY",visible:true,type:"L",value:0,default_value:0,nbits:"1",depends_on:["CLK"],behavior:["FIRE_IFCHANGED IORDY C","FIRE_IFCHANGED IORDY C"],fire_name:["svg_p:tspan4089","svg_p:path3793","svg_p:tspan4089"],draw_data:[[],["svg_p:path3897"]],draw_name:[[],[]]};poc_signals.IO_IOR={name:"IO_IOR",visible:true,type:"L",value:0,default_value:0,nbits:"1",behavior:["NOP","IO_IOR BUS_AB BUS_DB IOSR IOCR IODR CLK; FIRE M1"],fire_name:["svg_p:tspan4173"],draw_data:[[],["svg_p:path3795","svg_p:path3733"]],draw_name:[[],[]]};poc_signals.IO_IOW={name:"IO_IOW",visible:true,type:"L",value:0,default_value:0,nbits:"1",behavior:["NOP","IO_IOW BUS_AB BUS_DB IOSR IOCR IODR CLK; FIRE M1"],fire_name:["svg_p:text3785-0-6-0-5-5"],draw_data:[[],["svg_p:path3805","svg_p:path3733"]],draw_name:[[],[]]};poc_signals.IO_IE={name:"IO_IE",visible:true,type:"L",value:1,default_value:1,nbits:"1",behavior:["NOP","IO_CHK_I CLK INT INTV; FIRE C"],fire_name:[],draw_data:[[],[]],draw_name:[[],[]]};poc_signals.INTA={name:"INTA",visible:true,type:"L",value:1,default_value:0,nbits:"1",behavior:["NOP","INTA CLK INT INTA BUS_DB INTV; FIRE M1; FIRE C"],fire_name:["svg_p:text3785-0-6-0-5-5-1-1"],draw_data:[[],["svg_p:path3807","svg_p:path3737"]],draw_name:[[],[]]};poc_behaviors.IO_IOR={nparameters:7,types:["E","E","E","E","E","E"],operation:function(a){var f=get_value(poc_states[a[1]]);var c=get_value(poc_states[a[3]]);var d=get_value(poc_states[a[4]]);var e=get_value(poc_states[a[5]]);if(f==IOSR_ID){set_value(poc_states[a[2]],c)}if(f==IOCR_ID){set_value(poc_states[a[2]],d)}if(f==IODR_ID){set_value(poc_states[a[2]],e)}},verbal:function(a){var e="";var g=get_value(poc_states[a[1]]);var c=get_value(poc_states[a[3]]);var d=get_value(poc_states[a[4]]);var f=get_value(poc_states[a[5]]);if(g==IOSR_ID){e="I/O device read at IOSR of value "+c+". "}if(g==IOCR_ID){e="I/O device read at IOCR of value "+d+". "}if(g==IODR_ID){e="I/O device read at IODR of value "+f+". "}return e}};poc_behaviors.IO_IOW={nparameters:7,types:["E","E","E","E","E","E"],operation:function(c){var f=get_value(poc_states[c[1]]);var d=get_value(poc_states[c[2]]);if((f!=IOSR_ID)&&(f!=IOCR_ID)&&(f!=IODR_ID)){return}if(f==IOSR_ID){set_value(poc_states[c[3]],d)}if(f==IOCR_ID){set_value(poc_states[c[4]],d)}if(f==IODR_ID){set_value(poc_states[c[5]],d)}var a=get_value(poc_states[c[4]]);var e=get_value(poc_states[c[5]]);if((a<0)||(a>7)){return}set_var(poc_internal_states.io_int_factory[a].period,e);set_var(poc_internal_states.io_int_factory[a].probability,1);if(0==e){set_var(poc_internal_states.io_int_factory[a].probability,0)}},verbal:function(a){var d="";var e=get_value(poc_states[a[1]]);var c=get_value(poc_states[a[2]]);if(e==IOSR_ID){d="I/O device write at IOSR with value "+c+". "}if(e==IOCR_ID){d="I/O device write at IOCR with value "+c+". "}if(e==IODR_ID){d="I/O device write at IODR with value "+c+". "}return d}};poc_behaviors.IO_CHK_I={nparameters:4,types:["E","S","E"],operation:function(a){var d=get_value(poc_states[a[1]]);for(var c=poc_internal_states.io_int_factory.length-1;c>=0;c--){if(get_var(poc_internal_states.io_int_factory[c].period)==0){continue}if(get_var(poc_internal_states.io_int_factory[c].active)==true){set_value(poc_signals[a[2]],1);set_value(poc_states[a[3]],c)}if((d%get_var(poc_internal_states.io_int_factory[c].period))==0){if(Math.random()>get_var(poc_internal_states.io_int_factory[c].probability)){continue}set_var(poc_internal_states.io_int_factory[c].accumulated,get_var(poc_internal_states.io_int_factory[c].accumulated)+1);set_var(poc_internal_states.io_int_factory[c].active,true);if(typeof poc_events.io[d]=="undefined"){poc_events.io[d]=[]}poc_events.io[d].push(c);set_value(poc_signals[a[2]],1);set_value(poc_states[a[3]],c)}}},verbal:function(a){return"Check I/O Interruption. "}};poc_behaviors.INTA={nparameters:6,types:["E","S","S","E","E"],operation:function(a){var d=get_value(poc_states[a[1]]);if(typeof poc_events.io[d]!="undefined"){set_value(poc_states[a[4]],poc_events.io[d][0]);return}set_value(poc_signals[a[2]],0);set_value(poc_states[a[5]],0);for(var c=0;c<poc_internal_states.io_int_factory.length;c++){if(get_var(poc_internal_states.io_int_factory[c].active)){set_value(poc_signals[a[2]],0);set_value(poc_states[a[5]],c);set_value(poc_states[a[4]],c);if(typeof poc_events.io[d]=="undefined"){poc_events.io[d]=[]}poc_events.io[d].push(c);set_var(poc_internal_states.io_int_factory[c].active,false);break}}},verbal:function(a){return"Signal an interruption ACK. "}};poc_behaviors.IO_RESET={nparameters:1,operation:function(a){poc_events.io={};for(var c=0;c<poc_internal_states.io_int_factory.length;c++){set_var(poc_internal_states.io_int_factory[c].accumulated,0);set_var(poc_internal_states.io_int_factory[c].active,false)}},verbal:function(a){return"Reset the I/O device. "}};poc_components.KBD={name:"KBD",version:"1",abilities:["KEYBOARD"],details_name:["KEYBOARD"],details_fire:[["svg_p:text3829"]],write_state:function(a){return a},read_state:function(c,a){return false},get_state:function(a){return null},get_value:function(a){return poc_internal_states.keyboard_content},set_value:function(a,c){poc_internal_states.keyboard_content=c;return c}};var KBDR_ID=256;var KBSR_ID=260;poc_internal_states.io_hash[KBDR_ID]="KBDR";poc_internal_states.io_hash[KBSR_ID]="KBSR";poc_internal_states.keyboard_content="";poc_states.KBDR={name:"KBDR",verbal:"Keyboard Data Register",visible:false,nbits:"32",value:0,default_value:0,draw_data:[]};poc_states.KBSR={name:"KBSR",verbal:"Keyboard Status Register",visible:false,nbits:"32",value:0,default_value:0,draw_data:[]};poc_signals.KBD_IOR={name:"IOR",visible:true,type:"L",value:0,default_value:0,nbits:"1",behavior:["NOP","KBD_IOR BUS_AB BUS_DB KBDR KBSR CLK; FIRE M1"],fire_name:["svg_p:tspan4057"],draw_data:[[],["svg_p:path3863","svg_p:path3847"]],draw_name:[[],[]]};poc_behaviors.KBD_IOR={nparameters:6,types:["E","E","E","E","E"],operation:function(d){var f=get_value(poc_states[d[1]]);var e=get_value(poc_states[d[5]]);if((f!=KBDR_ID)&&(f!=KBSR_ID)){return}if(typeof poc_events.keybd[e]!="undefined"){if(f==KBDR_ID){set_value(poc_states[d[2]],poc_events.keybd[e])}if(f==KBSR_ID){set_value(poc_states[d[2]],1)}return}if(get_value(poc_states[d[4]])==0){var c=get_keyboard_content();if(c.length!==0){var a=c.substr(1,c.length-1);set_keyboard_content(a);set_value(poc_states[d[4]],1);set_value(poc_states[d[3]],c[0].charCodeAt(0))}}if(get_value(poc_states[d[4]])==1){poc_events.keybd[e]=get_value(poc_states[d[3]])}if(f==KBSR_ID){set_value(poc_states[d[2]],get_value(poc_states[d[4]]))}if(f==KBDR_ID){if(get_value(poc_states[d[4]])==1){set_value(poc_states[d[2]],get_value(poc_states[d[3]]))}set_value(poc_states[d[4]],0)}},verbal:function(a){var c="";var e=get_value(poc_states[a[1]]);var d=get_value(poc_states[a[5]]);if(e==KBDR_ID){c="Read the screen data: "+poc_states[a[2]]+". "}if(e==KBSR_ID){c="Read the screen state: "+poc_states[a[2]]+". "}return c}};poc_behaviors.KBD_RESET={nparameters:1,operation:function(a){poc_events.keybd={}},verbal:function(a){return"Reset the keyboard content. "}};poc_components.SCREEN={name:"SCREEN",version:"1",abilities:["SCREEN"],details_name:["SCREEN"],details_fire:[["svg_p:text3845"]],write_state:function(c){if(typeof c.SCREEN=="undefined"){c.SCREEN={}}var e=poc_internal_states.screen_content;var d=e.trim().split("\n");for(var a=0;a<d.length;a++){value=d[a];if(value!=""){c.SCREEN[a]={type:"screen",default_value:"",id:a,op:"==",value:value}}}return c},read_state:function(c,a){if(typeof c.SCREEN=="undefined"){c.SCREEN={}}if("SCREEN"==a.type.toUpperCase().trim()){c.SCREEN[a.id]={type:"screen",default_value:"",id:a.id,op:a.condition,value:a.value};return true}return false},get_state:function(a){var e=poc_internal_states.screen_content;var d=e.trim().split("\n");var c=parseInt(a);if(typeof d[c]!="undefined"){return d[c]}return null},get_value:function(a){return poc_internal_states.screen_content},set_value:function(a,c){poc_internal_states.screen_content=c;return c}};var DDR_ID=4096;var DSR_ID=4100;poc_internal_states.io_hash[DDR_ID]="DDR";poc_internal_states.io_hash[DSR_ID]="DSR";poc_internal_states.screen_content="";poc_states.DDR={name:"DDR",verbal:"Display Data Register",visible:false,nbits:"32",value:0,default_value:0,draw_data:[]};poc_states.DSR={name:"DSR",verbal:"Display State Register",visible:false,nbits:"32",value:0,default_value:0,draw_data:[]};poc_signals.SCR_IOR={name:"IOR",visible:true,type:"L",value:0,default_value:0,nbits:"1",behavior:["NOP","SCR_IOR BUS_AB BUS_DB DDR DSR CLK"],fire_name:["svg_p:tspan4004"],draw_data:[[],["svg_p:path3871","svg_p:path3857"]],draw_name:[[],[]]};poc_signals.SCR_IOW={name:"IOW",visible:true,type:"L",value:0,default_value:0,nbits:"1",behavior:["NOP","SCR_IOW BUS_AB BUS_DB DDR DSR CLK"],fire_name:["svg_p:tspan4006"],draw_data:[[],["svg_p:path3873","svg_p:path3857"]],draw_name:[[],[]]};poc_behaviors.SCR_IOR={nparameters:6,types:["E","E","E","E","E"],operation:function(c){var e=get_value(poc_states[c[1]]);var d=get_value(poc_states[c[3]]);var a=get_value(poc_states[c[4]]);if(e==DDR_ID){set_value(poc_states[c[2]],d)}if(e==DSR_ID){set_value(poc_states[c[2]],a)}},verbal:function(c){var e="";var f=get_value(poc_states[c[1]]);var d=get_value(poc_states[c[3]]);var a=get_value(poc_states[c[4]]);if(f==DDR_ID){e="Try to read from the screen the DDR value "+d+". "}if(f==DDR_ID){e="Try to read into the screen the DSR value "+a+". "}return e}};poc_behaviors.SCR_IOW={nparameters:6,types:["E","E","E","E","E"],operation:function(d){var k=get_value(poc_states[d[1]]);var f=get_value(poc_states[d[2]]);var h=get_value(poc_states[d[5]]);var g=String.fromCharCode(f);if(k!=DDR_ID){return}if(g==String.fromCharCode(7)){timbre.reset();var e=T("sin",{freq:440,mul:0.5});var c=T("sin",{freq:660,mul:0.5});T("perc",{r:500},e,c).on("ended",function(){this.pause()}).bang().play()}else{var a=get_screen_content();if(typeof poc_events.screen[h]!="undefined"){a=a.substr(0,a.length-1)}set_screen_content(a+String.fromCharCode(f))}set_value(poc_states[d[3]],f);set_value(poc_states[d[4]],1);poc_events.screen[h]=f},verbal:function(a){var e="";var g=get_value(poc_states[a[1]]);var c=get_value(poc_states[a[2]]);var f=get_value(poc_states[a[5]]);var d=String.fromCharCode(c);if(g==DDR_ID){e="Try to write into the screen the code "+d+" at clock cycle "+f+". "}return e}};poc_behaviors.SCREEN_RESET={nparameters:1,operation:function(a){poc_events.screen={}},verbal:function(a){return"Reset the screen content. "}};function nextToken(d){var a="";var g="";var f="";var e="";while(("# \t\n\r".indexOf(d.text[d.t])!=-1)&&(d.t<d.text.length)){if(d.text[d.t]=="#"){g=d.t+1;while(("\n".indexOf(d.text[d.t])==-1)&&(d.t<d.text.length)){d.t++}f=d.t;a=d.text.substring(g,f);a=a.trim();d.comments.push(a)}if(d.text[d.t]=="\n"){d.line++;d.newlines.push(d.t)}d.t++}if(("{},()=:".indexOf(d.text[d.t])!=-1)&&(d.t<d.text.length)){a=d.text[d.t];d.t++;d.tokens.push(a);d.token_types.push("TOKEN");d.i=d.tokens.length-1;return d}if('"'==d.text[d.t]){g=d.t;d.t++;while(('"'.indexOf(d.text[d.t])==-1)&&(d.t<d.text.length)){if("\\".indexOf(d.text[d.t])!=-1){d.t++}d.t++}d.t++;f=d.t;e="STRING"}else{if("'"==d.text[d.t]){g=d.t;d.t++;while(("'".indexOf(d.text[d.t])==-1)&&(d.t<d.text.length)){if("\\".indexOf(d.text[d.t])!=-1){d.t++}d.t++}d.t++;f=d.t;e="STRING"}else{g=d.t;while(("{},()=:# \t\n\r".indexOf(d.text[d.t])==-1)&&(d.t<d.text.length)){d.t++}f=d.t;e="TOKEN"}}var c=d.t;while(("# \t\n\r".indexOf(d.text[c])!=-1)&&(c<d.text.length)){if(d.text[c]=="#"){while(("\n".indexOf(d.text[c])==-1)&&(c<d.text.length)){c++}}c++}if(":"==d.text[c]){e="TAG";d.t=c+1}a=d.text.substring(g,f);a=a.trim();if("TAG"==e){a=a+":"}d.tokens.push(a);d.token_types.push(e);d.i=d.tokens.length-1;return d}function getToken(a){return a.tokens[a.i]}function getTokenType(a){return a.token_types[a.i]}function isToken(a,c){return(getToken(a)==c.trim())}function langError(f,g){var a=0;if(f.newlines.length>0){a=f.newlines[f.newlines.length-1]+1}var d=0;if(f.newlines.length>1){d=f.newlines[f.newlines.length-2]+1}var c=d;var h=Math.min(f.t-1,a+32);for(;(typeof f.text[h+1]!="undefined")&&(f.text[h+1]!="\n");h++){}var k=h+2;h++;for(;(typeof f.text[h+1]!="undefined")&&(f.text[h+1]!="\n");h++){}h++;f.error="<pre style='background-color: inherit !important'>...\n";for(var e=c;e<h;e++){if(e==d){f.error+=" "+(f.line-1)+"\t"}if(e==a){f.error+="*"+f.line+"\t"}if(e==k){f.error+=" "+(f.line+1)+"\t"}if(typeof f.text[e]!="undefined"){f.error+=f.text[e]}else{f.error+="&lt;EOF&gt;"}}f.error+="\n...\n</pre>(*) Problem around line "+f.line+":<br>"+g+".<br>";if(typeof ga!=="undefined"){ga("send","event","compile","compile.error","compile.error."+g)}return f}function getLabelContext(a){return{t:a.t,line:a.line,newlines:a.newlines.slice()}}function setLabelContext(c,a){c.t=a.t;c.line=a.line;c.newlines=a.newlines}function getComments(a){return a.comments.join("\n")}function resetComments(a){a.comments=[]}function nextNative(c){var f=c.t;var d=c.t;var e=1;while((c.t<c.text.length)&&(e!=0)){if("{"==c.text[c.t]){e++}if("}"==c.text[c.t]){e--}c.t++}d=c.t-1;var a=c.text.substring(f,d);c.tokens.push(a);c.token_types.push("NATIVE");c.i=c.tokens.length-1;return c}function read_microprg(a){var e=[];var o=[];resetComments(a);if(!isToken(a,"{")){return langError(a,"Expected '{' not found")}nextToken(a);while(!isToken(a,"}")){var l={};if(!isToken(a,"(")){var m=getToken(a);m=m.substring(0,m.length-1);if("TAG"!=getTokenType(a)){return langError(a,"Expected '<label>:' not found but '"+m+"'.")}for(var d in a.etiquetas){if(a.etiquetas[d]==m){return langError(a,"Label is repeated: "+getToken(a))}}a.etiquetas[a.contadorMC]=m;if(m.match("[a-zA-Z_0-9]*")[0]!=m){return langError(a,"Label format is not valid for '"+getToken(a)+"'")}nextToken(a)}if(!isToken(a,"(")){return langError(a,"Expected '(' not found")}nextToken(a);while(!isToken(a,")")){var g=getToken(a).toUpperCase();if(g=="MADDR"){nextToken(a);if(!isToken(a,"=")){return langError(a,"Expected '=' not found")}nextToken(a);var n={};n.nombre=getToken(a);n.cycle=e.length;n.index=a.i;n.instruction=a.instrucciones.length;var f=0;for(var h in a.etiquetas){if(isToken(a,a.etiquetas[h])){l[g]=h.toString();f=1}}if(f==0){a.labelsNotFound.push(n)}nextToken(a);if(isToken(a,",")){nextToken(a)}continue}if(typeof simhw_sim_signal(g)=="undefined"){return langError(a,"Signal does not exists: '"+g+"'")}if(typeof simhw_sim_signal(g).forbidden!="undefined"){return langError(a,"Signal '"+g+"' cannot be used directly, please use the Control Unit signals instead.")}l[g]=1;nextToken(a);if(isToken(a,"=")){nextToken(a);l[g]=parseInt(getToken(a),2);if(getToken(a).match("[01]*")[0]!=getToken(a)){return langError(a,"Incorrect binary format: "+getToken(a))}if(l[g]>=Math.pow(2,simhw_sim_signal(g).nbits)){return langError(a,"Value out of range: "+getToken(a))}nextToken(a)}if(isToken(a,",")){nextToken(a)}}var c=getComments(a);o.push(c);resetComments(a);e.push(l);a.contadorMC++;nextToken(a);if(isToken(a,",")){nextToken(a)}}if(e.length===0){return langError(a,"Empty microcode")}nextToken(a);return{microprograma:e,microcomments:o}}function read_native(c){var e=[];var a=[];if(!isToken(c,"{")){return langError(c,"Expected '{' not found")}nextNative(c);var d={};d.NATIVE=getToken(c);e.push(d);a.push("");nextToken(c);return{microprograma:e,microcomments:a}}function loadFirmware(text){var xr_info=simhw_sim_ctrlStates_get();var all_ones_co="1".repeat(xr_info.ir.default_eltos.co.length);var context={};context.line=1;context.error=null;context.i=0;context.contadorMC=0;context.etiquetas={};context.labelsNotFound=[];context.instrucciones=[];context.co_cop={};context.registers=[];context.text=text;context.tokens=[];context.token_types=[];context.t=0;context.newlines=[];context.pseudoInstructions=[];context.stackRegister=null;context.comments=[];nextToken(context);while(context.t<context.text.length){if(isToken(context,"registers")){nextToken(context);if(!isToken(context,"{")){return langError(context,"Expected '{' not found")}nextToken(context);while(!isToken(context,"}")){var nombre_reg=getToken(context);nextToken(context);if(!isToken(context,"=")){return langError(context,"Expected '=' not found")}nextToken(context);context.registers[nombre_reg]=getToken(context);nextToken(context);if(isToken(context,"(")){if(context.stackRegister!=null){return langError(context,"Duplicate definition of stack pointer")}nextToken(context);if(!isToken(context,"stack_pointer")){return langError(context,"Expected stack_pointer token not found")}context.stackRegister=nombre_reg;nextToken(context);if(!isToken(context,")")){return langError(context,"Expected ')' not found")}nextToken(context)}if(isToken(context,",")){nextToken(context)}}nextToken(context);continue}if(isToken(context,"pseudoinstructions")){nextToken(context);if(!isToken(context,"{")){return langError(context,"Expected '{' not found")}nextToken(context);while(!isToken(context,"}")){var pseudoInstructionAux={};var pseudoInitial={};pseudoInitial.signature="";pseudoInitial.name="";pseudoInitial.fields=[];pseudoInitial.name=getToken(context);pseudoInitial.signature=pseudoInitial.signature+getToken(context)+",";nextToken(context);while(!isToken(context,"{")){var pseudoFieldAux={};pseudoFieldAux.name=getToken(context);pseudoFieldAux.type=getToken(context).replace("num","inm");pseudoFieldAux.type=pseudoFieldAux.type.replace(/[_0-9]+$/,"");switch(pseudoFieldAux.type){case"reg":case"inm":case"addr":case"address":break;default:return langError(context,"Invalid parameter '"+pseudoFieldAux.type+"'. It only allows the following fields: reg, num, inm, addr, address")}pseudoInitial.fields.push(pseudoFieldAux);pseudoInitial.signature=pseudoInitial.signature+getToken(context)+",";nextToken(context);if(isToken(context,",")){nextToken(context)}}nextToken(context);pseudoInitial.signature=pseudoInitial.signature.substr(0,pseudoInitial.signature.length-1).replace(/num/g,"inm");pseudoInstructionAux.initial=pseudoInitial;var contPseudoFinish=0;var pseudoFinishAux={};pseudoFinishAux.signature="";var inStart=0;var cont=false;while(!isToken(context,"}")){if(inStart==0){for(i=0;i<context.instrucciones.length;i++){if(context.instrucciones[i].name==getToken(context)){cont=true;break}}if(!cont){return langError(context,"Undefined instruction '"+getToken(context)+"'")}}if(getToken(context)==";"){inStart=0}else{inStart++}pseudoFinishAux.signature=pseudoFinishAux.signature+getToken(context)+" ";nextToken(context)}pseudoInstructionAux.finish=pseudoFinishAux;pseudoInstructionAux.finish.signature=pseudoInstructionAux.finish.signature.replace(";","\n");context.pseudoInstructions.push(pseudoInstructionAux);nextToken(context)}nextToken(context);continue}if(isToken(context,"begin")){var instruccionAux={};instruccionAux.name=getToken(context);instruccionAux["mc-start"]=context.contadorMC;nextToken(context);if(isToken(context,",")){nextToken(context)}instruccionAux["native"]=false;if(isToken(context,"native")){instruccionAux["native"]=true;nextToken(context);if(isToken(context,",")){nextToken(context)}context.etiquetas[context.contadorMC]="fetch"}if(true==instruccionAux["native"]){var ret=read_native(context)}else{var ret=read_microprg(context)}if(typeof ret.error!="undefined"){return ret}instruccionAux.signature="begin";instruccionAux.signatureGlobal="begin";instruccionAux.signatureUser="begin";instruccionAux.signatureRaw="begin";instruccionAux.microcode=ret.microprograma;instruccionAux.microcomments=ret.microcomments;context.instrucciones.push(instruccionAux);context.contadorMC=context.contadorMC+9;continue}var instruccionAux={};instruccionAux.name=getToken(context);instruccionAux["mc-start"]=context.contadorMC;if(instruccionAux.name.match("[a-zA-Z_0-9]*")[0]!=instruccionAux.name){return langError(context,"Instruction name '"+instruccionAux.name+"' is not valid for [a-zA-Z_0-9]*")}var firma="";var firmaGlobal="";var firmaUsuario="";var numeroCampos=0;var campos=[];firma=getToken(context)+",";firmaUsuario=getToken(context)+" ";nextToken(context);while(isToken(context,",")){nextToken(context)}while(!isToken(context,"{")){while(isToken(context,",")){nextToken(context)}var plus_found=false;if(!isToken(context,",")&&!isToken(context,"(")&&!isToken(context,")")){var campoAux={};var auxValue=getToken(context);if(auxValue[auxValue.length-1]=="+"){auxValue=auxValue.substring(0,auxValue.length-1);plus_found=true}campoAux.name=auxValue;campos.push(campoAux);numeroCampos++;firma=firma+auxValue;firmaUsuario=firmaUsuario+auxValue;nextToken(context);if(numeroCampos>100){return langError(context,"more than 100 fields in a single instruction.")}if(auxValue=="co"){return langError(context,"instruction field has 'co' as name.")}if(auxValue=="nwords"){return langError(context,"instruction field has 'nwords' as name.")}}if(isToken(context,"(")){firma=firma+",(";if(plus_found){firmaUsuario=firmaUsuario+"+("}else{firmaUsuario=firmaUsuario+" ("}nextToken(context);if(!isToken(context,",")&&!isToken(context,"(")&&!isToken(context,")")){var campoAux={};campoAux.name=getToken(context);campos.push(campoAux);numeroCampos++;firma=firma+getToken(context);firmaUsuario=firmaUsuario+getToken(context);nextToken(context)}else{return langError(context,"'token' is missing after '(' on: "+context.co_cop[instruccionAux.co].signature)}if(isToken(context,")")){firma=firma+")";firmaUsuario=firmaUsuario+")";nextToken(context)}else{return langError(context,"')' is missing on: "+context.co_cop[instruccionAux.co].signature)}}firma=firma+",";firmaUsuario=firmaUsuario+" "}firma=firma.substr(0,firma.length-1);firma=firma.replace(/,,/g,",");firmaUsuario=firmaUsuario.substr(0,firmaUsuario.length-1);firmaUsuario=firmaUsuario.replace(/  /g," ");instruccionAux.signature=firma;instruccionAux.signatureGlobal=firma;instruccionAux.signatureUser=firmaUsuario;instruccionAux.signatureRaw=firmaUsuario;nextToken(context);if(!isToken(context,"co")){return langError(context,"Expected keyword 'co' not found")}nextToken(context);if(!isToken(context,"=")){return langError(context,"Expected '=' not found")}nextToken(context);instruccionAux.co=getToken(context);if((getToken(context).match("[01]*")[0]!=getToken(context))||(getToken(context).length!==xr_info.ir.default_eltos.co.length)){return langError(context,"Incorrect binary format on 'co': "+getToken(context))}if(instruccionAux.co!=all_ones_co){if((typeof context.co_cop[instruccionAux.co]!="undefined")&&(context.co_cop[instruccionAux.co].cop===null)){return langError(context,"'co' is already been used by: "+context.co_cop[instruccionAux.co].signature)}if(typeof context.co_cop[instruccionAux.co]=="undefined"){context.co_cop[instruccionAux.co]={};context.co_cop[instruccionAux.co].signature=instruccionAux.signature;context.co_cop[instruccionAux.co].cop=null}}nextToken(context);if(isToken(context,",")){nextToken(context)}if(isToken(context,"cop")){nextToken(context);if(!isToken(context,"=")){return langError(context,"Expected '=' not found")}nextToken(context);instruccionAux.cop=getToken(context);if((getToken(context).match("[01]*")[0]!=getToken(context))||(getToken(context).length!==xr_info.ir.default_eltos.cop.length)){return langError(context,"Incorrect binary format on 'cop': "+getToken(context))}if((context.co_cop[instruccionAux.co].cop!=null)&&(typeof context.co_cop[instruccionAux.co].cop[instruccionAux.cop]!="undefined")){return langError(context,"'co+cop' is already been used by: "+context.co_cop[instruccionAux.co].cop[instruccionAux.cop])}if(context.co_cop[instruccionAux.co].cop==null){context.co_cop[instruccionAux.co].cop={}}context.co_cop[instruccionAux.co].cop[instruccionAux.cop]=instruccionAux.signature;nextToken(context);if(isToken(context,",")){nextToken(context)}}if(!isToken(context,"nwords")){return langError(context,"Expected keyword 'nwords' not found")}nextToken(context);if(!isToken(context,"=")){return langError(context,"Expected '=' not found")}nextToken(context);instruccionAux.nwords=getToken(context);nextToken(context);if(isToken(context,",")){nextToken(context)}var camposInsertados=0;var overlapping={};while(camposInsertados<numeroCampos){var tmp_name=getToken(context);if(campos[camposInsertados]["name"]!=tmp_name){return langError(context,"Unexpected field found: '"+tmp_name+"'")}nextToken(context);if(!isToken(context,"=")){return langError(context,"Expected '=' not found")}nextToken(context);if(!isToken(context,"reg")&&!isToken(context,"inm")&&!isToken(context,"address")){return langError(context,"Incorrect type of field (reg, inm or address)")}campos[camposInsertados]["type"]=getToken(context);firma=firma.replace(","+campos[camposInsertados]["name"],","+campos[camposInsertados]["type"]);firma=firma.replace("("+campos[camposInsertados]["name"],"("+campos[camposInsertados]["type"]);firma=firma.replace(")"+campos[camposInsertados]["name"],")"+campos[camposInsertados]["type"]);firmaUsuario=firmaUsuario.replace(campos[camposInsertados]["name"],campos[camposInsertados]["type"]);instruccionAux.signature=firma;instruccionAux.signatureUser=firmaUsuario;firmaGlobal=firma.replace("address","num");firmaGlobal=firmaGlobal.replace("inm","num");instruccionAux.signatureGlobal=firmaGlobal;nextToken(context);if(!isToken(context,"(")){return langError(context,"Expected '(' not found")}nextToken(context);campos[camposInsertados]["startbit"]=getToken(context);var start=parseInt(campos[camposInsertados]["startbit"]);if(start>32*parseInt(instruccionAux.nwords)-1){return langError(context,"startbit out of range: "+getToken(context))}nextToken(context);if(!isToken(context,",")){return langError(context,"Expected ',' not found")}nextToken(context);campos[camposInsertados]["stopbit"]=getToken(context);var stop=parseInt(campos[camposInsertados]["stopbit"]);if(stop>32*parseInt(instruccionAux.nwords)){return langError(context,"stopbit out of range: "+getToken(context))}for(var i=stop;i<=start;i++){if(typeof overlapping[i]!="undefined"){return langError(context,"overlapping field: "+campos[camposInsertados]["name"])}overlapping[i]=1}nextToken(context);if(!isToken(context,")")){return langError(context,"Expected ')' not found")}nextToken(context);if(campos[camposInsertados]["type"]=="address"){if(getToken(context)!="abs"&&getToken(context)!="rel"){return langError(context,"Type of addressing incorrect (abs or rel)")}campos[camposInsertados]["address_type"]=getToken(context);nextToken(context)}if(isToken(context,",")){nextToken(context)}camposInsertados++}instruccionAux.fields=campos;instruccionAux["native"]=false;if(isToken(context,"native")){instruccionAux["native"]=true;nextToken(context);if(isToken(context,",")){nextToken(context)}}if(true==instruccionAux["native"]){var ret=read_native(context)}else{var ret=read_microprg(context)}if(typeof ret.error!="undefined"){return ret}instruccionAux.microcode=ret.microprograma;instruccionAux.microcomments=ret.microcomments;context.instrucciones.push(instruccionAux);context.contadorMC=context.contadorMC+9;if(!isToken(context,"}")){return langError(context,"Expected '}' not found")}nextToken(context)}if(context.stackRegister==null){return langError(context,"Stack pointer register was not defined")}var found=false;for(var i=0;i<context.instrucciones.length;i++){if(context.instrucciones[i].name=="begin"){for(var j=0;j<context.instrucciones[i].microcode.length;j++){if((typeof context.etiquetas[j]!="undefined")&&(context.etiquetas[j]=="fetch")){found=true}}if(found===false){return langError(context,"label 'fetch' not defined")}}}if(found===false){return langError(context,"'begin' not found")}var first_co=0;var last_co=Math.pow(2,6)-1;var label="";for(var i=0;i<context.instrucciones.length;i++){if((context.instrucciones[i].name!="begin")&&(context.instrucciones[i].co=="111111")){for(var j=first_co;j<last_co;j++){label=j.toString(2);label="000000".substring(0,6-label.length)+label;if(typeof context.co_cop[label]=="undefined"){break}}if(j>=last_co){return langError(context,"There is not enough 'co' codes available for instructions")}context.instrucciones[i].co=label;context.co_cop[label]={};context.co_cop[label].signature=context.instrucciones[i].signature;context.co_cop[label].cop=null;first_co=j}}var labelsFounded=0;if(context.labelsNotFound.length>0){for(var i=0;i<context.labelsNotFound.length;i++){for(var j in context.etiquetas){if(context.etiquetas[j]==context.labelsNotFound[i].nombre){context.instrucciones[context.labelsNotFound[i].instruction].microcode[context.labelsNotFound[i].cycle].MADDR=j;labelsFounded++}}if(labelsFounded==0){return langError(context,"MADDR label not found : "+context.labelsNotFound[i].nombre)}labelsFounded=0}}var mk_native="";for(var i=0;i<context.instrucciones.length;i++){var ins=context.instrucciones[i];if(false==ins["native"]){continue}for(var j=0;j<ins.microcode.length;j++){if(typeof ins.microcode[j].NATIVE!="undefined"){mk_native+="context.instrucciones["+i+']["microcode"]['+j+']["NATIVE_JIT"] =  function() {\n\t var fields = simcore_native_get_fields("'+ins.signatureRaw+'");\n'+ins.microcode[j].NATIVE+"\n};\n "}}}eval(mk_native);var fico=0;var ficop=0;context.cocop_hash={};for(var fi in context.instrucciones){if(context.instrucciones[fi].name=="begin"){continue}fico=context.instrucciones[fi].co;if(typeof context.cocop_hash[fico]=="undefined"){context.cocop_hash[fico]={}}if(typeof context.instrucciones[fi].cop=="undefined"){context.cocop_hash[fico].withcop=false;context.cocop_hash[fico].i=context.instrucciones[fi]}else{ficop=context.instrucciones[fi].cop;context.cocop_hash[fico].withcop=true;context.cocop_hash[fico][ficop]=context.instrucciones[fi]}}var ret={};ret.error=null;ret.firmware=context.instrucciones;ret.labels_firm=context.etiquetas;ret.mp={};ret.seg={};ret.registers=context.registers;ret.pseudoInstructions=context.pseudoInstructions;ret.stackRegister=context.stackRegister;ret.cocop_hash=context.cocop_hash;return ret}function saveFirmware(l){var e="";for(var h=0;h<l.firmware.length;h++){e+=l.firmware[h].signatureRaw;e+=" {\n";if(typeof l.firmware[h].co!="undefined"){e+="\tco="+l.firmware[h].co+",\n"}if(typeof l.firmware[h].cop!="undefined"){e+="\tcop="+l.firmware[h].cop+",\n"}if(typeof l.firmware[h].nwords!="undefined"){e+="\tnwords="+l.firmware[h].nwords+",\n"}if(typeof l.firmware[h].fields!="undefined"){if(l.firmware[h].fields.length>0){for(var g=0;g<l.firmware[h].fields.length;g++){e+="\t"+l.firmware[h].fields[g].name+" = "+l.firmware[h].fields[g].type;e+="("+l.firmware[h].fields[g].startbit+","+l.firmware[h].fields[g].stopbit+")";if(l.firmware[h].fields[g].type=="address"){e+=l.firmware[h].fields[g].address_type}e+=",\n"}}}if(typeof l.firmware[h].microcode!="undefined"){var m=l.firmware[h]["mc-start"];if(l.firmware[h].name!="begin"){e+="\t{"}for(var g=0;g<l.firmware[h].microcode.length;g++){if(""!=l.firmware[h].microcomments[g]){e+="\n\t\t# "+l.firmware[h].microcomments[g]}if(typeof l.labels_firm[m]!="undefined"){e+="\n"+l.labels_firm[m]+":\t"}else{e+="\n\t\t"}e+="(";var n=0;for(var f in l.firmware[h].microcode[g]){if("MADDR"==f){var d=l.firmware[h].microcode[g][f];if(typeof l.labels_firm[d]=="undefined"){e+=f+"="+d.toString(2)+", "}else{e+=f+"="+l.labels_firm[d]+", "}continue}e+=f+"="+l.firmware[h].microcode[g][f].toString(2)+", ";n=1}if(n==1){e=e.substr(0,e.length-2)}e+="),";m++}e=e.substr(0,e.length-1);if(l.firmware[h].name!="begin"){e+="\n\t}"}}e+="\n}\n\n"}if((typeof l.registers!="undefined")&&(l.registers.length>0)){e+="registers\n{\n";for(var h=0;h<l.registers.length;h++){if(l.stackRegister==h){e+="\t"+h+"="+l.registers[h]+" (stack_pointer),\n"}else{e+="\t"+h+"="+l.registers[h]+",\n"}}e=e.substr(0,e.length-2);e+="\n}\n"}if(l.pseudoInstructions.length!==0){e+="\npseudoinstructions\n{";for(var c=0;c<l.pseudoInstructions.length;c++){e+="\n\t"+l.pseudoInstructions[c].initial.signature.replace(","," ")+"\n\t{\n";var a=l.pseudoInstructions[c].finish.signature.split("\n");for(var o=0;o<a.length;o++){e+="\t\t"+a[o].trim()+" ;\n"}e+="\t}\n"}e+="}\n"}return e}function decode_instruction(c,e,f){var a={oinstruction:null,op_code:0,cop_code:0};var d=f.toString(2);d="00000000000000000000000000000000".substring(0,32-d.length)+d;var g=d.substr(e.default_eltos.co.begin,e.default_eltos.co.length);a.op_code=parseInt(g,2);var h=d.substr(e.default_eltos.cop.begin,e.default_eltos.cop.length);a.cop_code=parseInt(h,2);if(false==c.cocop_hash[g].withcop){a.oinstruction=c.cocop_hash[g].i}else{a.oinstruction=c.cocop_hash[g][h]}return a}function decode_ram(){var g="\n";var d=simhw_sim_ctrlStates_get().ir;var e=simhw_internalState("FIRMWARE");var c=simhw_internalState("MP");for(var a in c){var f=c[a].toString(2);f="00000000000000000000000000000000".substring(0,32-f.length)+f;g+="0x"+parseInt(a).toString(16)+":"+decode_instruction(e,d,f).oinstruction+"\n"}return g}BYTE_LENGTH=8;WORD_BYTES=4;WORD_LENGTH=WORD_BYTES*BYTE_LENGTH;directives={};directives[".kdata"]={name:".kdata",kindof:"segment",size:0};directives[".ktext"]={name:".ktext",kindof:"segment",size:0};directives[".data"]={name:".data",kindof:"segment",size:0};directives[".text"]={name:".text",kindof:"segment",size:0};directives[".byte"]={name:".byte",kindof:"datatype",size:1};directives[".half"]={name:".half",kindof:"datatype",size:2};directives[".word"]={name:".word",kindof:"datatype",size:4};directives[".space"]={name:".space",kindof:"datatype",size:1};directives[".ascii"]={name:".ascii",kindof:"datatype",size:1};directives[".asciiz"]={name:".asciiz",kindof:"datatype",size:1};directives[".align"]={name:".align",kindof:"datatype",size:0};sim_segments={".kdata":{name:".kdata",begin:0,end:255,color:"#FF99CC",kindof:"data"},".ktext":{name:".ktext",begin:256,end:4095,color:"#A9D0F5",kindof:"text"},".data":{name:".data",begin:4096,end:32767,color:"#FACC2E",kindof:"data"},".text":{name:".text",begin:32768,end:131071,color:"#BEF781",kindof:"text"},".stack":{name:".stack",begin:131071,end:1048575,color:"#F1F2A3",kindof:"stack"}};function get_datatype_size(a){if(typeof directives[a]==="undefined"){console.log("data type: "+a+" is not defined!!!\n");return 0}return directives[a].size}function isTokenKindOf(c,a){if(typeof directives[c]==="undefined"){return false}return(directives[c].kindof==a)}function is_directive(a){return(typeof directives[a]!=="undefined")}function is_directive_segment(a){return isTokenKindOf(a,"segment")}function is_directive_datatype(a){return isTokenKindOf(a,"datatype")}function isDecimal(c){if(c.length>1&&c[0]=="0"){return false}if(!isNaN(parseFloat(c))&&isFinite(c)){var a=parseInt(c);if(typeof c==="string"&&c.includes(".")){alert("Truncating conversion has occurred: "+c+" became "+a)}return a}return false}function isOctal(d){if(d.substring(0,1)=="0"){var c=d.substring(1).replace(/\b0+/g,"");var a=parseInt(c,8);return(a.toString(8)===c)?a:false}return false}function isHex(d){if(d.substring(0,2).toLowerCase()=="0x"){var c=d.substring(2).toLowerCase().replace(/\b0+/g,"");if(c==""){c="0"}var a=parseInt(c,16);return(a.toString(16)===c)?a:false}return false}function isChar(d){var c=treatControlSequences(d);if(true==c.error){return false}var a=c.string;if(a[0]=="'"&&a[2]=="'"){return a.charCodeAt(1)}return false}function decimal2binary(d,c){var a=d.toString(2);if(a.length>WORD_LENGTH){return[a,c-a.length]}a=(d>>>0).toString(2);if(d>=0){return[a,c-a.length]}a="1"+a.replace(/^[1]+/g,"");if(a.length>c){return[a,c-a.length]}a="1".repeat(c-a.length)+a;return[a,c-a.length]}function isValidTag(a){if(!(isDecimal(a[0])===false)){return false}var c=/[^a-z,_\d]/i;return !(c.test(a))}function sum_array(c){return c.reduce(function(e,d){return e+d},0)}function get_candidate(g,a){var e=false;var f={};var h={};for(c=0;c<g.length;c++){if(g[c]){f[c]=a[c].nwords;h[a[c].signature]=0}}if(Object.keys(h).length===1){var d=false;for(var c in f){if(d==false){d=f[c];e=c}else{if(d==f[c]){e=false}else{if(d>f[c]){d=f[c];e=c}}}}}return e?parseInt(e):e}function reset_assembly(a){return"0".repeat(WORD_LENGTH*a)}function assembly_replacement(g,d,e,c,a){var f=g.substring(0,g.length-e+a);g=f+d+g.substring(g.length-c);return g}function assembly_co_cop(e,c,d){var a=simhw_sim_ctrlStates_get();if(c!==false){e=assembly_replacement(e,c,WORD_LENGTH,WORD_LENGTH-6,0)}if(d!==false){e=assembly_replacement(e,d,a.ir.default_eltos.cop.length,0,0)}return e}function writememory_and_reset(c,d,a){if(d.byteWord>=WORD_BYTES){c["0x"+d.seg_ptr.toString(16)]=d.machineCode;d.seg_ptr=d.seg_ptr+WORD_BYTES;d.byteWord=0;d.machineCode=reset_assembly(a)}}function is_end_of_file(a){return""===getToken(a)&&a.t>=a.text.length}function treatControlSequences(a){var c={};c.string="";c.error=false;for(var d=0;d<a.length;d++){if("\\"!=a[d]){c.string=c.string+a[d];continue}d++;switch(a[d]){case"b":c.string=c.string+"\b";break;case"f":c.string=c.string+"\f";break;case"n":c.string=c.string+"\n";break;case"r":c.string=ret_string+"\r";break;case"t":c.string=c.string+"\t";break;case"v":c.string=c.string+"\v";break;case"a":c.string=c.string+String.fromCharCode(7);break;case"'":c.string=c.string+"'";break;case'"':c.string=c.string+'"';break;case"0":c.string=c.string+"\0";break;default:c.string="Unknown escape char '\\"+a[d]+"'";c.error=true;return c}}return c}function read_data(c,p,l){var k=getToken(c);var g={};g.byteWord=0;g.machineCode=reset_assembly(1);g.seg_ptr=l.seg[k].begin;nextToken(c);while(!is_directive_segment(getToken(c))&&!is_end_of_file(c)){var q="";while(!is_directive_datatype(getToken(c))&&!is_end_of_file(c)){q=getToken(c);if("TAG"!=getTokenType(c)){return langError(c,"Expected tag or directive but found '"+q+"' instead")}var t=q.substring(0,q.length-1);if(!isValidTag(t)){return langError(c,"A tag must follow an alphanumeric format (starting with a letter or underscore) but found '"+t+"' instead")}if(c.firmware[t]){return langError(c,"A tag can not have the same name as an instruction ("+t+")")}if(l.labels2[t]){return langError(c,"Repeated tag: '"+t+"'")}l.labels2[t]="0x"+(g.seg_ptr+g.byteWord).toString(16);nextToken(c)}if(is_end_of_file(c)){break}var d=getToken(c);if((".word"==d)||(".half"==d)||(".byte"==d)){nextToken(c);var f=getToken(c);while(!is_directive(getToken(c))&&!is_end_of_file(c)){var e;var m=false;if((e=isOctal(f))!==false){}else{if((e=isHex(f))!==false){}else{if((e=isDecimal(f))!==false){}else{if((e=isChar(f))!==false){}else{if(".word"==d){if(!isValidTag(f)){return langError(c,"A tag must follow an alphanumeric format (starting with a letter or underscore) but found '"+f+"' instead")}if(c.firmware[f]){return langError(c,"A tag can not have the same name as an instruction ("+f+")")}e=0;m=true}else{return langError(c,"Expected value for numeric datatype but found '"+f+"' instead")}}}}}var s=get_datatype_size(d);var o=decimal2binary(e,s*BYTE_LENGTH);num_bits=o[0];free_space=o[1];if(free_space<0){return langError(c,"Expected value that fits in a '"+d+"' ("+s*BYTE_LENGTH+" bits), but inserted '"+f+"' ("+num_bits.length+" bits) instead")}writememory_and_reset(l.mp,g,1);while(((g.seg_ptr+g.byteWord)%s)!=0){g.byteWord++;writememory_and_reset(l.mp,g,1)}if(""!=q){l.labels2[q.substring(0,q.length-1)]="0x"+(g.seg_ptr+g.byteWord).toString(16);q=""}if(m){l.labels["0x"+g.seg_ptr.toString(16)]={name:f,addr:g.seg_ptr,startbit:31,stopbit:0,rel:undefined,nwords:1,labelContext:getLabelContext(c)}}g.machineCode=assembly_replacement(g.machineCode,num_bits,BYTE_LENGTH*(s+g.byteWord),BYTE_LENGTH*g.byteWord,free_space);g.byteWord+=s;nextToken(c);if(","==getToken(c)){nextToken(c)}if(is_directive(getToken(c))||("TAG"==getTokenType(c))||"."==getToken(c)[0]){break}f=getToken(c)}}else{if(".space"==d){nextToken(c);var f=getToken(c);if(!isDecimal(f)){return langError(c,"Expected number of bytes to reserve in .space but found '"+f+"' as number")}if(f<0){return langError(c,"Expected positive number but found '"+f+"' as positive number")}for(i=0;i<f;i++){writememory_and_reset(l.mp,g,1);g.byteWord++}nextToken(c)}else{if(".align"==d){nextToken(c);var f=getToken(c);if(!isDecimal(f)&&f>=0){return langError(c,"Expected the align parameter as positive number but found '"+f+"'. Remember that number is the power of two for alignment, see MIPS documentation..")}writememory_and_reset(l.mp,g,1);var h=Math.pow(2,parseInt(f));switch(h){case 1:break;case 2:if(g.byteWord&1==1){g.byteWord++}break;default:while(true){writememory_and_reset(l.mp,g,1);if(g.seg_ptr%h==0&&g.byteWord==0){break}g.byteWord++}}nextToken(c)}else{if(".ascii"==d||".asciiz"==d){nextToken(c);var f=getToken(c);var n=treatControlSequences(f);if(true==n.error){return langError(c,n.string)}f=n.string;while(!is_directive(getToken(c))&&!is_end_of_file(c)){writememory_and_reset(l.mp,g,1);if(""==f){return langError(c,"String is not closed (forgot to end it with quotation marks)")}if("STRING"!=getTokenType(c)){return langError(c,"Expected string between quotation marks but found '"+f+"' instead")}for(i=0;i<f.length;i++){writememory_and_reset(l.mp,g,1);if(f[i]=='"'){continue}num_bits=f.charCodeAt(i).toString(2);g.machineCode=assembly_replacement(g.machineCode,num_bits,BYTE_LENGTH*(1+g.byteWord),BYTE_LENGTH*g.byteWord,BYTE_LENGTH-num_bits.length);g.byteWord++}if(".asciiz"==d){writememory_and_reset(l.mp,g,1);num_bits="\0".charCodeAt(0).toString(2);g.machineCode=assembly_replacement(g.machineCode,num_bits,BYTE_LENGTH*(1+g.byteWord),BYTE_LENGTH*g.byteWord,BYTE_LENGTH-num_bits.length);g.byteWord++}nextToken(c);if(","==getToken(c)){nextToken(c)}if(is_directive(getToken(c))||("TAG"==getTokenType(c))||"."==getToken(c)[0]){break}f=getToken(c);n=treatControlSequences(f);if(true==n.error){return langError(c,n.string)}f=n.string}}else{return langError(c,"Unexpected datatype name '"+d)}}}}}if(g.byteWord>0){l.mp["0x"+g.seg_ptr.toString(16)]=g.machineCode;g.seg_ptr=g.seg_ptr+WORD_BYTES}l.seg[k].end=g.seg_ptr}function read_text(S,c,D){var G=getToken(S);var g=D.seg[G].begin;var C=S.firmware;var x=S.pseudoInstructions;var u=false;var e=-1;var R={};for(i=0;i<c.registers.length;i++){var m="$"+i;R[m]=i;R[c.registers[i]]=R[m]}nextToken(S);while(!is_directive_segment(getToken(S))&&!is_end_of_file(S)){while(!u&&typeof C[getToken(S)]==="undefined"&&!is_end_of_file(S)){var d=getToken(S);if("TAG"!=getTokenType(S)){return langError(S,"Expected tag or instruction but found '"+d+"' instead")}var M=d.substring(0,d.length-1);if(!isValidTag(M)){return langError(S,"A tag must follow an alphanumeric format (starting with a letter or underscore) but found '"+M+"' instead")}if(C[M]){return langError(S,"A tag can not have the same name as an instruction ("+M+")")}if(D.labels2[M]){return langError(S,"Repeated tag: '"+M+"'")}D.labels2[M]="0x"+g.toString(16);nextToken(S)}if(is_end_of_file(S)){break}if(!u){var w=getToken(S);var l=[]}else{var w=l[N][e++]}var O=[];var a=[];var k=[];var Q=0;var L=[];for(i=0;i<C[w].length;i++){O[i]=C[w][i].signature.split(",");a[i]=C[w][i].signatureUser.split(" ");O[i].shift();a[i].shift();k[i]=1;L[i]=[];Q=Math.max(Q,O[i].length);if(x[w]){l[i]=C[w][i].finish.replace(/ ,/g,"").replace(/num/g,"inm").split(" ");l[i].pop();u=true;var P=0;var t={}}}var K=[];K[0]=w;for(i=0;i<Q;i++){if(e==-1){nextToken(S);if(","==getToken(S)){nextToken(S)}var J=getToken(S)}else{var F=l[N][e++];if(t[F]){var J=t[F]}else{var J=F}}var H;if("TAG"!=getTokenType(S)&&!C[J]){K[i+1]=J}for(j=0;j<k.length;j++){if(k[j]==0){continue}if(i>=O[j].length){if("TAG"!=getTokenType(S)&&!C[J]){k[j]=0}continue}var h=C[w][j].fields[i];var f=h.startbit-h.stopbit+1;var v=false;var o=false;switch(h.type){case"address":case"inm":if(u&&"sel"==J){e++;var z=l[N][e++];var p=l[N][e++];var J=t[l[N][e++]];e++;o=true}if((H=isOctal(J))!==false){}else{if((H=isHex(J))!==false){}else{if((H=isDecimal(J))!==false){}else{if((H=isChar(J))!==false){}else{if((J[0]=="'")){var A="Unexpected inmediate value, found: '"+J+"' instead";k[j]=0;break}if(!isValidTag(J)){var A="A tag must follow an alphanumeric format (starting with a letter or underscore) but found '"+J+"' instead";k[j]=0;break}if(C[J]){var A="A tag can not have the same name as an instruction ("+J+")";k[j]=0;break}v=true}}}}if(o){E=decimal2binary(H,WORD_LENGTH);if(E[1]<0){return langError(S,"'"+J+"' is bigger than "+WORD_LENGTH+" bits")}H="0".repeat(E[1])+E[0];H=H.substring(WORD_LENGTH-z-1,WORD_LENGTH-p);H=parseInt(H,2);K[i+1]="0x"+H.toString(16)}if(!v){var E=decimal2binary(H,f);if(h.type=="address"&&"rel"==h.address_type){E=decimal2binary(H-g-WORD_BYTES,f)}}break;case"reg":var m=false;if("("==J){if("(reg)"!=O[j][i]){var A="Expected register but found register beween parenthesis";k[j]=0;break}if(e==-1){nextToken(S);J=getToken(S)}else{J=t[l[N][e++]]}m=true}else{if("(reg)"==O[j][i]){var A="Expected register between parenthesis but found '"+J+"' instead";k[j]=0;break}}if(typeof R[J]==="undefined"){var A="Expected register ($1, ...) but found '"+J+"' instead";k[j]=0;break}if(m){K[i+1]="("+J+")";if(e==-1){nextToken(S);m=getToken(S)}else{m=l[N][e++]}if(")"!=m){var A="String without end parenthesis ')'";k[j]=0;break}}H=isDecimal(R[J]);var E=decimal2binary(H,f);break;default:return langError(S,"An unknown error ocurred (1)")}if(k[j]==1&&!v){if(E[1]<0){if(h.type=="address"&&"rel"==h.address_type){A="Relative value ("+(H-g-WORD_BYTES)+" in decimal) needs "+E[0].length+" bits in binary but there is space for only "+f+" bits"}else{var A="'"+J+"' needs "+E[0].length+" bits in binary but there is space for only "+f+" bits"}k[j]=0}}if(k[j]==1&&(!(u&&e==-1))){L[j][i]={num_bits:(v?false:E[0]),free_space:(v?false:E[1]),startbit:h.startbit,stopbit:h.stopbit,rel:(v?h.address_type:false),islabel:v,field_name:J}}}if(sum_array(k)==0){break}if("TAG"==getTokenType(S)||C[J]){break}}var N;for(i=0;i<k.length;i++){if(k[i]==1){N=i;break}}var B="";for(i=0;i<C[w].length;i++){if(i>0&&i<C[w].length-1){B+=", "}if(i>0&&i==C[w].length-1){B+=" or "}B+="'"+C[w][i].signatureUser+"'"}var y=sum_array(k);if(y==0){if(k.length===1){return langError(S,A+". Remember that the instruction format has been defined as: "+B)}return langError(S,"Instruction and fields don't match with microprogram. Remember that the instruction formats have been defined as: "+B+". Please check the microcode. Probably you forgot to add a field, a number does not fit in its space, or you just used a wrong instruction")}if(y>1){N=get_candidate(k,C[w]);if(N===false){return langError(S,"Instruction and fields match with more than one microprogram. Please check the microcode. Currently, the instruction format can be: "+B)}}if(u){if(e==-1){var n="";for(i=0;i<K.length;i++){n=n+K[i]+" "}n=n.substring(0,n.length-1);for(i=0;i<O[N].length;i++){t[O[N][i]]=K[i+1]}e++;continue}P++;if(P>1){n="&nbsp;"}if(l[N][e]=="\n"){e++}}var q=reset_assembly(C[w][N].nwords);q=assembly_co_cop(q,C[w][N].co,C[w][N].cop);for(i=0;i<L[N].length;i++){if(L[N][i].islabel){D.labels["0x"+g.toString(16)]={name:L[N][i].field_name,addr:g,startbit:L[N][i].startbit,stopbit:L[N][i].stopbit,rel:L[N][i].rel,nwords:C[w][N].nwords,labelContext:getLabelContext(S)}}else{q=assembly_replacement(q,L[N][i].num_bits,L[N][i].startbit-(-1),L[N][i].stopbit,L[N][i].free_space)}}s_def=K[0];for(i=0,j=1;i<a[N].length;i++,j++){switch(a[N][i]){case"address":case"inm":case"reg":case"(reg)":s_def=s_def+" "+K[j];break;default:s_def=s_def+" "+K[j]+K[j+1];j++}}if(!u){var n=s_def}var I=c.cocop_hash[C[w][N].co];if(I.withcop){I=I[C[w][N].cop]}else{I=I.i}for(i=C[w][N].nwords-1;i>=0;i--){if(i<C[w][N].nwords-1){s_def=""}D.assembly["0x"+g.toString(16)]={breakpoint:false,binary:q.substring(i*WORD_LENGTH,(i+1)*WORD_LENGTH),source:s_def,source_original:n,firm_reference:I};D.mp["0x"+g.toString(16)]=q.substring(i*WORD_LENGTH,(i+1)*WORD_LENGTH);g=g+WORD_BYTES}if(!u&&Q==O[N].length){nextToken(S)}if(u&&e==l[N].length){e=-1;P=0;u=false;nextToken(S)}if(S.t>=S.text.length){break}}D.seg[G].end=g}function simlang_compile(q,s){var d={};d.line=1;d.error=null;d.i=0;d.contadorMC=0;d.etiquetas={};d.labelsNotFound=[];d.instrucciones=[];d.co_cop={};d.registers=[];d.text=q;d.tokens=[];d.token_types=[];d.t=0;d.newlines=[];d.pseudoInstructions=[];d.stackRegister=null;d.firmware={};d.pseudoInstructions={};d.comments=[];for(i=0;i<s.firmware.length;i++){var e=s.firmware[i];if(typeof d.firmware[e.name]==="undefined"){d.firmware[e.name]=[]}d.firmware[e.name].push({name:e.name,nwords:parseInt(e.nwords),co:(typeof e.co!=="undefined"?e.co:false),cop:(typeof e.cop!=="undefined"?e.cop:false),fields:(typeof e.fields!=="undefined"?e.fields:false),signature:e.signature,signatureUser:(typeof e.signatureUser!=="undefined"?e.signatureUser:e.name),isPseudoinstruction:false})}for(i=0;i<s.pseudoInstructions.length;i++){var g=s.pseudoInstructions[i].initial;var n=s.pseudoInstructions[i].finish;if(typeof d.pseudoInstructions[g.name]==="undefined"){d.pseudoInstructions[g.name]=0;d.firmware[g.name]=[]}d.pseudoInstructions[g.name]++;d.firmware[g.name].push({name:g.name,fields:(typeof g.fields!=="undefined"?g.fields:false),signature:g.signature,signatureUser:g.signature.replace(/,/g," "),finish:n.signature,isPseudoinstruction:true})}var h={};h.seg=sim_segments;h.mp={};h.labels={};h.labels2={};h.assembly={};data_found=false;text_found=false;nextToken(d);while(!is_end_of_file(d)){var f=getToken(d);if(typeof h.seg[f]==="undefined"){return langError(d,"Expected .data/.text/... segment but found '"+f+"' as segment")}if("data"==h.seg[f].kindof){read_data(d,s,h);data_found=true}if("text"==h.seg[f].kindof){read_text(d,s,h);text_found=true}if(d.error!=null){h.error=d.error;return h}}for(i in h.labels){var o=h.labels2[h.labels[i].name];if(typeof o==="undefined"){setLabelContext(d,h.labels[i].labelContext);return langError(d,"Label '"+h.labels[i].name+"' used but not defined in the assembly code")}var m="";var c=h.labels[i].addr;for(j=0;j<h.labels[i].nwords;j++){m=h.mp["0x"+c.toString(16)]+m;c+=WORD_BYTES}var t=h.labels[i].startbit-h.labels[i].stopbit+1;var p;if((p=isHex(o))!==false){var l=decimal2binary(p,t);num_bits=l[0];free_space=l[1];var k="'"+h.labels[i].name+"' needs "+num_bits.length+" bits in binary but there is space for only "+t+" bits";if("rel"==h.labels[i].rel){var l=decimal2binary(p-h.labels[i].addr-WORD_BYTES,t);num_bits=l[0];free_space=l[1];k="Relative value ("+(p-h.labels[i].addr-WORD_BYTES)+" in decimal) needs "+num_bits.length+" bits in binary but there is space for only "+t+" bits"}}else{return langError(d,"Unexpected error (2)")}if(free_space<0){setLabelContext(d,h.labels[i].labelContext);return langError(d,k)}m=assembly_replacement(m,num_bits,h.labels[i].startbit-(-1),h.labels[i].stopbit,free_space);c=h.labels[i].addr;for(j=h.labels[i].nwords-1;j>=0;j--){h.mp["0x"+c.toString(16)]=m.substring(j*WORD_LENGTH,(j+1)*WORD_LENGTH);c+=WORD_BYTES}}if(text_found){if((typeof h.labels2.main==="undefined")&&(typeof h.labels2.kmain==="undefined")){return langError(d,"Tags 'main' or 'kmain' are not defined in the text segment(s). It is compulsory to define at least one of those tags in order to execute a program")}}return h}function simlang_native_adapt_replaceAssert(g){var d="";var c="";c=/assert\((.*)\)/;if(g.search(c)!=-1){var a=c.exec(g);var f=a[1].split(";");var e=f[1].trim();d="if ("+f[0]+") {\n    simlang_set_screen_content("+e+") ;\n}\n";c=/assert\((.*)\)/g;g=g.replace(c,d)}return g}function simlang_native_adapt_replaceCheckStackLimit(g){var d="";var c="";c=/check_stack_limit\((.*)\)/;if(g.search(c)!=-1){var a=c.exec(g);var f=a[1].split(";");var e=f[2].trim();d="if (f_"+e+" == simhw_sim_states().sp.name) {\n    if ("+e+' < sim_segments.data.begin) {\n        simlang_set_screen_content("Stack Overflow") ;\n    }\n    if ('+e+' > sim_segments.data.end) {\n        simlang_set_screen_content("Stack Underflow") ;\n    }\n}\n';c=/check_stack_limit\((.*)\)/g;g=g.replace(c,d)}return g}function simlang_native_adapt_replaceSyscall(l){var h="";var e="";var a="print_char|print_int|print_float|print_double|print_string|read_char|read_int|read_float|read_double|read_string|sbrk|exit";var d=new RegExp("("+a+")\\(([^)]*)\\)","g");var c=d.exec(l);while(c!==null){var g=c[1].trim();var k=c[2].trim().split(",");switch(g){case"print_char":h="// "+g+" \nvar tmp1 = 0x000000FF & "+k[0]+" ;\nsimlang_set_screen_content(tmp1.toString()) ;\n";break;case"print_int":h="// "+g+" \nsimlang_set_screen_content("+k[0]+".toString()) ;\n";break;case"print_float":h="// "+g+" \nvar tmp1 = hex2float("+k[0]+") ;\nsimlang_set_screen_content(tmp1.toString()) ;\n";break;case"print_double":h="// "+g+" \nvar tmp1 = hex2float("+k[0]+") ;\nsimlang_set_screen_content(tmp1.toString()) ;\n";break;case"print_string":h="// "+g+' \nvar tmp1 = "" ;\nvar tmp2 = simcore_native_get_value("MEMORY", '+k[0]+") ;\nfor (var k="+k[0]+'+1; (tmp2 !== 0) && (k<8*1024); k++) {\n     tmp1 += tmp2.toString() ;\n     tmp2  = simcore_native_get_value("MEMORY", k) ;\n} ;\nsimlang_set_screen_content(tmp1) ;\n';break;case"read_char":h="// "+g+" \nvar tmp1 = simlang_get_screen_content() ;\nvar "+k[0]+" = 0x000000FF & parseInt(tmp1) ;\n";break;case"read_int":h="// "+g+" \nvar tmp1 = simlang_get_screen_content() ;\nvar "+k[0]+" = parseInt(tmp1) ;\n";break;case"read_float":h="// "+g+" \nvar tmp1 = simlang_get_screen_content() ;\nvar "+k[0]+" = parseFloat(tmp1) ;\n";break;case"read_double":h="// "+g+" \nvar tmp1 = simlang_get_screen_content() ;\nvar "+k[0]+" = parseFloat(tmp1) ;\n";break;case"read_string":h="// "+g+" \nvar tmp1 = simlang_get_screen_content() ;\nfor (var k=0; k<"+k[1]+'; k++) {\n     simcore_native_set_value("MEMORY", '+k[0]+"+k, tmp1[k]) ;\n} ;\n";break;case"sbrk":h="// "+g+" \n// TODO: _sbrk_("+k[0]+", "+k[1]+");\n";break;case"exit":h="// "+g+' \n// exit by setting P.C. register outside text segment\nvar pc_name = simhw_sim_states().pc.state ;\nsimcore_native_set_value("CPU", pc_name, 0x00000000) ;\n';break;default:h="// "+g+" \n// unknown syscall\n";break}e=new RegExp(g+"\\(([^)]*)\\)","g");l=l.replace(e,h);c=d.exec(l)}return l}function simlang_native_adapt_replaceMemoryAccess(g,e,c){var d=new RegExp("MP."+e+".\\(([^\\)]*)\\)","g");if(g.search(d)!=-1){var a=d.exec(g);var f=a[1];g=g.replace(d,"value");g='value = simcore_native_get_value("MEMORY", '+f+") ;\nvalue = value & "+c+";\n"+g+'simcore_native_set_value("MEMORY", '+f+", value) ;\n"}return g}function simlang_native_adapt_provideRegister(f,a,e,d){var c=new RegExp(a,"g");if(f.search(c)!=-1){f="var "+a+" = simcore_native_get_value('"+e+"', "+d+") ;\n"+f+"\nsimcore_native_set_value('"+e+"', "+d+", "+a+") ;\n"}return f}function simlang_native_adapt_providePC(c){var a=/PC/g;if(c.search(a)!=-1){c="var pc_name = simhw_sim_states().pc.state ;\nvar PC = simcore_native_get_value('CPU', pc_name) ;\n"+c+"simcore_native_set_value('CPU', pc_name, PC) ;\n"}return c}function simlang_native_adapt_instructionDefinition(c){var a=c.split(";");if((a.length===1)&&(!c.trim().startsWith("if"))){c=c+";\n"}c=simlang_native_adapt_replaceAssert(c);c=simlang_native_adapt_replaceCheckStackLimit(c);c=simlang_native_adapt_replaceSyscall(c);c=simlang_native_adapt_provideRegister(c,"HI","CPU","'REG_RT2'");c=simlang_native_adapt_provideRegister(c,"LO","CPU","'REG_RT1'");c=simlang_native_adapt_provideRegister(c,"ra","BR","31");c=simlang_native_adapt_providePC(c);c=simlang_native_adapt_replaceMemoryAccess(c,"w","0xFFFFFFFF");c=simlang_native_adapt_replaceMemoryAccess(c,"h","0x0000FFFF");c=simlang_native_adapt_replaceMemoryAccess(c,"b","0x000000FF");a=c.split("\n");a=a.map(function(d){return"\t\t"+d});c=a.join("\n");return c}function simlang_native_adapt_instructionSet(m){var c="";var d=[];var s=[];var t=[];var p="";var q="";var e="";for(var l=0;l<m.length;l++){io=m[l];p=io.signatureRaw.replace(/\$/g,"").replace(/\./g,"_");q=p.replace(/[\(\)]/g," ").split(" ");e=[];for(var f=0;f<q.length;f++){e[q[f]]=f}d=[];s=[];t=[];for(var h=0;h<io.fields.length;h++){if((io.fields[h].type==="co")||(io.fields[h].type==="cop")){continue}var f=e[io.fields[h].name];if(io.fields[h].type.endsWith("INT-Reg")){t[f]="\t"+io.fields[h].name+"=reg("+io.fields[h].startbit+","+io.fields[h].stopbit+"),\n";d[f]="\t\tvar f_"+io.fields[h].name+" = simcore_native_get_field_from_ir(fields, "+h+") ;\n\t\tvar   "+io.fields[h].name+" = simcore_native_get_value('BR', f_"+io.fields[h].name+") ;\n";s[f]="\t\tsimcore_native_set_value('BR', f_"+io.fields[h].name+", "+io.fields[h].name+");\n"}else{if(io.fields[h].type==="SFP-Reg"){t[f]="\t"+io.fields[h].name+"=reg("+io.fields[h].startbit+","+io.fields[h].stopbit+"),\n";d[f]="\t\tvar f_"+io.fields[h].name+" = simcore_native_get_field_from_ir(fields, "+h+") ;\n\t\tvar   "+io.fields[h].name+" = simcore_native_get_value('BR2', f_"+io.fields[h].name+") ;\n";s[f]="\t\tsimcore_native_set_value('BR2', f_"+io.fields[h].name+", "+io.fields[h].name+");\n"}else{if(io.fields[h].type==="DFP-Reg"){t[f]="\t"+io.fields[h].name+"=reg("+io.fields[h].startbit+","+io.fields[h].stopbit+"),\n";d[f]="\t\tvar f_"+io.fields[h].name+" = simcore_native_get_field_from_ir(fields, "+h+") ;\n\t\tvar   "+io.fields[h].name+"1 = simcore_native_get_value('BR2', f_"+io.fields[h].name+"+0) ;\n\t\tvar   "+io.fields[h].name+"2 = simcore_native_get_value('BR2', f_"+io.fields[h].name+"+1) ;\n\t\tvar   "+io.fields[h].name+" = ("+io.fields[h].name+"1) | ("+io.fields[h].name+"2 << 32);\n";s[f]="\t\t "+io.fields[h].name+"1 = (("+io.fields[h].name+" << 32) >> 32);\n\t\t "+io.fields[h].name+"2 = "+io.fields[h].name+"   >> 32;\n\t\tsimcore_native_set_value('BR2', f_"+io.fields[h].name+"+0, "+io.fields[h].name+"1);\n\t\tsimcore_native_set_value('BR2', f_"+io.fields[h].name+"+1, "+io.fields[h].name+"2);\n"}else{if(io.fields[h].type==="inm"){t[f]="\t"+io.fields[h].name+"=inm("+io.fields[h].startbit+","+io.fields[h].stopbit+"),\n";d[f]="\t\tvar "+io.fields[h].name+" = simcore_native_get_field_from_ir(fields, "+h+") ;\n\t"}}}}}var u="\tco="+io.co+",\n";if((io.cop!==null)&&(io.cop.trim()!=="")){u+="\tcop="+io.cop+",\n"}u="\tco=111111,\n";var a=simlang_native_adapt_instructionDefinition(io.definition);if(a.trim()!==""){a="\t\t// instruction specific code\n"+a+"\n"}var n=d.join("");if(n.trim()!==""){n="\t\t// get fields values...\n"+n+"\n"}var g=s.join("");if(g.trim()!==""){g="\t\t// set fields values...\n"+g+"\n"}c+="\n"+p+" {\n"+u+"\tnwords="+io.nwords+",\n"+t.join("")+"\tnative,\n\t{\n"+n+a+g+"\t\t// go fetch\n\t\tsimcore_native_go_maddr(0);\n\t}\n}\n"}return c}function simlang_native_beginMicrocode(){var a="";a+='\nbegin,\nnative\n{\n                var addr  = simcore_native_get_value("CPU", "REG_PC") ;\n                var value = simcore_native_get_value("MEMORY", addr) ;\n\n                simcore_native_set_value("CPU", "REG_IR", value) ;\n                simcore_native_set_value("CPU", "REG_PC", addr + 4) ;\n\n                simcore_native_deco() ;\n                simcore_native_go_opcode() ;\n}\n';return a}function simlang_native_endMicrocode(){var a="";a+="\n#\n# Register naming\n#\n\nregisters\n{\n        0=$zero,\n        1=$at,\n        2=$v0,\n        3=$v1,\n        4=$a0,\n        5=$a1,\n        6=$a2,\n        7=$a3,\n        8=$t0,\n        9=$t1,\n        10=$t2,\n        11=$t3,\n        12=$t4,\n        13=$t5,\n        14=$t6,\n        15=$t7,\n        16=$s0,\n        17=$s1,\n        18=$s2,\n        19=$s3,\n        20=$s4,\n        21=$s5,\n        22=$s6,\n        23=$s7,\n        24=$t8,\n        25=$t9,\n        26=$k0,\n        27=$k1,\n        28=$gp,\n        29=$sp (stack_pointer),\n        30=$fp,\n        31=$ra\n}\n\n";return a}function simlang_firm_is2native(a){if(a===null){return""}var c="";c+=simlang_native_beginMicrocode();c+=simlang_native_adapt_instructionSet(a.instructions);c+=simlang_native_endMicrocode();return c}var WSCFG={};WSCFG.version={value:"2.0.10",type:"string"};function get_cfg(a){return WSCFG[a].value}function set_cfg(c,a){WSCFG[c].value=a}function is_mobile(){if(typeof navigator==="undefined"){return false}return/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)}function reset_cfg(){WSCFG.color_data_active={value:"#0066FF",type:"string"};WSCFG.color_data_inactive={value:"rgb(0, 0, 0)",type:"string"};WSCFG.color_name_active={value:"red",type:"string"};WSCFG.color_name_inactive={value:"rgb(0, 0, 0)",type:"string"};WSCFG.size_active={value:1.25,type:"float"};WSCFG.size_inactive={value:0.02,type:"float"};WSCFG.is_byvalue={value:false,type:"boolean"};WSCFG.RF_display_format={value:"unsigned_16_fill",type:"string"};WSCFG.RF_display_name={value:"numerical",type:"string"};WSCFG.is_editable={value:true,type:"boolean"};WSCFG.DBG_delay={value:5,type:"int"};WSCFG.DBG_level={value:"microinstruction",type:"string"};WSCFG.DBG_limitins={value:10000,type:"int"};WSCFG.DBG_limitick={value:1000,type:"int"};WSCFG.ICON_theme={value:"classic",type:"string"};WSCFG.NOTIF_delay={value:1000,type:"int"};WSCFG.CPUCU_size={value:6,type:"int"};WSCFG.C1C2_size={value:8,type:"int"};WSCFG.SHOWCODE_label={value:true,type:"boolean"};WSCFG.SHOWCODE_addr={value:true,type:"boolean"};WSCFG.SHOWCODE_hex={value:true,type:"boolean"};WSCFG.SHOWCODE_ins={value:true,type:"boolean"};WSCFG.SHOWCODE_pins={value:true,type:"boolean"};WSCFG.is_interactive={value:true,type:"boolean"};WSCFG.is_quick_interactive={value:false,type:"boolean"};WSCFG.ws_idiom={value:"en",type:"string"};WSCFG.ws_mode={value:"newbie",type:"string"};WSCFG.use_voice={value:false,type:"boolean"};WSCFG.ws_skin_ui={value:"classic",type:"string"};WSCFG.ws_skin_user={value:"only_asm:of:only_frequent:of",type:"string"};WSCFG.editor_theme={value:"default",type:"string"};WSCFG.editor_mode={value:"default",type:"string"};WSCFG.verbal_verbose={value:"math",type:"string"};WSCFG.base_url={value:"https://wepsim.github.io/wepsim/ws_dist/wepsim-classic.html",type:"string"};if(is_mobile()){WSCFG.NOTIF_delay.value=2000;WSCFG.ICON_theme.value="cat1";WSCFG.CPUCU_size.value=6;WSCFG.C1C2_size.value=12}set_secondary_cfg()}function set_secondary_cfg(){cfg_show_eltos_delay=100;if(get_cfg("DBG_delay")<5){cfg_show_eltos_delay=350}cfg_show_rf_delay=100;if(get_cfg("DBG_delay")<5){cfg_show_rf_delay=350}cfg_show_main_memory_delay=150;if(get_cfg("DBG_delay")<5){cfg_show_main_memory_delay=450}cfg_show_control_memory_delay=120;if(get_cfg("DBG_delay")<5){cfg_show_control_memory_delay=360}cfg_show_asmdbg_pc_delay=50;if(get_cfg("DBG_delay")<3){cfg_show_asmdbg_pc_delay=150}cfg_show_dbg_ir_delay=100;if(get_cfg("DBG_delay")<5){cfg_show_dbg_ir_delay=300}cfg_show_rf_refresh_delay=30;if(get_cfg("DBG_delay")<5){cfg_show_rf_refresh_delay=120}}function save_cfg(){try{for(var c in WSCFG){localStorage.setItem("wepsim_"+c,get_cfg(c))}}catch(a){console.log("WepSIM can not save the configuration in a persistent way on this web browser, found error: \n"+a.message)}set_secondary_cfg()}function restore_cfg(){reset_cfg();if(localStorage===null){return}var a;for(var c in WSCFG){if(c==="version"){continue}a=get_cfg(c);set_cfg(c,localStorage.getItem("wepsim_"+c));if(WSCFG[c].type!="string"){set_cfg(c,JSON.parse(get_cfg(c)))}if(get_cfg(c)===null){set_cfg(c,a)}}set_secondary_cfg()}function update_cfg(c,a){WSCFG[c].value=a;simcore_record_append_new("Set configuration option "+c+" to "+a,'update_cfg("'+c+'",'+a+");\n");ga("send","event","config","config."+WSCFG.version.value,"config."+WSCFG.version.value+"."+c+"."+a);save_cfg()}var ws_records=[];var ws_last_played=0;var ws_last_toplay=0;var ws_last_time=0;var ws_last_timer=null;var ws_is_recording=false;var ws_is_playing=false;var ws_record_msg_name="";var ws_record_msg_obj=null;var ws_record_pb_name="";var ws_record_pb_obj=null;function simcore_record_pushElto(d,c,e){var a={timestamp:e,description:d,element:c};ws_records.push(a)}function simcore_record_showMsg(c,d){if(ws_record_msg_obj!==null){ws_record_msg_obj.html("<em>"+c+"/"+ws_records.length+"</em>&nbsp;"+d)}if(ws_record_pb_obj!==null){var a=(100*c)/ws_records.length;ws_record_pb_obj.css("width",a+"%").attr("aria-valuenow",a)}}function simcore_record_playAt(index_current,index_last){if(ws_is_playing===false){simcore_record_showMsg(ws_last_played,"Stopped by user.");return}ws_last_played=index_current;if(index_current>=index_last){simcore_record_showMsg(index_last,"Done.");return}if(ws_records[index_current].description==="_pending event_"){simcore_record_playAt(index_current+1,index_last);return}eval(ws_records[index_current].element);var index_next=index_current+1;simcore_record_showMsg(index_next,ws_records[index_current].description);var wait_time=500;if(index_next<index_last){wait_time=ws_records[index_next].timestamp}if(wait_time!==0){wait_time=(wait_time<500)?500:wait_time}ws_last_timer=setTimeout(function(){simcore_record_playAt(index_next,index_last)},wait_time)}function simcore_record_glowing(a){var c=$(a);if(c===null){return}c.addClass("btn-warning");setTimeout(function(){c.removeClass("btn-warning")},250)}function simcore_record_glowAdd(){var c=$(this);var a=c.attr("id");if(typeof a==="undefined"){return}if(ws_is_recording===false){return}c.one("click",simcore_record_glowAdd);simcore_record_resolve_pending("Click on UI element "+a,'simcore_record_glowing("#'+a+'");\n')}function simcore_record_init(a,c){ws_records=[];ws_last_played=0;ws_last_time=0;ws_is_playing=false;ws_is_recording=false;ws_record_msg_name=a;ws_record_msg_obj=$("#"+a);if(typeof ws_record_msg_obj.html==="undefined"){ws_record_msg_obj=null}ws_record_pb_name=c;ws_record_pb_obj=$("#"+c);if(typeof ws_record_pb_obj.html==="undefined"){ws_record_pb_obj=null}}function simcore_record_captureInit(){$(".nav-link").off("click",simcore_record_glowAdd);$(".btn-like").off("click",simcore_record_glowAdd);$(".btn").off("click",simcore_record_glowAdd);$(".nav-link").one("click",simcore_record_glowAdd);$(".btn-like").one("click",simcore_record_glowAdd);$(".btn").one("click",simcore_record_glowAdd)}function simcore_record_start(){ws_is_playing=false;ws_is_recording=true;ws_last_played=0;ws_last_time=Date.now();simcore_record_showMsg(ws_last_played,"Recording...")}function simcore_record_stop(){ws_is_playing=false;ws_is_recording=false;ws_last_played=0;ws_last_toplay=ws_records.length;simcore_record_showMsg(ws_last_played,"Stopped by user.")}function simcore_record_isRecording(){return ws_is_recording}function simcore_record_play(){if(ws_is_playing===true){clearTimeout(ws_last_timer);if(ws_last_played<ws_records.length){ws_last_played=ws_last_played+1}else{ws_last_played=0}}else{ws_last_toplay=ws_records.length}ws_is_playing=true;ws_is_recording=false;simcore_record_playAt(ws_last_played,ws_last_toplay)}function simcore_record_playInterval(c,a){if(ws_is_playing===true){clearTimeout(ws_last_timer);if(ws_last_played<a){ws_last_played=ws_last_played+1}else{ws_last_played=c}}else{ws_last_played=c}ws_last_toplay=a;ws_is_playing=true;ws_is_recording=false;simcore_record_playAt(ws_last_played,ws_last_toplay)}function simcore_record_pause(){ws_is_playing=!ws_is_playing;ws_is_recording=false;if(ws_is_playing===true){simcore_record_playAt(ws_last_played,ws_last_toplay)}}function simcore_record_isPlaying(){return ws_is_playing}function simcore_record_length(){return ws_records.length}function simcore_record_get(){return ws_records}function simcore_record_set(a){ws_last_played=0;ws_last_time=0;ws_is_playing=false;ws_is_recording=false;ws_records=a;simcore_record_showMsg(0,"Record restored.")}function simcore_record_reset(){ws_last_played=0;ws_last_toplay=0;ws_last_time=0;ws_is_playing=false;ws_is_recording=false;ws_records=[];simcore_record_showMsg(0,"Empty record")}function simcore_record_append_new(c,a){if(ws_is_recording===true){var d=Date.now()-ws_last_time;ws_last_time=Date.now();simcore_record_pushElto(c,a,d);simcore_record_showMsg(0,"Recording...")}}function simcore_record_append_pending(){if(ws_is_recording===true){var a=Date.now()-ws_last_time;ws_last_time=Date.now();simcore_record_pushElto("_pending event_",";",a)}}function simcore_record_resolve_pending(c,a){if(ws_is_recording===true){var d=ws_records.length;while(d>0){d--;if(ws_records[d].description==="_pending event_"){break}}if(d===0){simcore_record_setTimeBeforeNow(0);simcore_record_append_new(c,a);return}ws_records[d].description=c;ws_records[d].element=a;simcore_record_showMsg(0,"Recording...")}}function simcore_record_setTimeBeforeNow(a){ws_last_time=Date.now()-a}function simcore_record_addTimeAfterLast(a){ws_last_time=ws_last_time+a}function get_simware(){var a=simhw_internalState("FIRMWARE");if(typeof a.firmware=="undefined"){a.firmware=new Array()}if(typeof a.mp=="undefined"){a.mp=new Object()}if(typeof a.seg=="undefined"){a.seg=new Object()}if(typeof a.assembly=="undefined"){a.assembly=new Object()}if(typeof a.labels=="undefined"){a.labels=new Object()}if(typeof a.labels2=="undefined"){a.labels2=new Object()}if(typeof a.labels_firm=="undefined"){a.labels_firm=new Object()}if(typeof a.registers=="undefined"){a.registers=new Object()}if(typeof a.pseudoInstructions=="undefined"){a.pseudoInstructions=new Object()}if(typeof a.stackRegister=="undefined"){a.stackRegister=new Object()}if(typeof a.cihash=="undefined"){a.cihash=new Object()}if(typeof a.cocop_hash=="undefined"){a.cocop_hash=new Object()}return a}function set_simware(c){var a=simhw_internalState("FIRMWARE");if(typeof c.firmware!="undefined"){a.firmware=c.firmware}if(typeof c.mp!="undefined"){a.mp=c.mp}if(typeof c.registers!="undefined"){a.registers=c.registers}if(typeof c.assembly!="undefined"){a.assembly=c.assembly}if(typeof c.pseudoInstructions!="undefined"){a.pseudoInstructions=c.pseudoInstructions}if(typeof c.seg!="undefined"){a.seg=c.seg}if(typeof c.labels!="undefined"){a.labels=c.labels}if(typeof c.labels2!="undefined"){a.labels2=c.labels2}if(typeof c.labels_firm!="undefined"){a.labels_firm=c.labels_firm}if(typeof c.stackRegister!="undefined"){a.stackRegister=c.stackRegister}if(typeof c.cihash!="undefined"){a.cihash=c.cihash}if(typeof c.cocop_hash!="undefined"){a.cocop_hash=c.cocop_hash}}function array_includes(a,d){if(typeof a.includes!="undefined"){return a.includes(d)}for(var c=0;c<a.length;c++){if(a[c]==d){return true}}return false}function check_buses(h){var f=simhw_internalState("tri_state_names");if(f.indexOf(h)==-1){return}if(simhw_internalState_get("fire_visible","databus")==true){update_bus_visibility("databus_fire","hidden");simhw_internalState_set("fire_visible","databus",false)}if((simhw_sim_signal("TD").value!=0)&&(simhw_sim_signal("R").value!=0)){update_bus_visibility("databus_fire","visible");simhw_internalState_set("fire_visible","databus",true);simhw_sim_state("BUS_DB").value=4294967295}var a="";var e=0;var g="";var d=0;for(var c=0;c<f.length;c++){g=f[c];d=parseInt(get_value(simhw_sim_signal(g)));e+=d;if(d>0){a=g}if(e>1){break}}if(e>0){update_draw(simhw_sim_signal(a),1)}if(simhw_internalState_get("fire_visible","internalbus")==true){update_bus_visibility("internalbus_fire","hidden");simhw_internalState_set("fire_visible","internalbus",false)}if(e>1){update_bus_visibility("internalbus_fire","visible");simhw_internalState_set("fire_visible","internalbus",true);simhw_sim_state("BUS_IB").value=4294967295}}function fn_updateE_now(a){if("E"==simhw_sim_signal(a).type){update_state(a)}}function fn_updateE_future(a){if(jit_fire_ndep[a]<1){fn_updateE_now(a)}else{return new Promise(function(d,c){fn_updateE_now(a)})}}function fn_updateL_now(a){update_draw(simhw_sim_signal(a),simhw_sim_signal(a).value);if("L"==simhw_sim_signal(a).type){update_state(a)}}function fn_updateL_future(a){if(jit_fire_ndep[a]<1){fn_updateL_now(a)}else{return new Promise(function(d,c){fn_updateL_now(a)})}}function update_state(c){var a=0;switch(simhw_sim_signal(c).behavior.length){case 0:return;break;case 1:a=0;break;default:a=simhw_sim_signal(c).value;if(simhw_sim_signal(c).behavior.length<a){alert("ALERT: there are more signals values than behaviors defined!!!!\nkey: "+c+" and signal value: "+a);return}break}compute_signal_behavior(c,a)}function update_signal_firmware(g){var d=get_simware();var h=simhw_sim_ctrlStates_get().mpc.state;var a=get_value(simhw_sim_state(h));var f=-1;for(var c=0;c<d.firmware.length;c++){if(parseInt(d.firmware[c]["mc-start"])>a){break}f=c}if(-1==f){alert("A new 'unknown' instruction is inserted,\nplease edit it (co, nwords, etc.) in the firmware textarea.");var l=new Object();l.name="unknown";l.signature="unknown";l.signatureGlobal="unknown";l.co=0;l.nwords=0;l["mc-start"]=0;l.fields=new Array();l.microcode=new Array();l.microcomments=new Array();d.firmware.push(l);f=d.firmware.length-1}var e=a-parseInt(d.firmware[f]["mc-start"]);if(typeof d.firmware[f]["microcode"][e]=="undefined"){d.firmware[f]["microcode"][e]=new Object();d.firmware[f]["microcomments"][e]=""}d.firmware[f]["microcode"][e][g]=simhw_sim_signal(g).value;if(simhw_sim_signal(g).default_value==simhw_sim_signal(g).value){delete d.firmware[f]["microcode"][e][g]}var k=get_value(simhw_sim_state("REG_IR")).toString(2);k="00000000000000000000000000000000".substring(0,32-k.length)+k;show_memories_values()}function propage_signal_update(e){if(true===get_cfg("is_interactive")){if(simhw_sim_signal(e).value!=simhw_sim_signal(e).default_value){simhw_sim_state("REG_MICROINS").value[e]=simhw_sim_signal(e).value}else{delete (simhw_sim_state("REG_MICROINS").value[e])}var c=simhw_sim_ctrlStates_get().mpc.state;var d=get_value(simhw_sim_state(c));if(typeof simhw_internalState_get("MC",d)=="undefined"){simhw_internalState_set("MC",d,new Object());simhw_internalState_set("MC_dashboard",d,new Object())}simhw_internalState_get("MC",d)[e]=simhw_sim_signal(e).value;simhw_internalState_get("MC_dashboard",d)[e]={comment:"",breakpoint:false,state:false,notify:new Array()};update_signal_firmware(e);var a=get_simware();document.getElementById("inputFirmware").value=saveFirmware(a)}compute_behavior("FIRE "+e)}function update_memories(t){set_simware(t);var f=get_simware();simhw_internalState_reset("MC",{});simhw_internalState_reset("MC_dashboard",{});for(var q=0;q<f.firmware.length;q++){var s=false;var l=false;var n=new Array();var h=f.firmware[q]["microcode"].length;var p=f.firmware[q]["mc-start"];for(var o=0;o<h;o++){var c=f.firmware[q]["microcomments"][o];s=(c.trim().split("state:").length>1);l=(c.trim().split("break:").length>1);n=c.trim().split("notify:");for(var m=0;m<n.length;m++){n[m]=n[m].split("\n")[0]}simhw_internalState_set("MC",p,f.firmware[q]["microcode"][o]);simhw_internalState_set("MC_dashboard",p,{comment:c,state:s,breakpoint:l,notify:n});p++}}simhw_internalState_reset("ROM",{});for(var q=0;q<f.firmware.length;q++){if("begin"==f.firmware[q]["name"]){continue}var a=f.firmware[q]["mc-start"];var g=parseInt(f.firmware[q]["co"],2);var e=0;if(typeof f.firmware[q]["cop"]!="undefined"){e=parseInt(f.firmware[q]["cop"],2)}var d=64*g+e;simhw_internalState_set("ROM",d,a);f.cihash[d]=f.firmware[q]["signature"]}simhw_internalState_reset("MP",{});for(var w in f.mp){var u=parseInt(w);var v=parseInt(f.mp[w].replace(/ /g,""),2);simhw_internalState_set("MP",u,v)}simhw_internalState_reset("segments",{});for(var w in f.seg){simhw_internalState_set("segments",w,f.seg[w])}show_main_memory(simhw_internalState("MP"),0,true,true);show_control_memory(simhw_internalState("MC"),simhw_internalState("MC_dashboard"),0,true)}function hex2float(d){var a=(d&2147483648)?-1:1;var f=((d>>23)&255)-127;var c=1+((d&8388607)/8388608);var e=a*c*Math.pow(2,f);if(-127===f){if(1===c){e=(a===1)?"+0":"-0"}else{e=a*((d&8388607)/8388607)*Math.pow(2,-126)}}if(128===f){if(1===c){e=(a===1)?"+Inf":"-Inf"}else{e="NaN"}}return e}function hex2char8(a){var c=[];c[0]=String.fromCharCode((a&4278190080)>>24);c[1]=String.fromCharCode((a&16711680)>>16);c[2]=String.fromCharCode((a&65280)>>8);c[3]=String.fromCharCode((a&255)>>0);return c}function pack5(a){return"00000".substring(0,5-a.length)+a}function pack8(a){return"00000000".substring(0,8-a.length)+a}function pack32(a){return"00000000000000000000000000000000".substring(0,32-a.length)+a}function hex2bin(a){var c=a.toString(2);c=pack32(c);c=c.substring(0,4)+" "+c.substring(4,8)+" "+c.substring(8,12)+" "+c.substring(12,16)+"<br>"+c.substring(16,20)+" "+c.substring(20,24)+" "+c.substring(24,28)+" "+c.substring(28,32);return c}function value2string(d,c){var e="";var a=d.split("_");switch(a[0]){case"unsigned":e=c.toString(a[1]).toUpperCase();break;case"float":e=hex2float(c);break;default:e=c.toString()}if(a[2]==="fill"){e=pack8(e)}return e}function get_deco_from_pc(a){var d="0x"+a.toString(16);var c=simhw_internalState("FIRMWARE");if((typeof c.assembly==="undefined")||(typeof c.assembly[d]==="undefined")||(typeof c.assembly[d].source==="undefined")){return""}return c.assembly[d].source}function get_verbal_from_current_mpc(){var a="";var f="";var c=simhw_sim_ctrlStates_get().mpc.state;var e=get_value(simhw_sim_state(c));var g=simhw_internalState_get("MC",e);for(var d in g){if("MADDR"===d){f=f+"MADDR is "+g[d]+". ";continue}a=a+d+" ";f=f+compute_signal_verbals(d,g[d])}a=a.trim();if(a===""){a="<no active signal>"}if(f.trim()===""){f="<no actions>"}return"Activated signals are: "+a+". Associated actions are: "+f}function get_verbal_from_current_pc(){var a=simhw_sim_ctrlStates_get().pc.state;var e=get_value(simhw_sim_state(a));var c=parseInt(e)-4;var d=get_deco_from_pc(c);if(""==d.trim()){d="not jet defined"}return"Current instruction is: "+d+" and PC points to "+show_value(c)+". "}function ko_observable(a){if(typeof ko!="undefined"){return ko.observable(a).extend({rateLimit:cfg_show_rf_refresh_delay})}else{return a}}function ko_rebind_state(d,e){if(typeof ko=="undefined"){return}var c=simhw_sim_state(d);if(typeof c.value!="function"){c.value=ko.observable(c.value).extend({rateLimit:cfg_show_rf_refresh_delay})}var a=document.getElementById(e);ko.cleanNode(a);ko.applyBindings(simhw_sim_state(d),a)}function show_rf_values(){return simcore_action_ui("CPU",0,"show_rf_values")()}function show_rf_names(){return simcore_action_ui("CPU",0,"show_rf_names")()}function show_states(){return simcore_action_ui("CPU",0,"show_states")()}function get_screen_content(){return simcore_action_ui("SCREEN",0,"get_screen_content")()}function set_screen_content(a){simcore_action_ui("SCREEN",0,"set_screen_content")(a)}function get_keyboard_content(){return simcore_action_ui("KBD",0,"get_keyboard_content")()}function set_keyboard_content(a){simcore_action_ui("KBD",0,"set_keyboard_content")(a)}function show_main_memory(e,a,d,c){return simcore_action_ui("MEMORY",0,"show_main_memory")(e,a,d,c)}function show_control_memory(e,a,c,d){return simcore_action_ui("MEMORY",0,"show_control_memory")(e,a,c,d)}function show_memories_values(){var a=simhw_sim_ctrlStates_get().pc.state;var d=get_value(simhw_sim_state(a));show_main_memory(simhw_internalState("MP"),d,true,true);var c=simhw_sim_ctrlStates_get().mpc.state;var e=get_value(simhw_sim_state(c));show_control_memory(simhw_internalState("MC"),simhw_internalState("MC_dashboard"),e,true)}function update_draw(c,a){return simcore_action_ui("CPU",1,"update_draw")(c,a)}function update_bus_visibility(a,c){return simcore_action_ui("CPU",1,"update_bus_visibility")(a,c)}function refresh(){for(var a in simhw_sim_signals()){update_draw(simhw_sim_signals()[a],simhw_sim_signals()[a].value);check_buses(a)}show_dbg_ir(get_value(simhw_sim_state("REG_IR_DECO")))}function show_dbg_ir(a){return simcore_action_ui("MEMORY",0,"show_dbg_ir")(a)}function show_dbg_mpc(){return simcore_action_ui("MEMORY",0,"show_dbg_mpc")()}function show_asmdbg_pc(){return simcore_action_ui("MEMORY",0,"show_asmdbg_pc")()}function simcore_init(a){var c={};c.msg="";c.ok=true;if(a){restore_cfg()}else{reset_cfg()}return c}function simcore_init_hw(d){var c={};c.msg="";c.ok=true;var a=simhw_getIdByName(d);if(a<0){c.msg="ERROR: unknown hardware: "+d+".\n";c.ok=false;return c}simhw_setActive(a);var e=simcore_init_ui({});if(false===e.ok){c.msg=c.msg;c.ok=false;return c}return c}function simcore_init_ui(c){var e={};e.msg="";e.ok=true;var g=0;var f=simhw_sim_components();for(var a in f){f[a].details_ui=[];for(var d in f[a].details_name){f[a].details_ui[d]={};g=f[a].details_name[d];if(typeof c[g]!=="undefined"){f[a].details_ui[d]=c[g];f[a].details_ui[d].init()}}}return e}function simcore_action_ui(a,e,d){var c=simhw_sim_components();if(typeof c[a].details_ui[e][d]==="undefined"){return simcore_do_nothing_handler}return c[a].details_ui[e][d]}function simcore_init_eventlistener(c,l,e){var g=null;var a=[];var d=null;g=document.getElementById(c).contentDocument;if(null==g){console.log('warning: unreferenced graphic element context named "'+a[0]+'".');return}var m=simhw_sim_signals();for(var q in m){if(typeof e[q+"click"]==="undefined"){e[q+"click"]=function(o){return function(){e["<all>"](o,"click")}}(q)}if(typeof e[q+"dblclick"]==="undefined"){e[q+"dblclick"]=function(o){return function(){e["<all>"](o,"dblclick")}}(q)}for(var f=0;f<simhw_sim_signal(q).fire_name.length;f++){a=simhw_sim_signal(q).fire_name[f].split(":");if(a[0]!==c){continue}d=g.getElementById(a[1]);if(null===d){console.log('warning: unreferenced graphic element named "'+a[0]+":"+a[1]+'".');continue}d.addEventListener("click",e[q+"click"],false);d.addEventListener("dblclick",e[q+"dblclick"],false)}}var n=simhw_sim_components();for(var s in n){for(var k in n[s].details_name){var p=n[s].details_name[k];if(typeof l[p]==="undefined"){continue}for(var h in n[s].details_fire[k]){a=n[s].details_fire[k][h].split(":");if(a[0]!==c){continue}d=g.getElementById(a[1]);if(null===d){console.log('warning: unreferenced graphic element named "'+a[0]+":"+a[1]+'".');continue}d.addEventListener("click",l[p],false)}}}}function simcore_check_if_can_execute(){var c={};c.msg="";c.ok=true;var d=simhw_internalState("segments");if((typeof d[".ktext"]=="undefined")&&(typeof d[".text"]=="undefined")){c.msg="code segment .ktext/.text does not exist!\nPlease load some assembly code.";c.ok=false;return c}var a=get_simware();if((!((typeof d[".ktext"]!="undefined")&&(a.labels2.kmain)))&&(!((typeof d[".text"]!="undefined")&&(a.labels2.main)))){c.msg="labels 'kmain' (in .ktext) or 'main' (in .text) do not exist!";c.ok=false;return c}return c}function simcore_check_if_can_continue(){var d={};d.ok=true;d.msg="";var a=simhw_sim_ctrlStates_get().pc.state;var e=parseInt(get_value(simhw_sim_state(a)));var c=simhw_sim_ctrlStates_get().mpc.state;var g=get_value(simhw_sim_state(c));if(typeof simhw_internalState_get("MC",g)=="undefined"){d.ok=false;d.msg="Error: undefined microinstruction at "+g+".";return d}var h=get_cfg("ws_mode");if(("wepmips"!=h)&&(g!=0)){return d}var f=simhw_internalState("segments");if((e<f[".ktext"].end)&&(e>=f[".ktext"].begin)){return d}if((e<f[".text"].end)&&(e>=f[".text"].begin)){return d}d.ok=false;d.msg="The program has finished because the PC register points outside .ktext/.text code segments";return d}function simcore_reset(){var h={};h.msg="";h.ok=true;var l=get_simware();var d=simhw_internalState("FIRMWARE");var a=simhw_internalState("segments");var k=simhw_sim_components();var o=simhw_sim_ctrlStates_get().pc.state;var n=simhw_sim_state(o);var m=d.stackRegister;var c=simhw_sim_states().BR[m];for(var p in k){var e=k[p].name+"_RESET";compute_general_behavior(e)}if((typeof a[".ktext"]!=="undefined")&&(l.labels2.kmain)){set_value(n,parseInt(l.labels2.kmain));show_asmdbg_pc()}else{if((typeof a[".text"]!=="undefined")&&(l.labels2.main)){set_value(n,parseInt(l.labels2.main));show_asmdbg_pc()}}if((typeof a[".stack"]!=="undefined")&&(typeof c!=="undefined")){set_value(c,parseInt(a[".stack"].end))}var f=get_cfg("ws_mode");if("wepmips"!=f){compute_general_behavior("CLOCK")}show_dbg_ir(get_value(simhw_sim_state("REG_IR_DECO")));for(p in k){for(var g in k[p].details_name){if(typeof k[p].details_ui[g].reset!=="undefined"){k[p].details_ui[g].reset()}}}return h}function simcore_execute_microinstruction(){var a=simcore_check_if_can_continue();if(false===a.ok){return a}compute_general_behavior("CLOCK");show_states();show_rf_values();show_dbg_mpc();return a}function simcore_execute_microprogram(o){var f=simcore_check_if_can_continue();if(false===f.ok){return f}var e=get_cfg("ws_mode");if("wepmips"==e){compute_general_behavior("CLOCK");compute_general_behavior("CLOCK");show_states();show_rf_values();return f}var k=false;if(o.cycles_limit<0){k=true}var m=null;var g=null;var d="";var n=simhw_internalState("MC");var l=simhw_sim_ctrlStates_get().mpc.state;var h=simhw_sim_state(l);if(typeof o.before_microinstruction==="undefined"){o.before_microinstruction=simcore_do_nothing_handler}if(typeof o.after_microinstruction==="undefined"){o.after_microinstruction=simcore_do_nothing_handler}var c=0;var a=0;do{o.before_microinstruction(n,a);compute_general_behavior("CLOCK");o.after_microinstruction(n,a);c++;if(k){o.cycles_limit=c+1}if(c>=o.cycles_limit){f.msg="Warning: clock cycles limit reached in a single instruction.";f.ok=false;break}a=get_value(h);if(typeof n[a]=="undefined"){f.msg="Error: undefined microinstruction at "+a+".";f.ok=false;break}}while((c<o.cycles_limit)&&(0!=a));show_states();show_rf_values();if(get_cfg("DBG_level")=="microinstruction"){show_dbg_mpc()}return f}function simcore_execute_program(u){var e={};e.ok=true;e.msg="";var a=simhw_internalState("segments");var p=simhw_sim_ctrlStates_get().pc.state;var o=simhw_sim_state(p);var h=get_value(o);var s=get_value(o)-4;var l=0;if((typeof a[".text"]!="undefined")&&(typeof a[".text"].begin!="undefined")){l=parseInt(a[".text"].begin)}var n=0;if((typeof a[".text"]!="undefined")&&(typeof a[".text"].end!="undefined")){n=parseInt(a[".text"].end)}var q=0;if((typeof a[".ktext"]!="undefined")&&(typeof a[".ktext"].begin!="undefined")){q=parseInt(a[".ktext"].begin)}var c=0;if((typeof a[".ktext"]!="undefined")&&(typeof a[".ktext"].end!="undefined")){c=parseInt(a[".ktext"].end)}var k=null;var m=null;var g=null;var d="";var f=get_simware();if(typeof u.verbalize!=="undefined"){set_cfg("verbal_verbose",u.verbalize)}if(typeof u.before_instruction==="undefined"){u.before_instruction=simcore_do_nothing_handler}if(typeof u.after_instruction==="undefined"){u.after_instruction=simcore_do_nothing_handler}var t=0;while((h!=s)&&(((h<n)&&(h>=l))||((h<c)&&(h>=q)))){u.before_instruction(f,h);k=simcore_execute_microprogram(u);if(false===k.ok){return k}u.after_instruction(f,h);t++;if(t>u.instruction_limit){e.ok=false;e.msg="more than "+u.instruction_limit+" instructions executed before application ends.";return e}s=h;h=get_value(o)}return e}function simcore_do_nothing_handler(){return null}function simcore_compile_firmware(f){var c={};c.msg="";c.ok=true;if(""==f){c.msg="Empty Firmware";c.ok=false;return c}var a=null;try{a=loadFirmware(f);c.simware=a}catch(d){c.msg="ERROR: at line: "+d.lineNumber+" and column: "+d.columnNumber;c.ok=false;return c}if(a.error!=null){c.msg=a.error;c.ok=false;return c}update_memories(a);simcore_reset();return c}function simcore_compile_assembly(c){var d={};d.msg="";d.ok=true;var a=get_simware();if(a.firmware.length===0){d.msg="Empty microcode, please load the microcode first.";d.ok=false;return d}var e=simlang_compile(c,a);d.simware=e;if(e.error!=null){d.msg=e.error;d.ok=false;return d}set_simware(e);update_memories(a);simcore_reset();return d}function simcore_hardware_export(a){var c={};c.msg="{}";c.ok=false;var d=simhw_getObjByName(a);if(null===d){return c}c.ok=true;c.msg=JSON.stringify(d,function(e,f){if(typeof f==="function"){return"/Function("+f.toString()+")/"}return f});return c}function simcore_hardware_import(hw_json){var ret={};ret.msg="";ret.ok=true;hw_obj=JSON.parse(hw_json,function(key,value){if(typeof value==="string"&&value.startsWith("/Function(")&&value.endsWith(")/")){value=value.substring(10,value.length-2);return eval("("+value+")")}return value});simhw_add(hw_obj);return ret}function simcore_native_get_signal(a){return(get_value(simhw_sim_signal(a))>>>0)}function simcore_native_set_signal(a,c){set_value(simhw_sim_signal(a),c);compute_behavior("FIRE "+a);return c}function simcore_native_get_value(d,a){var c=0;var e=simhw_sim_components();var f=d;if("BR"===d){f="CPU"}if("DEVICE"===d){f="IO"}if(typeof e[f].get_value!=="undefined"){return e[f].get_value(a)}return false}function simcore_native_set_value(d,a,f){var c=0;var e=simhw_sim_components();var g=d;if("BR"===d){g="CPU"}if("DEVICE"===d){g="IO"}if(typeof e[g].set_value!=="undefined"){return e[g].set_value(a,f)}return false}function simcore_native_get_fields(c){var a=get_simware();for(var d in a.firmware){if(a.firmware[d].signatureRaw===c){return a.firmware[d].fields}}}function simcore_native_get_field_from_ir(a,c){if(typeof a[c]==="undefined"){return false}var e=get_value(simhw_sim_state("REG_IR"));var f=(31-parseInt(a[c].startbit));var d=parseInt(a[c].stopbit);e=e<<f;e=e>>>f;e=e>>>d;return e}function simcore_native_deco(){compute_behavior("DECO")}function simcore_native_go_maddr(a){set_value(simhw_sim_state("MUXA_MICROADDR"),a)}function simcore_native_go_opcode(){var a=get_value(simhw_sim_state("ROM_MUXA"));set_value(simhw_sim_state("MUXA_MICROADDR"),a)}function simcore_native_go_instruction(c){var a=get_simware();for(var e in a.firmware){if(a.firmware[e].signatureRaw===c){var d=a.firmware[e]["mc-start"];set_value(simhw_sim_state("MUXA_MICROADDR"),d);return}}}function simcore_simstate_checklist2state(h){var c={};var g=false;h=h.replace(/;|==|!=|>=|<=|=|>|</gi,function(m){return" "+m+" "});h=h.replace(/  /g," ");var k=h.split(";");for(var e=0;e<k.length;e++){var l=k[e].trim();if(""===l){continue}var d=l.split(" ");if(d.length<4){continue}var a={type:d[0],id:d[1],condition:d[2],value:decodeURI(d[3])};for(var f in simhw_sim_components()){g=simhw_sim_component(f).read_state(c,a);if(true===g){break}}if(false===g){console.log("ERROR in checklist at component "+a.type+": "+l)}}return c}function simcore_simstate_current2state(){var c={};for(var a in simhw_sim_components()){simhw_sim_component(a).write_state(c)}return c}function simcore_simstate_state2checklist(f){var e="";for(var d in f){for(var c in f[d]){var a=f[d][c];e=e+a.type+" "+a.id+" "+a.op+" "+encodeURI(a.value)+"; "}}return e}function simcore_simstate_check_results(g,f,h){var l={};l.result=[];l.errors=0;l.neltos_expected=0;l.neltos_obtained=0;var a=null;var k={};var e=0;for(var c in simhw_sim_components()){if(typeof g[c]!="undefined"){for(a in g[c]){l.neltos_expected++;e=g[c][a].default_value;if((typeof f[c]!="undefined")&&(typeof f[c][a]!="undefined")){e=f[c][a].value}k={};k.expected=g[c][a].value;k.obtained=e;k.elto_type=c.toLowerCase();k.elto_id=g[c][a].id;k.elto_op=g[c][a].op;k.fulfill=false;if("="===g[c][a].op){k.fulfill=(parseInt(k.obtained)==parseInt(k.expected))}else{if(">"===g[c][a].op){k.fulfill=(parseInt(k.obtained)>parseInt(k.expected))}else{if("<"===g[c][a].op){k.fulfill=(parseInt(k.obtained)<parseInt(k.expected))}else{if(">="===g[c][a].op){k.fulfill=(parseInt(k.obtained)>=parseInt(k.expected))}else{if("<="===g[c][a].op){k.fulfill=(parseInt(k.obtained)<=parseInt(k.expected))}else{if("=="===g[c][a].op){k.fulfill=(k.expected==k.obtained)}else{if("!="===g[c][a].op){k.fulfill=(k.expected!=k.obtained)}}}}}}}l.result.push(k);if(k.fulfill===false){l.errors++}}}if((h)&&(typeof f[c]!="undefined")){for(a in f[c]){l.neltos_obtained++;if((typeof g[c]!="undefined")&&(typeof g[c][a]!="undefined")){continue}k={};k.expected=f[c][a].default_value;k.obtained=f[c][a].value;k.fulfill=(k.expected===k.obtained);k.elto_type=c.toLowerCase();k.elto_id=f[c][a].id;k.elto_op="=";l.result.push(k);if(k.fulfill===false){l.errors++}}}}return l}function simcore_simstate_diff_results(c,a){return simcore_simstate_check_results(c,a,true)}function simcore_simstate_diff_states(c,e){var a=simcore_simstate_state2checklist(c).split(";");var d=simcore_simstate_state2checklist(e).split(";");return d.filter(function(f){return !a.includes(f)}).join(";").trim()}function simcore_simstate_checkreport2txt(c){var d="";for(var a=0;a<c.length;a++){if(c[a].fulfill===false){d+=c[a].elto_type+"["+c[a].elto_id+"]='"+c[a].obtained+"' (expected '"+c[a].expected+"'), "}}return d}function simcore_simstate_checkreport2html(e,c){var f="";var a="green";if(typeof c==="undefined"){c=false}f+="<table style='margin:0 0 0 0;'        class='table table-hover table-bordered table-sm'><thead><tr><th>Type</th><th><span class='d-none d-sm-inline-flex'>Identification</span><span class='d-sm-none'>Id.</span></th><th><span class='d-none d-sm-inline-flex'>Values in the</span> clipboard <span class='d-none d-sm-inline-flex'>state</th><th><span class='d-none d-sm-inline-flex'>Values in the</span> selected <span class='d-none d-sm-inline-flex'>state</th></tr></thead><tbody>";for(var d=0;d<e.length;d++){if(e[d].fulfill===false){a="table-danger"}else{a="table-success"}if(c&&e[d].fulfill){continue}f+="<tr class="+a+"><td>"+e[d].elto_type+"</td><td>"+e[d].elto_id+"</td><td>"+e[d].elto_op+"&nbsp;"+e[d].expected+"</td><td>"+e[d].obtained+"</td></tr>"}f+="</tbody></table>";return f}function simcore_voice_canSpeak(){if(typeof window.speechSynthesis=="undefined"){return false}if(false===get_cfg("use_voice")){return false}return true}function simcore_voice_speak(c){var a=null;if(simcore_voice_canSpeak()){a=new SpeechSynthesisUtterance(c);a.lang="es-ES";if("en"==get_cfg("ws_idiom")){a.lang="en-US"}if("es"==get_cfg("ws_idiom")){a.lang="es-EN"}window.speechSynthesis.speak(a)}}function simcore_voice_stopSpeak(){if(simcore_voice_canSpeak()){window.speechSynthesis.cancel()}}var simcore_notifications=[];function simcore_notifications_get(){return simcore_notifications}function simcore_notifications_reset(){simcore_notifications=[]}function simcore_notifications_add2(a){simcore_notifications.push({title:a.title,message:a.message,type:a.type,date:a.date})}function simcore_notifications_add(d,e,a,c){simcore_notifications.push({title:$("<p>").html(d).text(),message:$("<p>").html(e).text(),type:a,date:new Date().getTime()})};